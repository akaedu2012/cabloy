(()=>{var e={129:e=>{e.exports=e=>({})},521:(e,t,n)=>{function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function a(e,t,n,o,a,r,s){try{var i=e[r](s),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(o,a)}function r(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var s=e.apply(t,n);function i(e){a(s,o,r,i,c,"next",e)}function c(e){a(s,o,r,i,c,"throw",e)}i(void 0)}))}}const s=n(638)("@zhennann/trim-html");e.exports=e=>{const t=e.meta.mockUtil.parseInfoFromPackage(__dirname);class n extends e.meta.AtomBase{get moduleConfig(){return this.ctx.config.module(t.relativeName)}create(e){var t=()=>super.create,n=this;return r((function*(){let o=e.atomClass,a=e.item,r=e.user;const s=yield t().call(n,{atomClass:o,item:a,user:r}),i=yield n.ctx.model.note.insert({atomId:s.atomId});return{atomId:s.atomId,itemId:i.insertId}}))()}read(e){var t=()=>super.read,n=this;return r((function*(){let o=e.atomClass,a=e.options,r=e.key,s=e.user;const i=yield t().call(n,{atomClass:o,options:a,key:r,user:s});return i?(n._getMeta(i),i):null}))()}select(e){var t=()=>super.select,n=this;return r((function*(){let a=e.atomClass,r=e.options,s=e.items,i=e.user;yield t().call(n,{atomClass:a,options:r,items:s,user:i});var c,l=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,s=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw s}}}}(s);try{for(l.s();!(c=l.n()).done;){const e=c.value;n._getMeta(e)}}catch(e){l.e(e)}finally{l.f()}}))()}write(e){var t=()=>super.write,n=this;return r((function*(){let o=e.atomClass,a=e.target,r=e.key,s=e.item,i=e.options,c=e.user;yield t().call(n,{atomClass:o,target:a,key:r,item:s,options:i,user:c});const l=yield n.ctx.model.note.prepareData(s);l.id=r.itemId,l.html=yield n._renderContent({item:s,atomId:r.atomId}),l.summary=n._parseSummary({html:l.html}),yield n.ctx.model.note.update(l)}))()}delete(e){var t=()=>super.delete,n=this;return r((function*(){let o=e.atomClass,a=e.key,r=e.user;yield t().call(n,{atomClass:o,key:a,user:r}),yield n.ctx.model.note.delete({id:a.itemId})}))()}_renderContent(e){var t=this;return r((function*(){let n=e.item,o=e.atomId;return yield t.ctx.bean.markdown.render({host:{atom:n,atomId:o},content:n.content,locale:t.ctx.locale})}))()}_parseSummary(e){let t=e.html,n="";return t&&(n=s(t,this.moduleConfig.note.trim).html.trim()),n}_getMeta(e){const t={summary:e.summary,flags:[]};e._meta=t}}return n}},223:e=>{function t(e,t,n,o,a,r,s){try{var i=e[r](s),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(o,a)}function n(e){return function(){var n=this,o=arguments;return new Promise((function(a,r){var s=e.apply(n,o);function i(e){t(s,a,r,i,c,"next",e)}function c(e){t(s,a,r,i,c,"throw",e)}i(void 0)}))}}e.exports=e=>{class t extends e.meta.BeanBase{update(e){var t=this;return n((function*(){if(1===e.version){const e="\n          CREATE TABLE testNote (\n            id int(11) NOT NULL AUTO_INCREMENT,\n            createdAt timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,\n            updatedAt timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n            deleted int(11) DEFAULT '0',\n            iid int(11) DEFAULT '0',\n            atomId int(11) DEFAULT '0',\n            summary TEXT DEFAULT NULL,\n            content LONGTEXT DEFAULT NULL,\n            html LONGTEXT DEFAULT NULL,\n            PRIMARY KEY (id)\n          )\n        ";yield t.ctx.model.query(e)}}))()}init(e){var t=this;return n((function*(){if(1===e.version){const e=[{roleName:"authenticated",action:"create"},{roleName:"authenticated",action:"read",scopeNames:0},{roleName:"authenticated",action:"write",scopeNames:0},{roleName:"authenticated",action:"delete",scopeNames:0},{roleName:"authenticated",action:"clone",scopeNames:0},{roleName:"authenticated",action:"deleteBulk"},{roleName:"authenticated",action:"exportBulk"},{roleName:"authenticated",action:"layoutBulk"},{roleName:"system",action:"read",scopeNames:"authenticated"},{roleName:"root",action:"layout",scopeNames:"root"}];yield t.ctx.bean.role.addRoleRightBatch({atomClassName:"note",roleRights:e})}}))()}test(){return n((function*(){}))()}}return t}},313:(e,t,n)=>{const o=n(223),a=n(521);e.exports=e=>({"version.manager":{mode:"app",bean:o},"atom.note":{mode:"app",bean:a}})},731:(e,t,n)=>{const o=n(479),a=n(967),r=n(846),s=n(72);e.exports={"en-us":{"demo-1":o,"demo-2":a},"zh-cn":{"demo-1":r,"demo-2":s}}},479:e=>{e.exports={atomName:"CabloyJS",content:"## CabloyJS\n\n  A Node.js full-stack framework with workflow engine, based on koa + egg + vue + framework7 + mysql\n  \n  ### Features\n  \n  CableyJS provides a lot of features that shine in front of you. Here are only three examples:\n\n  1. Adaptive Layout: `pc = mobile + pad`\n  2. Automatic form rendering and data validation engine based on JSON Schema\n  3. Built-in NodeJS workflow engine\n  \n  ### Architectures\n  \n  CableyJS has developed many distinctive architecture designs. Here are only three examples:\n  \n  1. Business Modularization & Module Isolation\n  2. Frontend and Backend Separation & Multi Scenario Development\n  3. Cluster Framework\n"}},967:e=>{e.exports={atomName:"Today",content:'### Today\'s Music\n\n  $$$ a-markdownblock:audio\n  {\n    "audio": {\n      "name": "Roses and Gold",\n      "url": "https://admin2.zhennann.com/api/a/file/file/download/0d0990d0f68e495c98857252521032a4.mp3",\n      "artist": "Robin Jackson",\n      "cover": "https://admin2.zhennann.com/api/a/file/file/download/52e763b10a3a4b2e9567be64e10c5a18.jpg"\n    },\n    "autoplay": false,\n    "loop": true\n  }\n  $$$\n  \n  ### Today\'s Tasks \n  \n  1. [x]  Run for 30 minutes\n  2. [ ]  Keep one diary\n  3. [ ]  Read 20 pages\n'}},846:e=>{e.exports={atomName:"CabloyJS",content:"## CabloyJS\n\n  一款自带工作流引擎的Node.js全栈框架, `接单快手、创业神器`, 基于koa + egg + vue + framework7 + mysql\n  \n  ### 功能三大亮点\n  \n  CabloyJS提供了诸多`耳目一新`的功能，这里仅举三例：\n  \n  1. 自适应布局：`pc = mobile + pad`\n  2. 基于JSON Schema的表单自动渲染与数据验证引擎\n  3. 内置NodeJS工作流引擎\n  \n  ### 架构三大亮点\n  \n  CabloyJS研发了诸多`别具一格`的架构设计，这里仅举三例：\n  \n  1. 模块化开发体系与模块隔离\n  2. 前后端分离，全场景开发\n  3. 原生分布式架构\n"}},72:e=>{e.exports={atomName:"今日",content:'### 今日金曲\n\n  $$$ a-markdownblock:audio\n  {\n    "audio": {\n      "name": "Roses and Gold",\n      "url": "https://admin2.zhennann.com/api/a/file/file/download/0d0990d0f68e495c98857252521032a4.mp3",\n      "artist": "Robin Jackson",\n      "cover": "https://admin2.zhennann.com/api/a/file/file/download/52e763b10a3a4b2e9567be64e10c5a18.jpg"\n    },\n    "autoplay": false,\n    "loop": true\n  }\n  $$$\n  \n  ### 今日任务 \n  \n  1. [x]  跑步30分钟\n  2. [ ]  日记1篇\n  3. [ ]  读书20页\n'}},817:e=>{e.exports=e=>({note:{trim:{limit:100,wordBreak:!1,preserveTags:!1}}})},971:e=>{e.exports={}},724:e=>{e.exports={}},995:e=>{e.exports={Note:"便签","Create Note":"新建便签","Note List":"便签列表","Note Test":"便签测试"}},266:(e,t,n)=>{e.exports={"en-us":n(724),"zh-cn":n(995)}},1:e=>{e.exports=e=>{const t=e.meta.mockUtil.parseInfoFromPackage(__dirname);return[{atomName:"Create Note",atomStaticKey:"createNote",atomRevision:0,atomCategoryId:"a-base:menu.Create",resourceType:"a-base:menu",resourceConfig:JSON.stringify({module:t.relativeName,atomClassName:"note",atomAction:"create"}),resourceRoles:"authenticated"},{atomName:"Note List",atomStaticKey:"listNote",atomRevision:0,atomCategoryId:"a-base:menu.List",resourceType:"a-base:menu",resourceConfig:JSON.stringify({module:t.relativeName,atomClassName:"note",atomAction:"read"}),resourceRoles:"authenticated"},{atomName:"Note",atomStaticKey:"widgetNote",atomRevision:0,atomCategoryId:"a-dashboard:widget.Demonstration",resourceType:"a-dashboard:widget",resourceConfig:JSON.stringify({module:t.relativeName,component:"widgetNote"}),resourceRoles:"root"}]}},70:e=>{e.exports=e=>({note:{type:"object",properties:{atomName:{type:"string",ebType:"text",ebTitle:"Title",notEmpty:!0},content:{type:"string",ebType:"markdown-content",ebTitle:"Content"}}},noteSearch:{type:"object",properties:{content:{type:"string",ebType:"text",ebTitle:"Content"}}}})},326:(e,t,n)=>{const o=n(70);e.exports=e=>{const t={};return Object.assign(t,o(e)),t}},715:e=>{function t(e,t,n,o,a,r,s){try{var i=e[r](s),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(o,a)}e.exports=e=>{class n extends e.Controller{createNote(){var e,n=this;return(e=function*(){const e=yield n.ctx.service.demo.createNote({demoKey:n.ctx.request.body.demoKey,user:n.ctx.state.user.op});n.ctx.success(e)},function(){var n=this,o=arguments;return new Promise((function(a,r){var s=e.apply(n,o);function i(e){t(s,a,r,i,c,"next",e)}function c(e){t(s,a,r,i,c,"throw",e)}i(void 0)}))})()}}return n}},691:(e,t,n)=>{const o=n(715);e.exports=e=>({demo:o})},312:(e,t,n)=>{const o=n(817),a=n(266),r=n(971);e.exports=e=>{const t=n(129)(e),s=n(313)(e),i=n(788)(e),c=n(691)(e),l=n(481)(e),m=n(700)(e),u=n(730)(e);return{aops:t,beans:s,routes:i,controllers:c,services:l,models:m,config:o,locales:a,errors:r,meta:u}}},730:(e,t,n)=>{e.exports=e=>{const t=n(326)(e);return{base:{atoms:{note:{info:{bean:"note",title:"Note",tableName:"testNote",language:!1,category:!0,tag:!0,simple:!0,history:!1},actions:{},validator:"note",search:{validator:"noteSearch"}}},statics:{"a-base.resource":{items:n(1)(e)}}},validation:{validators:{note:{schemas:"note"},noteSearch:{schemas:"noteSearch"}},keywords:{},schemas:t},index:{indexes:{testNote:"createdAt,updatedAt,atomId"}}}}},732:e=>{e.exports=e=>{class t extends e.meta.Model{constructor(e){super(e,{table:"testNote",options:{disableDeleted:!1}})}}return t}},700:(e,t,n)=>{const o=n(732);e.exports=e=>({note:o})},788:e=>{e.exports=e=>[{method:"post",path:"demo/createNote",controller:"demo",meta:{auth:{user:!0}}}]},528:(e,t,n)=>{function o(e,t,n,o,a,r,s){try{var i=e[r](s),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(o,a)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var s=e.apply(t,n);function i(e){o(s,a,r,i,c,"next",e)}function c(e){o(s,a,r,i,c,"throw",e)}i(void 0)}))}}const r=n(731);e.exports=e=>{const t={module:e.meta.mockUtil.parseInfoFromPackage(__dirname).relativeName,atomClassName:"note"};class n extends e.Service{createNote(e){var n=this;return a((function*(){let o=e.demoKey,a=e.user;const s=r[n.ctx.locale][o],i=yield n.getRoleIdOwner(t,a.id),c=yield n.ctx.bean.atom.create({atomClass:t,roleIdOwner:i,user:a});return yield n.ctx.bean.atom.write({key:c,item:{atomName:s.atomName,content:s.content},user:a}),c}))()}getRoleIdOwner(e,t){var n=this;return a((function*(){return(yield n.ctx.bean.atom.preferredRoles({atomClass:e,user:{id:t}}))[0].roleIdWho}))()}}return n}},481:(e,t,n)=>{const o=n(528);e.exports=e=>({demo:o})},638:e=>{"use strict";e.exports=require("require3")}},t={},n=function n(o){var a=t[o];if(void 0!==a)return a.exports;var r=t[o]={exports:{}};return e[o](r,r.exports,n),r.exports}(312);module.exports=n})();