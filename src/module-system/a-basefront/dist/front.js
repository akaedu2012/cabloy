window["a-basefront"]=(()=>{var t={908:(t,e,n)=>{"use strict";function a(t,e,n,a,r,o,i){try{var s=t[o](i),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(a,r)}function r(t,e,n,a,r,o,i){try{var s=t[o](i),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(a,r)}function o(t){return function(){var e=this,n=arguments;return new Promise((function(a,o){var i=t.apply(e,n);function s(t){r(i,a,o,s,l,"next",t)}function l(t){r(i,a,o,s,l,"throw",t)}s(void 0)}))}}n.d(e,{Z:()=>i});const i={renderLanguage:{props:{context:{type:Object}},data:function(){return{}},computed:{atomClass:function(){return{module:this.context.data.module,atomClassName:this.context.data.atomClassName}},locales:function(){return this.$store.getState("a/base/locales")}},created:function(){var t=this;this.$store.dispatch("a/base/getLocales").then((function(e){1===e.length&&(t.context.data.atomLanguage=e[0].value)}))},methods:{},render:function(){var t=arguments[0],e=this.context,n=e.data,a=e.pathParent,r=e.key,o=e.schema,i=e.properties,s=e.property,l=e.meta,c=this.$utils.extend({},s,{ebType:"select",ebOptions:this.locales});return t("eb-list-item-validate",{attrs:{data:n,pathParent:a,schema:o,properties:i,meta:l,dataKey:r,property:c}})}},renderCategory:{props:{context:{type:Object}},data:function(){return{}},computed:{atomClass:function(){return{module:this.context.data.module,atomClassName:this.context.data.atomClassName}}},created:function(){},methods:{combineAtomClassAndLanguage:function(t){var e={module:this.atomClass.module,atomClassName:this.atomClass.atomClassName};return t&&(e.language=t),e},onChooseCategory:function(t){var e,n=this;return(e=regeneratorRuntime.mark((function e(){var a,r,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.context.data,r={actionModule:"a-base",actionComponent:"action",name:"selectLocale",targetEl:t.target},!a.atomLanguage){e.next=6;break}o=a.atomLanguage,e.next=10;break;case 6:return e.next=8,n.$meta.util.performAction({ctx:n,action:r,item:a});case 8:(i=e.sent)&&(o=i.value,a.atomLanguage=i.value);case 10:return e.abrupt("return",new Promise((function(t){var e=n.$meta.util.combineQueries("/a/basefront/category/select",n.combineAtomClassAndLanguage(o));n.$view.navigate(e,{target:"_self",context:{params:{categoryIdStart:0,leafOnly:!0},callback:function(e,r){200===e?(r?(n.$set(a,"atomCategoryId",r.id),n.$set(a,"atomCategoryName",r.data.categoryName)):(n.$set(a,"atomCategoryId",0),n.$set(a,"atomCategoryName","")),t(!0)):!1===e&&t(!1)}}})})));case 11:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function s(t){a(i,r,o,s,l,"next",t)}function l(t){a(i,r,o,s,l,"throw",t)}s(void 0)}))})()}},render:function(){var t=arguments[0],e=this.context,n=e.data,a=e.dataPath,r=e.property,o=e.validate,i=this.context.getTitle();return o.readOnly||r.ebReadOnly?t("f7-list-item",{attrs:{title:i}},[t("div",{slot:"after"},[n.atomCategoryName])]):t("eb-list-item-choose",{attrs:{link:"#",dataPath:a,title:i},props:{onChoose:this.onChooseCategory}},[t("div",{slot:"after"},[n.atomCategoryName])])}},renderTags:{props:{context:{type:Object}},data:function(){return{tagsAll:null}},computed:{atomClass:function(){return{module:this.context.data.module,atomClassName:this.context.data.atomClassName}}},created:function(){this.loadTagsAll(this.context.data.atomLanguage)},methods:{combineAtomClassAndLanguage:function(t){var e={module:this.atomClass.module,atomClassName:this.atomClass.atomClassName};return t&&(e.language=t),e},loadTagsAll:function(t){var e=this;return o(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.$store.dispatch("a/base/getTags",{atomClass:e.atomClass,language:t});case 2:e.tagsAll=n.sent;case 3:case"end":return n.stop()}}),n)})))()},adjustTags:function(t){var e=this;return this.tagsAll&&t?(t=(t=JSON.parse(t)).map((function(t){var n=e.tagsAll.find((function(e){return e.id===t}));return n?n.tagName:""}))).join(","):""},onChooseTags:function(t){var e=this;return o(regeneratorRuntime.mark((function n(){var a,r,o,i;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=e.context.data,r={actionModule:"a-base",actionComponent:"action",name:"selectLocale",targetEl:t.target},!a.atomLanguage){n.next=6;break}o=a.atomLanguage,n.next=10;break;case 6:return n.next=8,e.$meta.util.performAction({ctx:e,action:r,item:a});case 8:(i=n.sent)&&(o=i.value,a.atomLanguage=i.value);case 10:if(!o){n.next=13;break}return n.next=13,e.loadTagsAll(o);case 13:return n.abrupt("return",new Promise((function(t){var n=e.$meta.util.combineQueries("/a/basefront/tag/select",e.combineAtomClassAndLanguage(o));e.$view.navigate(n,{target:"_self",context:{params:{tags:a.atomTags},callback:function(n,r){200===n?(e.$set(a,"atomTags",r?JSON.stringify(r):null),t(!0)):!1===n&&t(!1)}}})})));case 14:case"end":return n.stop()}}),n)})))()}},render:function(){var t=arguments[0],e=this.context,n=e.data,a=e.dataPath,r=e.property,o=e.validate,i=this.context.getTitle();return o.readOnly||r.ebReadOnly?t("f7-list-item",{attrs:{title:i}},[t("div",{slot:"after"},[this.adjustTags(n.atomTags)])]):t("eb-list-item-choose",{attrs:{link:"#",dataPath:a,title:i},props:{onChoose:this.onChooseTags}},[t("div",{slot:"after"},[this.adjustTags(n.atomTags)])])}},renderResourceType:{props:{context:{type:Object}},data:function(){return{}},computed:{resourceTypes:function(){var t=this.$store.getState("a/base/resourceTypes");return t?Object.keys(t).map((function(e){return{title:t[e].titleLocale,value:e}})):[]}},created:function(){this.$store.dispatch("a/base/getResourceTypes")},methods:{},render:function(){var t=arguments[0],e=this.context,n=e.data,a=e.pathParent,r=e.key,o=e.schema,i=e.properties,s=e.property,l=e.meta,c=this.$utils.extend({},s,{ebType:"select",ebOptions:this.resourceTypes});return t("eb-list-item-validate",{attrs:{data:n,pathParent:a,schema:o,properties:i,meta:l,dataKey:r,property:c}})}}}},788:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});const a={atom:{render:{list:{info:{orders:[{name:"atomCreatedAt",title:"Created Time",by:"desc",tableAlias:""},{name:"atomUpdatedAt",title:"Modification Time",by:"desc",tableAlias:""},{name:"atomName",title:"Atom Name",by:"asc",tableAlias:"a"}],filter:{component:{module:"a-baselayout",name:"listLayoutBlockFilter"}},export:{fields:[{name:"atomName",title:"AtomName"},{name:"userName",title:"Creator"},{name:"atomCreatedAt",title:"Created Time"},{name:"atomUpdatedAt",title:"Modification Time"}]}},layouts:{list:{component:{module:"a-baselayout",name:"listLayoutList"},blocks:{title:{component:{module:"a-baselayout",name:"listLayoutBlockListTitle"}},subnavbar:{component:{module:"a-baselayout",name:"listLayoutBlockListSubnavbar"}},items:{component:{module:"a-baselayout",name:"listLayoutBlockListItems"}}}},table:{component:{module:"a-baselayout",name:"listLayoutTable"},blocks:{title:{component:{module:"a-baselayout",name:"listLayoutBlockTableTitle"}},items:{component:{module:"a-baselayout",name:"listLayoutBlockTableItems"},columns:[{dataIndex:"atomName",title:"Atom Name",align:"left",component:{module:"a-baselayout",name:"listLayoutTableCellAtomName"}},{dataIndex:"userName",title:"Creator",align:"left",component:{module:"a-baselayout",name:"listLayoutTableCellUserName"}},{dataIndex:"atomCreatedAt",title:"Created Time",align:"left"},{dataIndex:"atomUpdatedAt",title:"Modification Time",align:"left"}]},bottombar:{component:{module:"a-baselayout",name:"listLayoutBlockTableBottombar"}}}},select:{component:{module:"a-baselayout",name:"listLayoutList"},blocks:{title:{component:{module:"a-baselayout",name:"listLayoutBlockSelectTitle"}},items:{component:{module:"a-baselayout",name:"listLayoutBlockSelectItems"}}}},selecting:{component:{module:"a-baselayout",name:"listLayoutList"},blocks:{title:{component:{module:"a-baselayout",name:"listLayoutBlockSelectingTitle"}},items:{component:{module:"a-baselayout",name:"listLayoutBlockSelectingItems"}}}}}},item:{info:{attachment:!0,comment:!0},layouts:{mobile:{component:{module:"a-baselayout",name:"itemLayoutMobile"},blocks:{title:{component:{module:"a-baselayout",name:"itemLayoutBlockMobileTitle"}},subnavbar:{component:{module:"a-baselayout",name:"itemLayoutBlockMobileSubnavbar"}},main:{component:{module:"a-baselayout",name:"itemLayoutBlockMobileMain"}}}},pc:{component:{module:"a-baselayout",name:"itemLayoutPC"},blocks:{title:{component:{module:"a-baselayout",name:"itemLayoutBlockPCTitle"}},main:{component:{module:"a-baselayout",name:"itemLayoutBlockMobileMain"}}}}}}}}}},933:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});const a={CabloyAboutTip1:"CabloyJS - The Ultimate NodeJS Full Stack Business Development Platform",CabloyAboutTip2:"The frontend of CabloyJS uses VueJS + Framework7 + Webpack, while the backend uses KoaJS + EggJS, and the database uses MySQL",CabloyAboutTip3:"Vertically, CabloyJS make the frontend and the backend work together to form an organic wholeness, so as to avoid working independently between them",CabloyAboutTip4:"Horizontally, CabloyJS has refined a code organization mode called “business modularity”, which could offer a powerful basic framework for the continually growing business demands of large-scale web applications through different module combinations"}},978:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});const a={About:"关于",Documentation:"文档",Community:"社区",CabloyAboutTip1:"CabloyJS - 是一款顶级NodeJS全栈业务开发框架",CabloyAboutTip2:"前端采用VueJS + Framework7 + Webpack，后端采用KoaJS + EggJS，数据库采用MySQL",CabloyAboutTip3:"在纵向上，将前端和后端打通，形成一个有机的整体，避免前端和后端各自为政的状况",CabloyAboutTip4:"在横向上，提炼出“业务模块化”的代码组织模式，通过不同的模块组合实现业务开发，也为大型Web应用不断增长的业务需求提供有力的基础架构","Welcome to CabloyJS":"欢迎使用CabloyJS"}},137:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});const a={"en-us":n(933).Z,"zh-cn":n(978).Z}},292:(t,e,n)=>{"use strict";var a;n.r(e),n.d(e,{default:()=>r}),n(824);const r={install:function(t,e){return a?console.error("already installed."):(a=t,e({routes:n(644).Z,store:n(81).Z(a),config:n(788).Z,locales:n(137).Z,components:n(908).Z,mixins:n(751).Z}))}}},751:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o});var a=n(632),r=n(654);const o={listLayoutManager:a.Z,itemLayoutManager:r.Z}},644:(t,e,n)=>{"use strict";function a(t){return n(142)("./".concat(t,".vue")).default}function r(t){return n(990)("./".concat(t,".jsx")).default}n.d(e,{Z:()=>o});const o=[{path:"atom/list",component:r("atom/list")},{path:"atom/searchQuick",component:r("atom/searchQuick")},{path:"atom/labels",component:a("atom/labels")},{path:"atom/item",component:r("atom/item")},{path:"atom/selectAtomClass",component:a("atom/selectAtomClass")},{path:"atom/select",component:r("atom/select")},{path:"atom/selecting",component:r("atom/selecting")},{path:"atom/autoStar",component:a("atom/autoStar")},{path:"comment/list",component:a("comment/list")},{path:"comment/item",component:a("comment/item")},{path:"comment/all",component:a("comment/all")},{path:"comment/autoHeart",component:a("comment/autoHeart")},{path:"attachment/list",component:a("attachment/list")},{path:"attachment/all",component:a("attachment/all")},{path:"base/alert",component:a("base/alert")},{path:"base/about",component:a("base/about")},{path:"category/select",component:a("category/categorySelect")},{path:"tag/select",component:a("tag/tagSelect")},{path:"resource/tree",component:a("resource/tree")},{path:"resource/authorize",component:a("resource/authorize")},{path:"resource/select",component:a("resource/resourceSelect")},{path:"json/editor",component:r("json/jsonEditor")}]},81:(t,e,n)=>{"use strict";function a(t){return{state:{},getters:{},mutations:{},actions:{}}}n.d(e,{Z:()=>a})},654:(t,e,n)=>{"use strict";n.d(e,{Z:()=>b});var a=n(5),r=n.n(a);function o(t,e,n,a,r,o,i){try{var s=t[o](i),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(a,r)}function i(t){return function(){var e=this,n=arguments;return new Promise((function(a,r){var i=t.apply(e,n);function s(t){o(i,a,r,s,l,"next",t)}function l(t){o(i,a,r,s,l,"throw",t)}s(void 0)}))}}const s={data:function(){return{base:{ready:!1,configAtomBase:null,configAtom:null,config:null,item:null,atomClass:null,module:null,validateParams:null,notfound:!1}}},computed:{base_ready:function(){return this.base.ready&&this.base_userLabels&&this.atomClassesAll&&this.actionsAll},base_user:function(){return this.$store.state.auth.user.op},base_userLabels:function(){return this.$store.getters["a/base/userLabels"]}},created:function(){this.$store.dispatch("a/base/getLabels")},mounted:function(){this.$meta.eventHub.$on("atom:star",this.base_onStarChanged),this.$meta.eventHub.$on("atom:labels",this.base_onLabelsChanged),this.$meta.eventHub.$on("atom:action",this.base_onActionChanged),this.$meta.eventHub.$on("atom:actions",this.base_onActionsChanged),this.$meta.eventHub.$on("comment:action",this.base_onCommentChanged),this.$meta.eventHub.$on("attachment:action",this.base_onAttachmentChanged)},beforeDestroy:function(){this.$meta.eventHub.$off("atom:star",this.base_onStarChanged),this.$meta.eventHub.$off("atom:labels",this.base_onLabelsChanged),this.$meta.eventHub.$off("atom:action",this.base_onActionChanged),this.$meta.eventHub.$off("atom:actions",this.base_onActionsChanged),this.$meta.eventHub.$off("comment:action",this.base_onCommentChanged),this.$meta.eventHub.$off("attachment:action",this.base_onAttachmentChanged)},methods:{base_loadItem:function(){var t=this;return i(regeneratorRuntime.mark((function e(){var n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.base_prepareReadOptions(),e.next=4,t.$api.post("/a/base/atom/read",{key:{atomId:t.container.atomId},options:n});case 4:return t.base.item=e.sent,t.base.atomClass={id:t.base.item.atomClassId,module:t.base.item.module,atomClassName:t.base.item.atomClassName},e.next=8,t.$meta.module.use(t.base.item.module);case 8:return t.base.module=e.sent,e.next=11,t.$api.post("/a/base/atom/validator",{atomClass:{id:t.base.item.atomClassId}});case 11:return a=e.sent,t.base.validateParams={module:a.module,validator:a.validator},e.next=15,t.actions_fetchActions();case 15:return e.abrupt("return",!0);case 18:return e.prev=18,e.t0=e.catch(0),t.base.notfound=!0,e.abrupt("return",!1);case 22:case"end":return e.stop()}}),e,null,[[0,18]])})))()},base_prepareReadOptions:function(){var t={};return t.layout=this.layout.current,t},base_getCurrentStage:function(){if(!this.base.item)return null;var t=this.base.item.atomStage;return 0===t?"draft":1===t?"formal":"history"},base_onActionChanged:function(t){var e=this;return i(regeneratorRuntime.mark((function n(){var a,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=t.key,r=t.action,e.base_ready){n.next=4;break}return n.abrupt("return");case 4:if(e.base.item.atomId===a.atomId){n.next=6;break}return n.abrupt("return");case 6:if("edit"!==e.container.mode){n.next=9;break}return e.base.item.atomUpdatedAt=new Date,n.abrupt("return");case 9:if(1!==r.menu||"create"!==r.action){n.next=11;break}return n.abrupt("return");case 11:if("delete"!==r.name){n.next=16;break}return e.base.item=null,e.base.notfound=!0,e.base.ready=!1,n.abrupt("return");case 16:return n.next=18,e.base_loadItem();case 18:case"end":return n.stop()}}),n)})))()},base_onActionsChanged:function(t){var e=this;return i(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=t.key,e.base_ready){n.next=3;break}return n.abrupt("return");case 3:if(e.base.item.atomId===a.atomId){n.next=5;break}return n.abrupt("return");case 5:return n.next=7,e.actions_fetchActions();case 7:case"end":return n.stop()}}),n)})))()},base_onOpenDrafted:function(t){var e=this;return i(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=t.key,e.base_ready){n.next=3;break}return n.abrupt("return");case 3:if(e.base.item.atomId===a.atomId){n.next=5;break}return n.abrupt("return");case 5:return n.next=7,e.actions_fetchActions();case 7:case"end":return n.stop()}}),n)})))()},base_onCommentChanged:function(t){this.base.item&&t.atomId===this.container.atomId&&("create"===t.action&&(this.base.item.commentCount+=1),"delete"===t.action&&(this.base.item.commentCount-=1))},base_onAttachmentChanged:function(t){this.base.item&&t.atomId===this.container.atomId&&("create"===t.action&&(this.base.item.attachmentCount+=1),"delete"===t.action&&(this.base.item.attachmentCount-=1))},base_onStarChanged:function(t){this.base.item&&t.key.atomId===this.container.atomId&&(this.base.item.star=t.star)},base_onLabelsChanged:function(t){this.base.item&&t.key.atomId===this.container.atomId&&(this.base.item.labels=JSON.stringify(t.labels))}}};function l(t,e,n,a,r,o,i){try{var s=t[o](i),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(a,r)}const c={data:function(){return{layout:{current:null,config:null,instance:null}}},created:function(){this.layout.current=this.container.layout||this.layout_get()},methods:{layout_get:function(){return"large"===this.$view.size?"pc":"mobile"},layout_prepareConfig:function(){var t,e=this;return(t=regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.base.configAtomBase=e.$meta.config.modules["a-basefront"].atom,e.base.configAtom=e.$meta.util.getProperty(e.$meta.config.modules[e.base.atomClass.module],"atoms.".concat(e.base.atomClass.atomClassName)),e.base.config=e.base.configAtom?e.$meta.util.extend({},e.base.configAtomBase,e.base.configAtom):e.base.configAtomBase,(n=e.$meta.util.getProperty(e.base.config,"render.item.layouts.".concat(e.layout.current)))||(n=e.$meta.util.getProperty(e.base.config,"render.item.layouts.mobile")),e.layout.config=n;case 6:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(a,r){var o=t.apply(e,n);function i(t){l(o,a,r,i,s,"next",t)}function s(t){l(o,a,r,i,s,"throw",t)}i(void 0)}))})()},layout_getComponentOptions:function(){return{props:{layoutManager:this,layoutConfig:this.layout.config}}},layout_renderComponent:function(){var t=this.$createElement;return this.base.ready?t("eb-component",{attrs:{module:this.layout.config.component.module,name:this.layout.config.component.name,options:this.layout_getComponentOptions()}}):null},layout_getBlockComponentOptions:function(t){return{props:{layoutManager:this,blockConfig:t.blockConfig}}},layout_renderBlock:function(t){var e=t.blockName,n=this.$createElement;if(!this.base.ready)return null;var a=this.layout.config.blocks[e];return a?n("eb-component",{attrs:{module:a.component.module,name:a.component.name,options:this.layout_getBlockComponentOptions({blockConfig:a})}}):null},layout_renderLayout:function(){var t=this.$createElement;return this.base.notfound?t("f7-card",[t("f7-card-header",[this.$text("Friendly Tips")]),t("f7-card-content",[this.$text("Not Found")])]):t("div",[this.layout_renderComponent(),this.actions_renderPopover()])}}};function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}const m={data:function(){return{}},methods:{info_onLabel:function(){var t=this;if(this.base_user.anonymous)this.$view.dialog.confirm(this.$text("Please Sign In")).then((function(){t.$meta.vueLayout.openLogin()}));else{var e=this.base.item;this.$view.navigate("/a/basefront/atom/labels?atomId=".concat(e.atomId),{})}},info_onStarSwitch:function(){var t=this.base.item.star?0:1;return this._info_onStarSwitch(t)},_info_onStarSwitch:function(t){var e=this,n=this.base.item;if(!this.base_user.anonymous){var a={atomId:n.atomId,itemId:n.itemId};return this.$api.post("/a/base/atom/star",{key:a,atom:{star:t}}).then((function(t){e.$meta.eventHub.$emit("atom:star",{key:a,star:t.star,starCount:t.starCount})}))}this.$view.dialog.confirm(this.$text("Please Sign In")).then((function(){e.$meta.vueLayout.openLogin()}))},info_getLabel:function(t){return this.base_userLabels[t]},info_getItemMetaMedia:function(t){var e=t||this.$meta.config.modules["a-base"].user.avatar.default;return this.$meta.util.combineImageUrl(e,16)},info_renderActionsLeft:function(){var t=this.$createElement;if(this.base_ready){var e=this.base.item,n=[];if((0===e.atomStage||this.base.config.render.item.info.comment)&&n.push(t("eb-link",{key:"actionsLeft:comment",attrs:{iconMaterial:"comment",iconBadge:e.commentCount,"eb-href":"/a/basefront/comment/list?atomId=".concat(e.atomId)}})),this.base.config.render.item.info.attachment&&n.push(t("eb-link",{key:"actionsLeft:attachment",attrs:{iconMaterial:"attachment",iconBadge:e.attachmentCount,"eb-href":"/a/basefront/attachment/list?atomId=".concat(e.atomId)}})),1===e.atomStage&&n.push(t("eb-link",{key:"actionsLeft:star",attrs:{iconMaterial:e.star?"star":"star_border"},props:{onPerform:this.info_onStarSwitch}})),1===e.atomStage){var a=e.labels?JSON.parse(e.labels):[];if(a.length>0){var r,o=function(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var a=0,r=function(){};return{s:r,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return i=t.done,t},e:function(t){s=!0,o=t},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}(a);try{for(o.s();!(r=o.n()).done;){var i=r.value,s=this.info_getLabel(i);n.push(t("eb-link",{key:i,attrs:{text:s.text},style:{color:s.color},props:{onPerform:this.info_onLabel}}))}}catch(t){o.e(t)}finally{o.f()}}else n.push(t("eb-link",{key:"actionsLeft:label",attrs:{iconMaterial:"label"},props:{onPerform:this.info_onLabel}}))}return n}},info_renderAvatar:function(){var t=this.$createElement,e=this.base.item,n=[],a=!1;return e.userIdCreated!==e.userIdUpdated&&(a=!0,n.push(t("img",{key:"avatar:one",class:"avatar ".concat(a?"avatar12":"avatar16"),attrs:{src:this.info_getItemMetaMedia(e.avatarUpdated),title:e.userName}}))),n.push(t("img",{key:"avatar:two",class:"avatar ".concat(a?"avatar12":"avatar16"),attrs:{src:this.info_getItemMetaMedia(e.avatar),title:e.userName}})),t("div",{key:"avatar",class:"info-avatar"},[n])},info_renderDate:function(){var t=this.$createElement,e=this.base.item,n=[],a=this.$meta.util.formatDateTime(e.atomCreatedAt),r=this.$meta.util.formatDateTime(e.atomUpdatedAt),o=!1;return a!==r&&(o=!0,n.push(t("div",{key:"date:one"},[r]))),o?n.push(t("div",{key:"date:two"},[a])):(n.push(t("div",{key:"date:one2"},[this.$meta.util.formatDate(e.atomCreatedAt)])),n.push(t("div",{key:"date:two2"},[this.$meta.util.formatTime(e.atomCreatedAt)]))),t("div",{key:"date",class:"info-date"},[n])},info_renderActionsRight:function(){if(this.base_ready){var t=[];return t.push(this.info_renderAvatar()),t.push(this.info_renderDate()),t}}}};function d(t,e,n,a,r,o,i){try{var s=t[o](i),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(a,r)}function h(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var a=0,r=function(){};return{s:r,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return i=t.done,t},e:function(t){s=!0,o=t},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}const p={data:function(){return{actions:{list:null,popoverId:r().prototype.$meta.util.nextId("popover")}}},computed:{actions_listPopover:function(){var t=this;if(!this.base_ready)return null;var e=[];this.actions_findAction("write")&&0===this.base.item.atomStage&&e.push({module:this.base.atomClass.module,atomClassName:this.base.atomClass.atomClassName,name:"submit"});var n,a=h(this.actions.list);try{for(a.s();!(n=a.n()).done;){var r=n.value;if(!("write"===r.name&&0===this.base.item.atomStage||"read"===r.name&&"view"===this.container.mode)){var o=this.getAction(r);if(o.stage&&!o.stage.split(",").some((function(e){return t.$meta.config.modules["a-base"].stage[e]===t.base.item.atomStage})))continue;e.push(r)}}}catch(t){a.e(t)}finally{a.f()}return this.base.item.atomStage>0&&!this.actions_findAction("write")&&e.push({module:this.base.atomClass.module,atomClassName:this.base.atomClass.atomClassName,name:"draft"}),this.base.item.atomIdFormal&&e.push({module:this.base.atomClass.module,atomClassName:this.base.atomClass.atomClassName,name:"formal"}),(this.base.item.atomIdFormal||1===this.base.item.atomStage)&&e.push({module:this.base.atomClass.module,atomClassName:this.base.atomClass.atomClassName,name:"history"}),e.length>0?e:null}},methods:{actions_fetchActions:function(){var t,e=this;return(t=regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$api.post("/a/base/atom/actions",{key:{atomId:e.container.atomId}});case 2:e.actions.list=t.sent;case 3:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(a,r){var o=t.apply(e,n);function i(t){d(o,a,r,i,s,"next",t)}function s(t){d(o,a,r,i,s,"throw",t)}i(void 0)}))})()},actions_findAction:function(t){return this.actions.list?this.actions.list.find((function(e){return e.name===t})):null},actions_onSubmit:function(){this.$refs.buttonSave.onClick()},actions_submit:function(t,e){var n=this.validate_getInstance();if(n)return n.perform(t,{action:e})},actions_onAction:function(t,e){if("save"===e||"submit"===e)return this.actions_submit(t,e);if("submit"===e.name)return this.actions_submit(t,e.name);"string"==typeof e&&(e={module:this.base.atomClass.module,atomClassName:this.base.atomClass.atomClassName,name:e});var n=this.getAction(e);return"write"===e.name&&(n=this.$utils.extend({},n,{navigateOptions:{target:"_self"}})),this.$meta.util.performAction({ctx:this,action:n,item:this.base.item})},actions_render:function(){var t=this,e=this.$createElement;if(!this.base_ready)return null;var n=[];if(this.actions_findAction("write")&&0===this.base.item.atomStage){var a="edit"===this.container.mode?"save":"edit",r="edit"===this.container.mode?"save":"write";n.push(e("eb-link",{key:r,ref:"buttonSave",attrs:{iconMaterial:a},props:{onPerform:function(e){return t.actions_onAction(e,r)}}}))}return this.actions_listPopover&&n.push(e("f7-link",{key:"actionsPopover",attrs:{iconMaterial:"more_horiz","popover-open":"#".concat(this.actions.popoverId)}})),n},actions_renderPopover:function(){var t,e=this,n=this.$createElement,a=this.actions_listPopover;if(a){var r,o=[],i=h(a);try{var s=function(){var t=r.value,a=e.getAction(t);o.push(n("eb-list-item",{key:t.id,attrs:{link:"#","popover-close":!0},props:{onPerform:function(n){return e.actions_onAction(n,t)}}},[n("f7-icon",{slot:"media",attrs:{material:a.icon&&a.icon.material}}),n("div",{slot:"title"},[e.getActionTitle(t,e.base.item.atomStage)])]))};for(i.s();!(r=i.n()).done;)s()}catch(t){i.e(t)}finally{i.f()}t=n("f7-list",{attrs:{inset:!0}},[o])}return n("f7-popover",{attrs:{id:this.actions.popoverId}},[t])}}},b={mixins:[r().prototype.$meta.module.get("a-base").options.mixins.ebAtomClasses,r().prototype.$meta.module.get("a-base").options.mixins.ebAtomActions,s,{data:function(){return{}},methods:{page_getTitle:function(){var t="edit"===this.container.mode?this.$text("Edit"):this.$text("View");return this.base.item?"".concat(t,": ").concat(this.base.item.atomName):t},page_getSubtitle:function(){var t=this.base_getCurrentStage();return t&&"formal"!==t?this.$text(t.replace(t[0],t[0].toUpperCase())):""}}},c,{data:function(){return{subnavbar:{enable:!1}}},methods:{}},m,p,{data:function(){return{}},methods:{validate_getInstance:function(){return this.$refs.validate},validate_onSubmit:function(){this.actions_onSubmit()},validate_onPerformValidate:function(t,e){var n=e&&e.action,a=this.$utils.extend({},this.actions_findAction("write"),{name:n}),r=this.getAction(a);return this.$meta.util.performAction({ctx:this,action:r,item:this.base.item})},validate_render:function(){var t=this.$createElement;return this.base_ready?t("eb-validate",{ref:"validate",attrs:{readOnly:"edit"!==this.container.mode,auto:!0,data:this.base.item,params:this.base.validateParams},props:{onPerform:this.validate_onPerformValidate},on:{submit:this.validate_onSubmit}}):null}}}],data:function(){return{}},created:function(){var t=this;this.base_loadItem().then((function(e){e&&t.layout_prepareConfig().then((function(){t.base.ready=!0}))}))},beforeDestroy:function(){this.layout.instance=null,this.$emit("layoutManager:destroy")}}},632:(t,e,n)=>{"use strict";n.d(e,{Z:()=>d});var a=n(5),r=n.n(a);function o(t,e,n,a,r,o,i){try{var s=t[o](i),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(a,r)}const i={data:function(){return{layout:{current:null,config:null,instance:null}}},created:function(){this.layout.current=this.container.layout||this.layout_get()},methods:{layout_get:function(){return"small"===this.$view.size?"list":"table"},layout_prepareConfig:function(){var t,e=this;return(t=regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.base.configAtomBase=e.$meta.config.modules["a-basefront"].atom,!e.container.atomClass){t.next=5;break}return t.next=4,e.$meta.module.use(e.container.atomClass.module);case 4:e.base.configAtom=e.$meta.util.getProperty(e.$meta.config.modules[e.container.atomClass.module],"atoms.".concat(e.container.atomClass.atomClassName));case 5:e.base.config=e.base.configAtom?e.$meta.util.extend({},e.base.configAtomBase,e.base.configAtom):e.base.configAtomBase,e.layout.config=e.$meta.util.getProperty(e.base.config,"render.list.layouts.".concat(e.layout.current));case 7:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(a,r){var i=t.apply(e,n);function s(t){o(i,a,r,s,l,"next",t)}function l(t){o(i,a,r,s,l,"throw",t)}s(void 0)}))})()},layout_getComponentOptions:function(){return{props:{layoutManager:this,layoutConfig:this.layout.config}}},layout_renderComponent:function(){var t=this.$createElement;return this.base.ready?t("eb-component",{attrs:{module:this.layout.config.component.module,name:this.layout.config.component.name,options:this.layout_getComponentOptions()}}):null},layout_getBlockComponentOptions:function(t){return{props:{layoutManager:this,blockConfig:t.blockConfig}}},layout_renderBlock:function(t){var e=t.blockName,n=this.$createElement;if(!this.base.ready)return null;var a=this.layout.config.blocks[e];return a?n("eb-component",{attrs:{module:a.component.module,name:a.component.name,options:this.layout_getBlockComponentOptions({blockConfig:a})}}):null},layout_renderLayout:function(){return(0,this.$createElement)("div",[this.layout_renderComponent(),this.order_renderPopover()])}}};function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}const l={data:function(){return{bulk:{actions:null,selectedAtoms:[],selecting:!1}}},methods:{bulk_onAction:function(t,e){this.$f7.tooltip.hide(t.currentTarget);var n=this.getAction(e);if(n){n=this.$utils.extend({},n,{targetEl:t.target});var a={atomClassId:e.atomClassId,module:e.module,atomClassName:e.atomClassName,atomClassIdParent:e.atomClassIdParent};if("create"===n.name){var r=this.$meta.util.getProperty(this.container.params,"createParams");r&&(a=this.$utils.extend({},a,r));var o=this.base_prepareSelectParams({setOrder:!1});o.options.language&&(a.atomLanguage=o.options.language),o.options.category&&(a.atomCategoryId=o.options.category)}return this.$meta.util.performAction({ctx:this,action:n,item:a})}},bulk_loadActions:function(){var t=this;this.bulk.actions||this.$api.post("/a/base/atom/actionsBulk",{atomClass:this.container.atomClass}).then((function(e){t.bulk.actions=e}))},bulk_clearSelectedAtoms:function(){this.bulk.selectedAtoms=[]},bulk_onSelectingSwitch:function(){this.bulk.selecting=!this.bulk.selecting,this.bulk.selecting||this.bulk_clearSelectedAtoms()},bulk_onItemChange:function(t,e){var n=this.bulk.selectedAtoms,a=n.findIndex((function(t){return t.atomId===e.atomId}));t.target.checked&&-1===a?n.push(e):!t.target.checked&&a>-1&&n.splice(a,1)},bulk_onSelectingChecking:function(){var t=this.base_getItems();this.bulk.selectedAtoms.length>=t.length?this.bulk.selectedAtoms=[]:this.bulk.selectedAtoms=t.concat()},bulk_renderActionsLeft:function(){var t=this.$createElement,e=[],n=this.base_getItems(),a=this.bulk.selectedAtoms;return(n.length>0||this.bulk.selecting)&&e.push(t("eb-link",{key:"actionsLeft:select",attrs:{iconMaterial:"grading"},props:{onPerform:this.bulk_onSelectingSwitch}})),this.bulk.selecting&&e.push(t("eb-link",{key:"actionsLeft:selectChecking",attrs:{iconMaterial:a.length>=n.length?"check_box_outline_blank":"check_box",iconBadge:a.length.toString()},props:{onPerform:this.bulk_onSelectingChecking}})),e},bulk_renderActionsLeftB:function(){var t=this.$createElement,e=[],n=this.bulk.selectedAtoms;return e.push(t("eb-link",{key:"actionsLeftB:select",attrs:{iconMaterial:"grading",iconBadge:this.bulk.selecting?n.length.toString():0},props:{onPerform:this.bulk_onSelectingSwitch}})),e},bulk_renderActionsRight:function(){var t=this,e=this.$createElement,n=[],a=this.bulk.selectedAtoms;if(this.bulk.actions&&this.actionsAll){var r,o=function(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var a=0,r=function(){};return{s:r,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return i=t.done,t},e:function(t){l=!0,o=t},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw o}}}}(this.bulk.actions);try{var i=function(){var o=r.value,i=t.getAction(o);(void 0===i.select||null===i.select||!0===i.select&&a.length>0||!1===i.select&&!t.bulk.selecting)&&n.push(e("eb-link",{key:"actionsRight:".concat(i.name),attrs:{iconMaterial:i.icon&&i.icon.material,tooltip:i.icon&&i.titleLocale},props:{onPerform:function(e){return t.bulk_onAction(e,o)}}},[!i.icon&&i.titleLocale]))};for(o.s();!(r=o.n()).done;)i()}catch(t){o.e(t)}finally{o.f()}}return n}}};function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}const u={data:function(){return{order:{selected:null}}},computed:{order_current:function(){return this.order.selected||this.order_default()},order_list:function(){var t=this.base.configAtomBase.render.list.info.orders,e=this.$meta.util.getProperty(this.base.configAtom,"render.list.info.orders");return e?t.concat(e):t}},methods:{order_default:function(t){return t||(t=this.base_prepareSelectParams({setOrder:!1})),"select"===this.container.scene?{name:"atomName",by:"asc",tableAlias:"a"}:t.options.star?{name:"updatedAt",by:"desc",tableAlias:"d"}:t.options.label?{name:"updatedAt",by:"desc",tableAlias:"e"}:{name:"atomUpdatedAt",by:"desc",tableAlias:""}},order_onPerformPopover:function(t){var e=this.$refs.order_popover.$el;this.$f7.popover.open(e,t.currentTarget)},order_onPerformChange:function(t,e){var n=this.order_current;this.order_getKey(n)===this.order_getKey(e)?this.order.selected={name:n.name,tableAlias:n.tableAlias,by:"desc"===n.by?"asc":"desc"}:this.order.selected=e,this.page_onRefresh()},order_getKey:function(t){return t?""===t.tableAlias?t.name:"".concat(t.tableAlias||"f",".").concat(t.name):null},order_getStatus:function(t){var e=this.order_current;return this.order_getKey(e)===this.order_getKey(t)?"desc"===e.by?"arrow_drop_down":"arrow_drop_up":""},order_renderAction:function(){var t=this;return(0,this.$createElement)("eb-link",{attrs:{iconMaterial:"sort"},props:{onPerform:function(e){return t.order_onPerformPopover(e)}}})},order_renderPopover:function(){var t=this,e=this.$createElement;if(!this.base.ready)return null;var n,a=[],r=function(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var a=0,r=function(){};return{s:r,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return i=t.done,t},e:function(t){s=!0,o=t},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}(this.order_list);try{var o=function(){var r=n.value;a.push(e("eb-list-item",{key:t.order_getKey(r),attrs:{popoverClose:!0,link:"#"},props:{onPerform:function(e){return t.order_onPerformChange(e,r)}}},[e("f7-icon",{slot:"media",attrs:{material:t.order_getStatus(r)}}),e("div",{slot:"title"},[t.$text(r.title)])]))};for(r.s();!(n=r.n()).done;)o()}catch(t){r.e(t)}finally{r.f()}return e("eb-popover",{ref:"order_popover",attrs:{ready:!0}},[e("f7-list",{attrs:{inset:!0}},[a])])}}},m={data:function(){return{filter:{data:null}}},methods:{filter_prepareSelectParams:function(){if(!this.filter.data)return null;var t={where:{}},e={options:t},n=this.filter.data.form;n&&(n.atomName&&(t.where["a.atomName"]={val:n.atomName,op:"like"}),t.mine=Number(n.mine),t.stage=n.stage,n.language&&(t.language=n.language),n.category&&(t.category=n.category),n.tag&&(t.tag=n.tag),t.star=Number(n.star),t.label=Number(n.label),e.atomClass=n.atomClass);var a=this.filter.data.formAtomClass;if(a){var r=!1;for(var o in a){var i=a[o];null!=i&&""!==i&&(t.where["f.".concat(o)]="string"==typeof i?{val:i,op:"like"}:i,r=!0)}r&&(t.mode="search")}return e},filter_getConfig:function(){return this.$meta.util.getProperty(this.base.config,"render.list.info.filter")},filter_onPerform:function(){var t=this.$view.inPanel(),e="pc"===this.$meta.vueApp.layout&&!t,n={context:{params:{layoutManager:this,filterConfig:this.filter_getConfig(),immediate:e}}};e?(n.scene="sidebar",n.sceneOptions={side:"right",name:"filter",title:"Filter"}):n.target="_self",this.$view.navigate("/a/baselayout/listLayoutFilter?t=".concat(Date.now()),n)},filter_onChanged:function(t){this.filter.data=t,this.page_onRefresh()},filter_renderAction:function(){var t=this.$createElement;return this.container.params&&!0===this.container.params.disableFilter?null:t("eb-link",{attrs:{iconMaterial:"search"},props:{onPerform:this.filter_onPerform}})}}},d={mixins:[r().prototype.$meta.module.get("a-base").options.mixins.ebAtomClasses,r().prototype.$meta.module.get("a-base").options.mixins.ebAtomActions,{data:function(){return{base:{ready:!1,configAtomBase:null,configAtom:null,config:null}}},computed:{base_user:function(){return this.$store.state.auth.user.op},base_userLabels:function(){return this.$store.getters["a/base/userLabels"]}},created:function(){this.$store.dispatch("a/base/getLabels")},methods:{base_prepareReadOptions:function(){var t={};return t.layout=this.layout.current,t},base_prepareSelectOptions:function(){var t={where:{}};return t.layout=this.layout.current,this.search.query&&(t.where["a.atomName"]={val:this.search.query,op:"like"}),"select"===this.container.scene&&(t.where["a.id"]=this.container.params.selectedAtomIds.length>0?this.container.params.selectedAtomIds:null),this.container.options&&(t=this.$utils.extend({},t,this.container.options)),t},base_prepareSelectParams:function(t){var e=!t||!1!==t.setOrder,n=this.base_prepareSelectOptions(),a={atomClass:this.container.atomClass,options:n},r=this.filter_prepareSelectParams();if(r&&(a=this.$utils.extend({},a,r)),e){var o=this.order.selected||this.order_default(a);a.options.orders=[[this.order_getKey(o),o.by]]}return a},base_getItems:function(){return this.layout.instance?this.layout.instance.getItems():[]},base_getCurrentStage:function(){var t=this.$meta.util.getProperty(this.filter.data,"form.stage");return t||(t=this.container.options&&this.container.options.stage),t||(t="formal"),t},base_getExportFields:function(){return this.$meta.util.getProperty(this.base.config,"render.list.info.export.fields")}}},{data:function(){return{}},methods:{page_onRefresh:function(t){t&&t(),this.layout.instance&&this.layout.instance.onPageRefresh(!0)},page_onInfinite:function(){this.layout.instance&&this.layout.instance.onPageInfinite()},page_onClear:function(){this.layout.instance&&this.layout.instance.onPageClear()},page_getTitle:function(){if(this.container.params&&this.container.params.pageTitle)return this.container.params.pageTitle;var t=this.getAtomClass(this.container.atomClass),e=t&&t.titleLocale;return"select"===this.container.scene?t?"".concat(this.$text("Select")," ").concat(e):"".concat(this.$text("Select")," ").concat(this.$text("Atom")):"selecting"===this.container.scene?t?"".concat(this.$text("Selecting")," ").concat(e):"".concat(this.$text("Selecting")," ").concat(this.$text("Atom")):"search"===this.container.scene?t?"".concat(this.$text("Search")," ").concat(e):"".concat(this.$text("Search")," ").concat(this.$text("Atom")):t?"".concat(this.$text("Atom"),": ").concat(e):this.$text("Atom")},page_getSubtitle:function(){var t=this.base_getCurrentStage();return t&&"formal"!==t?this.$text(t.replace(t[0],t[0].toUpperCase())):""}}},i,l,{data:function(){return{search:{query:null}}},methods:{search_onSearch:function(t){this.search.query=t,this.search.query?this.page_onRefresh():this.page_onClear()},search_onSearchDisable:function(){this.$f7router.back()},search_onSearchAdvanced:function(){this.filter_onPerform()}}},{data:function(){return{}},methods:{select_getSelectedAtoms:function(){return"selecting"===this.container.scene?this.container.params.selectedAtoms:"select"===this.container.scene?this.base_getItems():void 0}}},u,m,{data:function(){return{subnavbar:{enable:!1}}},methods:{}},{data:function(){return{bottombar:{enable:!1}}},methods:{}}],data:function(){return{}},created:function(){var t=this;this.layout_prepareConfig().then((function(){t.base.ready=!0}))},beforeDestroy:function(){this.layout.instance=null,this.$emit("layoutManager:destroy")}}},696:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>a});const a={meta:{size:"medium"},mixins:[n(654).Z],data:function(){var t=this.$f7route.query;return{container:{mode:t.mode,atomId:parseInt(t.atomId||0),itemId:parseInt(t.itemId||0),layout:t.layout}}},render:function(){var t=arguments[0];return t("eb-page",{attrs:{withSubnavbar:this.subnavbar.enable}},[t("eb-navbar",{attrs:{title:this.page_getTitle(),subtitle:this.page_getSubtitle(),"eb-back-link":"Back"}},[this.layout_renderBlock({blockName:"title"}),this.layout.instance&&this.subnavbar.enable&&this.layout_renderBlock({blockName:"subnavbar"})]),this.layout_renderLayout()])}}},235:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>a});const a={mixins:[n(632).Z],data:function(){var t=this.$f7route.query,e=t&&t.module,n=t&&t.atomClassName;return{container:{atomClass:e&&n?{module:e,atomClassName:n}:null,options:t&&t.options?JSON.parse(t.options):null,params:t&&t.params?JSON.parse(t.params):null,scene:t&&t.scene,layout:t&&t.layout}}},render:function(){var t=arguments[0];return t("eb-page",{attrs:{withSubnavbar:this.subnavbar.enable,ptr:!0,infinite:!0,infinitePreloader:!1},on:{ptrRefresh:this.page_onRefresh,infinite:this.page_onInfinite}},[t("eb-navbar",{attrs:{title:this.page_getTitle(),subtitle:this.page_getSubtitle(),"eb-back-link":"Back"}},[this.layout_renderBlock({blockName:"title"}),this.layout.instance&&this.subnavbar.enable&&this.layout_renderBlock({blockName:"subnavbar"})]),t("f7-toolbar",{attrs:{position:"bottom",hidden:!this.bottombar.enable}},[this.layout.instance&&this.bottombar.enable&&this.layout_renderBlock({blockName:"bottombar"})]),this.layout_renderLayout()])}}},368:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>i});var a=n(5),r=n.n(a),o=n(632);const i={mixins:[r().prototype.$meta.module.get("a-base").options.mixins.ebAtomClasses,o.Z],data:function(){var t=this.$f7route.query,e=t&&t.module,n=t&&t.atomClassName;return{container:{atomClass:e&&n?{module:e,atomClassName:n}:null,options:t&&t.options?JSON.parse(t.options):null,scene:"search",layout:"list"}}},render:function(){var t=arguments[0];return t("eb-search-page",{attrs:{advanced:!0,title:this.page_getTitle(),subtitle:this.page_getSubtitle(),advancedSearchTitle:"Advanced Filter"},on:{search:this.search_onSearch,loadMore:this.page_onInfinite,disable:this.search_onSearchDisable,searchAdvanced:this.search_onSearchAdvanced}},[this.layout_renderComponent()])}}},783:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>i});var a=n(5),r=n.n(a),o=n(632);const i={mixins:[r().prototype.$meta.module.get("a-components").options.mixins.ebPageContext,o.Z],data:function(){return{container:{atomClass:null,options:null,params:null,scene:"select",layout:"select"}}},created:function(){var t=this.contextParams;this.container.atomClass=t.atomClass,this.container.options=t.options;var e,n=t.selectMode;e="single"===t.selectMode?t.selectedAtomId?[t.selectedAtomId]:[]:t.selectedAtomIds?t.selectedAtomIds.concat():[],this.container.params={selectMode:n,selectedAtomIds:e}},render:function(){var t=arguments[0];return t("eb-page",{attrs:{ptr:!0,infinite:!0,infinitePreloader:!1},on:{ptrRefresh:this.page_onRefresh,infinite:this.page_onInfinite}},[t("eb-navbar",{attrs:{title:this.page_getTitle(),"eb-back-link":"Back"}},[this.layout_renderBlock({blockName:"title"})]),this.layout_renderLayout()])}}},239:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>i});var a=n(5),r=n.n(a),o=n(632);const i={mixins:[r().prototype.$meta.module.get("a-components").options.mixins.ebPageContext,o.Z],data:function(){return{container:{atomClass:null,options:null,params:null,scene:"selecting",layout:"selecting"}}},created:function(){var t=this.contextParams;this.container.atomClass=t.atomClass,this.container.options=t.options,this.container.params=t.params},render:function(){var t=arguments[0];return t("eb-page",{attrs:{ptr:!0,infinite:!0,infinitePreloader:!1},on:{ptrRefresh:this.page_onRefresh,infinite:this.page_onInfinite}},[t("eb-navbar",{attrs:{title:this.page_getTitle(),subtitle:this.page_getSubtitle(),"eb-back-link":"Back"}},[this.layout_renderBlock({blockName:"title"})]),this.layout_renderLayout()])}}},458:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>c});var a=n(5);function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l(t,e,n,a,r,o,i){try{var s=t[o](i),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(a,r)}const c={meta:{size:"medium"},mixins:[n.n(a)().prototype.$meta.module.get("a-components").options.mixins.ebPageContext],data:function(){return{content:null}},computed:{value:function(){return this.contextParams.value},pageTitle:function(){return this.contextParams.title},readOnly:function(){return this.contextParams.readOnly},immediate:function(){return this.contextParams.immediate},onSave:function(){return this.contextParams.onSave},actions:function(){return this.contextParams.actions},context:function(){return this.contextParams.context}},created:function(){this.value?"string"==typeof this.value?this.content=window.JSON5.stringify(window.JSON5.parse(this.value),null,2):this.content=window.JSON5.stringify(this.value,null,2):this.content="{}"},methods:{onSize:function(t){this.$$(this.$refs.textarea).css({height:"".concat(t.height-20,"px"),width:"".concat(t.width-20,"px")})},onInput:function(t){this.content=t.target.value},getValue:function(){return this.content?JSON.stringify(window.JSON5.parse(this.content)):null},onPerformDone:function(){var t=this.getValue();this.contextCallback(200,t),this.$f7router.back()},onPerformSave:function(){var t=this,e=this.getValue();return this.onSave(e).then((function(){return t.$text("Saved")}))},onPerformAction:function(t,e){var n,a=this;return(n=regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e=i(i({},e),{},{targetEl:t.target}),n.next=3,a.$meta.util.performAction({ctx:a,action:e,item:a.context});case 3:case"end":return n.stop()}}),n)})),function(){var t=this,e=arguments;return new Promise((function(a,r){var o=n.apply(t,e);function i(t){l(o,a,r,i,s,"next",t)}function s(t){l(o,a,r,i,s,"throw",t)}i(void 0)}))})()},renderActions:function(){var t=this,e=this.$createElement;if(this.actions){var n,a=[],o=function(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var a=0,o=function(){};return{s:o,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,l=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){l=!0,i=t},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw i}}}}(this.actions);try{var i=function(){var r=n.value;a.push(e("eb-link",{attrs:{iconMaterial:r.icon&&r.icon.material},props:{onPerform:function(e){return t.onPerformAction(e,r)}}}))};for(o.s();!(n=o.n()).done;)i()}catch(t){o.e(t)}finally{o.f()}return a}}},render:function(){var t,e=arguments[0];return this.readOnly||(t=this.immediate?e("eb-link",{attrs:{iconMaterial:"save"},props:{onPerform:this.onPerformSave}}):e("eb-link",{attrs:{iconMaterial:"done"},props:{onPerform:this.onPerformDone}})),e("eb-page",[e("eb-navbar",{attrs:{title:this.pageTitle,"eb-back-link":"Back"}},[e("f7-nav-right",[t,this.renderActions()])]),e("eb-box",{on:{size:this.onSize}},[e("textarea",{ref:"textarea",attrs:{readonly:!!this.readOnly&&"readonly",type:"textarea"},domProps:{value:this.content},on:{input:this.onInput},class:"json-textarea json-textarea-margin"})])])}}},891:(t,e,n)=>{var a=n(233),r=n(361)(a);r.push([t.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]),t.exports=r},706:(t,e,n)=>{var a=n(233),r=n(361)(a);r.push([t.id,".selected-tags[data-v-7d6e9423] {\n  min-height: 40px;\n}\n.selected-tags .chip + .chip[data-v-7d6e9423] {\n  margin-left: 6px;\n}\n.tags[data-v-7d6e9423] {\n  justify-content: space-around;\n}\n.tags .chip[data-v-7d6e9423] {\n  cursor: pointer;\n}\n.tags .chip .chip-media[data-v-7d6e9423] {\n  min-width: 32px;\n  width: auto;\n  border: 1px solid var(--f7-block-header-text-color);\n  color: var(--f7-block-header-text-color);\n}\n","",{version:3,sources:["webpack://./front/src/pages/tag/tagSelect.vue","webpack://./tagSelect.vue"],names:[],mappings:"AA6IA;EACE,gBAAA;AC5IF;ADgJI;EACE,gBAAA;AC9IN;ADmJA;EACE,6BAAA;ACjJF;ADgJA;EAII,eAAA;ACjJJ;AD6IA;EAOM,eAAA;EACA,WAAA;EACA,mDAAA;EACA,wCAAA;ACjJN",sourcesContent:["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.selected-tags {\n  min-height: 40px;\n\n  .chip {\n\n    &+.chip {\n      margin-left: 6px;\n    }\n  }\n}\n\n.tags {\n  justify-content: space-around;\n\n  .chip {\n    cursor: pointer;\n\n    .chip-media {\n      min-width: 32px;\n      width: auto;\n      border: 1px solid var(--f7-block-header-text-color);\n      color: var(--f7-block-header-text-color);\n    }\n\n  }\n\n}\n\n",".selected-tags {\n  min-height: 40px;\n}\n.selected-tags .chip + .chip {\n  margin-left: 6px;\n}\n.tags {\n  justify-content: space-around;\n}\n.tags .chip {\n  cursor: pointer;\n}\n.tags .chip .chip-media {\n  min-width: 32px;\n  width: auto;\n  border: 1px solid var(--f7-block-header-text-color);\n  color: var(--f7-block-header-text-color);\n}\n"],sourceRoot:""}]),t.exports=r},705:(t,e,n)=>{var a=n(233),r=n(361)(a);r.push([t.id,"\n.label[data-v-fddf3ea0] {\n  position: absolute;\n  width: 100%;\n  top: 10px;\n  text-align: center;\n}\n.media[data-v-fddf3ea0] {\n  width: 16px;\n  height: 16px;\n  border-radius: 8px;\n}\n.colors[data-v-fddf3ea0] {\n  height: 60px;\n  width: 100%;\n}\n\n","",{version:3,sources:["webpack://./front/src/pages/atom/labels.vue"],names:[],mappings:";AAqJA;EACA,kBAAA;EACA,WAAA;EACA,SAAA;EACA,kBAAA;AACA;AAEA;EACA,WAAA;EACA,YAAA;EACA,kBAAA;AACA;AAEA;EACA,YAAA;EACA,WAAA;AACA",sourcesContent:['<template>\n  <eb-page>\n    <eb-navbar large largeTransparent :title="$text(\'Labels\')" eb-back-link="Back">\n      <f7-nav-right>\n        <eb-link iconMaterial="add" @click.prevent="onAddLabel"></eb-link>\n        <eb-link iconMaterial="done" @click.prevent="onDone"></eb-link>\n      </f7-nav-right>\n    </eb-navbar>\n    <f7-list v-if="labelsAll">\n      <f7-list-item group-title :title="item?item.atomName:\'\'"></f7-list-item>\n      <eb-list-item v-for="key of Object.keys(labelsAll)" :key="key" :title="labelsAll[key].text" checkbox :checked="labelChecked(key)" @change="onLabelCheckChange($event,key)" swipeout>\n        <div slot="media" class="media" :style="{backgroundColor:labelsAll[key].color}"></div>\n        <eb-context-menu>\n          <div slot="right">\n            <div close color="orange" :context="key" :onPerform="onEditLabel">{{$text(\'Edit\')}}</div>\n          </div>\n        </eb-context-menu>\n      </eb-list-item>\n    </f7-list>\n    <f7-sheet ref="ebSheet" fill :opened="sheetOpened" @sheet:closed="sheetOpened = false">\n      <f7-toolbar>\n        <div class="left">\n          <f7-link sheet-close>{{$text(\'Close\')}}</f7-link>\n        </div>\n        <div class="right">\n          <eb-link ref="buttonSubmit" :onPerform="onSubmit">{{$text(\'Submit\')}}</eb-link>\n        </div>\n      </f7-toolbar>\n      <f7-page-content>\n        <div class="label">\n          <f7-badge :style="{backgroundColor:labelColor}">{{labelText}}</f7-badge>\n        </div>\n        <eb-list form inline-labels no-hairlines-md @submit="onFormSubmit">\n          <eb-list-input :label="$text(\'Text\')" type="text" clear-button :placeholder="$text(\'Text\')" v-model="labelText">\n          </eb-list-input>\n          <f7-list-item>\n            <div class="row colors">\n              <f7-button v-for="color of colors" :key="color.value" class="col-33" :style="{backgroundColor:color.value}" small fill @click="onColorSelect(color)">{{$text(color.name)}}</f7-button>\n            </div>\n          </f7-list-item>\n        </eb-list>\n      </f7-page-content>\n    </f7-sheet>\n  </eb-page>\n</template>\n<script>\nexport default {\n  data() {\n    return {\n      atomId: parseInt(this.$f7route.query.atomId),\n      item: null,\n      labels: [],\n      sheetOpened: false,\n      labelId: 0,\n      labelText: \'\',\n      labelColor: \'\',\n      colors: [\n        { name: \'Red\', value: \'#FC6360\' },\n        { name: \'Orange\', value: \'#FDA951\' },\n        { name: \'Yellow\', value: \'#FED558\' },\n        { name: \'Blue\', value: \'#54BEF7\' },\n        { name: \'Green\', value: \'#86DF6A\' },\n        { name: \'Purple\', value: \'#D592E5\' },\n      ],\n    };\n  },\n  computed: {\n    labelsAll() {\n      return this.$store.getters[\'a/base/userLabels\'];\n    },\n  },\n  methods: {\n    onDone() {\n      this.$f7router.back();\n    },\n    onAddLabel() {\n      this.labelId = 0;\n      this.labelText = \'\';\n      this.labelColor = \'\';\n      this.sheetOpened = true;\n    },\n    onEditLabel(event, key) {\n      this.labelId = key;\n      this.labelText = this.labelsAll[key].text;\n      this.labelColor = this.labelsAll[key].color;\n      this.sheetOpened = true;\n    },\n    onFormSubmit() {\n      this.$refs.buttonSubmit.onClick();\n    },\n    onSubmit() {\n      if (!this.labelText || !this.labelColor) return;\n      const labels = this.$meta.util.extend({}, this.labelsAll);\n      if (this.labelId === 0) {\n        labels[this.newLabelId()] = { text: this.labelText, color: this.labelColor };\n      } else {\n        labels[this.labelId] = { text: this.labelText, color: this.labelColor };\n      }\n      return this.$api.post(\'/a/base/user/setLabels\', {\n        labels,\n      }).then(() => {\n        this.$store.commit(\'a/base/setLabels\', labels);\n        this.sheetOpened = false;\n      });\n    },\n    onColorSelect(color) {\n      this.labelColor = color.value;\n    },\n    newLabelId() {\n      const keys = Object.keys(this.labelsAll);\n      if (keys.length === 0) return 1;\n      keys.sort((a, b) => b - a);\n      return parseInt(keys[0]) + 1;\n    },\n    labelChecked(key) {\n      return this.labels && this.labels.indexOf(key) > -1;\n    },\n    onLabelCheckChange(event, key) {\n      // labels\n      const index = this.labels.indexOf(key);\n      if (event.target.checked && index === -1) {\n        this.labels.push(key);\n      } else if (!event.target.checked && index > -1) {\n        this.labels.splice(index, 1);\n      }\n      // sort\n      this.labels.sort((a, b) => a - b);\n      // post\n      this.$api.post(\'/a/base/atom/labels\', {\n        key: { atomId: this.atomId },\n        atom: { labels: this.labels },\n      }).then(() => {\n        this.$meta.eventHub.$emit(\'atom:labels\', { key: { atomId: this.atomId }, labels: this.labels });\n      });\n    },\n  },\n  created() {\n    this.$store.dispatch(\'a/base/getLabels\');\n    this.$api.post(\'/a/base/atom/read\', {\n      key: { atomId: this.atomId },\n    }).then(data => {\n      this.item = data;\n      this.labels = JSON.parse(this.item.labels) || [];\n    });\n  },\n};\n\n<\/script>\n<style scoped>\n.label {\n  position: absolute;\n  width: 100%;\n  top: 10px;\n  text-align: center;\n}\n\n.media {\n  width: 16px;\n  height: 16px;\n  border-radius: 8px;\n}\n\n.colors {\n  height: 60px;\n  width: 100%;\n}\n\n</style>\n'],sourceRoot:""}]),t.exports=r},361:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=t(e);return e[2]?"@media ".concat(e[2]," {").concat(n,"}"):n})).join("")},e.i=function(t,n,a){"string"==typeof t&&(t=[[null,t,""]]);var r={};if(a)for(var o=0;o<this.length;o++){var i=this[o][0];null!=i&&(r[i]=!0)}for(var s=0;s<t.length;s++){var l=[].concat(t[s]);a&&r[l[0]]||(n&&(l[2]?l[2]="".concat(n," and ").concat(l[2]):l[2]=n),e.push(l))}},e}},233:t=>{"use strict";function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}t.exports=function(t){var n,a,r=(a=4,function(t){if(Array.isArray(t))return t}(n=t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=t[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!e||n.length!==e);a=!0);}catch(t){r=!0,o=t}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return n}}(n,a)||function(t,n){if(t){if("string"==typeof t)return e(t,n);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?e(t,n):void 0}}(n,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[1],i=r[3];if("function"==typeof btoa){var s=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),c="/*# ".concat(l," */"),u=i.sources.map((function(t){return"/*# sourceURL=".concat(i.sourceRoot||"").concat(t," */")}));return[o].concat(u).concat([c]).join("\n")}return[o].join("\n")}},888:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r});const a={data:function(){return{atomId:this.$f7route.query.atomId}},created:function(){var t=this;this.$api.post("/a/base/atom/star",{key:{atomId:this.atomId},atom:{star:1}}).then((function(){t.$view.dialog.alert(t.$text("Starred")).then((function(){t.openAtom()}))}))},methods:{openAtom:function(){location.assign(this.$f7route.query.returnTo)}}},r=(0,n(792).Z)(a,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",[n("eb-navbar",{attrs:{large:"",largeTransparent:"",title:t.$text("Star"),"eb-back-link":"Back"}}),t._v(" "),n("f7-block")],1)}),[],!1,null,null,null).exports},608:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r});const a={data:function(){return{atomId:parseInt(this.$f7route.query.atomId),item:null,labels:[],sheetOpened:!1,labelId:0,labelText:"",labelColor:"",colors:[{name:"Red",value:"#FC6360"},{name:"Orange",value:"#FDA951"},{name:"Yellow",value:"#FED558"},{name:"Blue",value:"#54BEF7"},{name:"Green",value:"#86DF6A"},{name:"Purple",value:"#D592E5"}]}},computed:{labelsAll:function(){return this.$store.getters["a/base/userLabels"]}},methods:{onDone:function(){this.$f7router.back()},onAddLabel:function(){this.labelId=0,this.labelText="",this.labelColor="",this.sheetOpened=!0},onEditLabel:function(t,e){this.labelId=e,this.labelText=this.labelsAll[e].text,this.labelColor=this.labelsAll[e].color,this.sheetOpened=!0},onFormSubmit:function(){this.$refs.buttonSubmit.onClick()},onSubmit:function(){var t=this;if(this.labelText&&this.labelColor){var e=this.$meta.util.extend({},this.labelsAll);return 0===this.labelId?e[this.newLabelId()]={text:this.labelText,color:this.labelColor}:e[this.labelId]={text:this.labelText,color:this.labelColor},this.$api.post("/a/base/user/setLabels",{labels:e}).then((function(){t.$store.commit("a/base/setLabels",e),t.sheetOpened=!1}))}},onColorSelect:function(t){this.labelColor=t.value},newLabelId:function(){var t=Object.keys(this.labelsAll);return 0===t.length?1:(t.sort((function(t,e){return e-t})),parseInt(t[0])+1)},labelChecked:function(t){return this.labels&&this.labels.indexOf(t)>-1},onLabelCheckChange:function(t,e){var n=this,a=this.labels.indexOf(e);t.target.checked&&-1===a?this.labels.push(e):!t.target.checked&&a>-1&&this.labels.splice(a,1),this.labels.sort((function(t,e){return t-e})),this.$api.post("/a/base/atom/labels",{key:{atomId:this.atomId},atom:{labels:this.labels}}).then((function(){n.$meta.eventHub.$emit("atom:labels",{key:{atomId:n.atomId},labels:n.labels})}))}},created:function(){var t=this;this.$store.dispatch("a/base/getLabels"),this.$api.post("/a/base/atom/read",{key:{atomId:this.atomId}}).then((function(e){t.item=e,t.labels=JSON.parse(t.item.labels)||[]}))}};n(594);const r=(0,n(792).Z)(a,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",[n("eb-navbar",{attrs:{large:"",largeTransparent:"",title:t.$text("Labels"),"eb-back-link":"Back"}},[n("f7-nav-right",[n("eb-link",{attrs:{iconMaterial:"add"},on:{click:function(e){return e.preventDefault(),t.onAddLabel(e)}}}),t._v(" "),n("eb-link",{attrs:{iconMaterial:"done"},on:{click:function(e){return e.preventDefault(),t.onDone(e)}}})],1)],1),t._v(" "),t.labelsAll?n("f7-list",[n("f7-list-item",{attrs:{"group-title":"",title:t.item?t.item.atomName:""}}),t._v(" "),t._l(Object.keys(t.labelsAll),(function(e){return n("eb-list-item",{key:e,attrs:{title:t.labelsAll[e].text,checkbox:"",checked:t.labelChecked(e),swipeout:""},on:{change:function(n){return t.onLabelCheckChange(n,e)}}},[n("div",{staticClass:"media",style:{backgroundColor:t.labelsAll[e].color},attrs:{slot:"media"},slot:"media"}),t._v(" "),n("eb-context-menu",[n("div",{attrs:{slot:"right"},slot:"right"},[n("div",{attrs:{close:"",color:"orange",context:e,onPerform:t.onEditLabel}},[t._v(t._s(t.$text("Edit")))])])])],1)}))],2):t._e(),t._v(" "),n("f7-sheet",{ref:"ebSheet",attrs:{fill:"",opened:t.sheetOpened},on:{"sheet:closed":function(e){t.sheetOpened=!1}}},[n("f7-toolbar",[n("div",{staticClass:"left"},[n("f7-link",{attrs:{"sheet-close":""}},[t._v(t._s(t.$text("Close")))])],1),t._v(" "),n("div",{staticClass:"right"},[n("eb-link",{ref:"buttonSubmit",attrs:{onPerform:t.onSubmit}},[t._v(t._s(t.$text("Submit")))])],1)]),t._v(" "),n("f7-page-content",[n("div",{staticClass:"label"},[n("f7-badge",{style:{backgroundColor:t.labelColor}},[t._v(t._s(t.labelText))])],1),t._v(" "),n("eb-list",{attrs:{form:"","inline-labels":"","no-hairlines-md":""},on:{submit:t.onFormSubmit}},[n("eb-list-input",{attrs:{label:t.$text("Text"),type:"text","clear-button":"",placeholder:t.$text("Text")},model:{value:t.labelText,callback:function(e){t.labelText=e},expression:"labelText"}}),t._v(" "),n("f7-list-item",[n("div",{staticClass:"row colors"},t._l(t.colors,(function(e){return n("f7-button",{key:e.value,staticClass:"col-33",style:{backgroundColor:e.value},attrs:{small:"",fill:""},on:{click:function(n){return t.onColorSelect(e)}}},[t._v(t._s(t.$text(e.name)))])})),1)])],1)],1)],1)],1)}),[],!1,null,"fddf3ea0",null).exports},905:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>s});var a=n(5),r=n.n(a),o=r().prototype.$meta.module.get("a-base").options.mixins.ebAtomClasses;const i={mixins:[r().prototype.$meta.module.get("a-components").options.mixins.ebPageContext,o],data:function(){return{}},computed:{module:function(){return this.contextParams.atomClass?this.contextParams.atomClass.module:null},atomClassName:function(){return this.contextParams.atomClass?this.contextParams.atomClass.atomClassName:null},optional:function(){return this.contextParams.optional},atomClasses:function(){var t=this.atomClassesAll;if(!t)return[];var e=[];for(var n in this.optional&&e.push({title:null,module:null,atomClassName:null}),t)for(var a in t[n])e.push({title:t[n][a].titleLocale,module:n,atomClassName:a});return e}},methods:{onItemClick:function(t){var e=t.module?{module:t.module,atomClassName:t.atomClassName,title:t.title}:null;this.contextCallback(200,e),this.$f7router.back()}}},s=(0,n(792).Z)(i,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",[n("eb-navbar",{attrs:{large:"",largeTransparent:"",title:t.$text("Select Atom Class"),"eb-back-link":"Back"}}),t._v(" "),n("f7-list",t._l(t.atomClasses,(function(e,a){return n("f7-list-item",{key:a,attrs:{radio:"",checked:t.module===e.module&&t.atomClassName===e.atomClassName,title:e.title},on:{click:function(n){return t.onItemClick(e)}}})})),1)],1)}),[],!1,null,null,null).exports},150:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>o});var a=n(5);const r={mixins:[n.n(a)().prototype.$meta.module.get("a-base").options.mixins.ebAtomActions],data:function(){var t=this.$f7route.query,e=t&&t.module,n=t&&t.atomClassName,a=e&&n?{module:e,atomClassName:n}:null,r=t&&t.where?JSON.parse(t.where):null;if("mine"===(t&&t.scene)){r||(r={});var o=this.$store.state.auth.user.op;r["i.userId"]=o.id}return{atomClass:a,where:r,order:"desc",items:[]}},computed:{user:function(){return this.$store.state.auth.user.op}},created:function(){},mounted:function(){this.$meta.eventHub.$on("attachment:action",this.onAttachmentChanged)},beforeDestroy:function(){this.$meta.eventHub.$off("attachment:action",this.onAttachmentChanged)},methods:{onRefresh:function(t){t(),this.reload()},onInfinite:function(){this.$refs.loadMore.loadMore()},onLoadClear:function(t){this.items=[],t()},onLoadMore:function(t){var e=this,n=t.index,a={where:{mode:2,attachment:1},orders:[["i_createdAt",this.order]],page:{index:n}};return this.where&&(a.where=this.where),this.$api.post("/a/file/file/all",{atomClass:this.atomClass,options:a}).then((function(t){return e.items=e.items.concat(t.list),t}))},reload:function(){this.$refs.loadMore.reload()},onPerformSort:function(){this.order="desc"===this.order?"asc":"desc",this.reload()},onAttachmentChanged:function(t){},onPerformViewAtom:function(t,e){var n=this.getAction({module:e.module,atomClassName:e.atomClassName,name:"read"});if(n)return this.$meta.util.performAction({ctx:this,action:n,item:e})},onItemClick:function(t,e){var n=this;this.$meta.config.base.jwt?this.$api.post("/a/base/jwt/create").then((function(t){n._openUrl(e,t.jwt)})):this._openUrl(e,null)},_openUrl:function(t,e){e?window.open(this.$meta.util.combineQueries(t.i_downloadUrl,{"eb-jwt":e})):window.open(t.i_downloadUrl)}}},o=(0,n(792).Z)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",{attrs:{ptr:"",infinite:"",infinitePreloader:!1},on:{"ptr:refresh":t.onRefresh,infinite:t.onInfinite}},[n("eb-navbar",{attrs:{large:"",largeTransparent:"",title:t.$text("Attachment List"),"eb-back-link":"Back"}},[n("f7-nav-right",[n("eb-link",{attrs:{iconMaterial:"desc"===t.order?"arrow_downward":"arrow_upward",onPerform:t.onPerformSort}})],1)],1),t._v(" "),n("f7-list",t._l(t.items,(function(e){return n("eb-list-item",{key:e.id,staticClass:"item",attrs:{title:e.i_realName,link:"#",context:e,onPerform:t.onItemClick}},[n("div",{staticClass:"header",attrs:{slot:"root-start"},slot:"root-start"},[n("div",{staticClass:"userName"},[n("eb-link",{attrs:{context:e,onPerform:t.onPerformViewAtom}},[t._v(t._s(e.atomName))])],1),t._v(" "),n("div",{staticClass:"date"},[t._v(t._s(t.$meta.util.formatDateTimeRelative(e.i_createdAt)))])])])})),1),t._v(" "),n("eb-load-more",{ref:"loadMore",attrs:{onLoadClear:t.onLoadClear,onLoadMore:t.onLoadMore,autoInit:!0}})],1)}),[],!1,null,null,null).exports},740:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r});const a={data:function(){return{atomId:parseInt(this.$f7route.query.atomId),items:[],actionWrite:null}},computed:{user:function(){return this.$store.state.auth.user.op}},created:function(){this.checkActionWrite()},methods:{onRefresh:function(t){t(),this.reload()},onInfinite:function(){this.$refs.loadMore.loadMore()},onLoadClear:function(t){this.items=[],t()},onLoadMore:function(t){var e=this,n={where:{mode:2,attachment:1},orders:[["createdAt","asc"]],page:{index:t.index}};return this.$api.post("/a/file/file/list",{key:{atomId:this.atomId},options:n}).then((function(t){return e.items=e.items.concat(t.list),t}))},reload:function(){this.$refs.loadMore.reload()},checkActionWrite:function(){var t=this;this.$api.post("/a/base/atom/checkRightAction",{key:{atomId:this.atomId},action:3,stage:"draft",checkFlow:!0}).then((function(e){e&&0===e.atomClosed&&(t.actionWrite=e)}))},onPerformAdd:function(){var t=this;return new Promise((function(e,n){t.$view.navigate("/a/file/file/upload",{context:{params:{mode:2,atomId:t.atomId,attachment:1},callback:function(a,r){200===a&&(t.$meta.eventHub.$emit("attachment:action",{action:"create",atomId:t.atomId}),t.reload(),e()),!1===a&&n()}}})}))},onPerformDelete:function(t,e){var n=this;return this.$view.dialog.confirm().then((function(){return n.$api.post("/a/file/file/delete",{fileId:e.id}).then((function(){n.$meta.util.swipeoutClose(t.target),n.$meta.eventHub.$emit("attachment:action",{action:"delete",atomId:n.atomId,fileId:e.id}),n.deleteItem(e.id)}))}))},deleteItem:function(t){var e=this.items.findIndex((function(e){return e.id===t}));-1!==e&&this.items.splice(e,1)},onItemClick:function(t,e){var n=this;this.$meta.config.base.jwt?this.$api.post("/a/base/jwt/create").then((function(t){n._openUrl(e,t.jwt)})):this._openUrl(e,null)},_openUrl:function(t,e){e?window.open(this.$meta.util.combineQueries(t.downloadUrl,{"eb-jwt":e})):window.open(t.downloadUrl)},getItemMedia:function(t){var e=t.avatar||this.$meta.config.modules["a-base"].user.avatar.default;return this.$meta.util.combineImageUrl(e,32)}}},r=(0,n(792).Z)(a,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",{attrs:{ptr:"",infinite:"",infinitePreloader:!1},on:{"ptr:refresh":t.onRefresh,infinite:t.onInfinite}},[n("eb-navbar",{attrs:{large:"",largeTransparent:"",title:t.$text("Attachment List"),"eb-back-link":"Back"}},[n("f7-nav-right",[t.actionWrite?n("eb-link",{attrs:{iconMaterial:"add",onPerform:t.onPerformAdd}}):t._e()],1)],1),t._v(" "),n("f7-list",t._l(t.items,(function(e){return n("eb-list-item",{key:e.id,staticClass:"item",attrs:{title:e.realName,link:"#",context:e,onPerform:t.onItemClick,swipeout:e.userId===t.user.id}},[n("div",{attrs:{slot:"media"},slot:"media"},[n("img",{staticClass:"avatar avatar32",attrs:{src:t.getItemMedia(e)}})]),t._v(" "),n("div",{staticClass:"header",attrs:{slot:"root-start"},slot:"root-start"},[n("div",{staticClass:"userName"},[n("span",[t._v(t._s(e.userName))])]),t._v(" "),n("div",{staticClass:"date"},[t._v(t._s(t.$meta.util.formatDateTimeRelative(e.createdAt)))])]),t._v(" "),t.actionWrite?n("eb-context-menu",[n("div",{attrs:{slot:"right"},slot:"right"},[n("div",{attrs:{color:"orange",context:e,onPerform:t.onPerformDelete}},[t._v(t._s(t.$text("Delete")))])])]):t._e()],1)})),1),t._v(" "),n("eb-load-more",{ref:"loadMore",attrs:{onLoadClear:t.onLoadClear,onLoadMore:t.onLoadMore,autoInit:!0}})],1)}),[],!1,null,null,null).exports},15:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>a});const a=(0,n(792).Z)({data:function(){return{}}},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",[n("eb-navbar",{attrs:{large:"",largeTransparent:"",title:t.$text("About"),"eb-back-link":"Back"}}),t._v(" "),n("f7-toolbar",{attrs:{position:"bottom"}},[n("f7-link",{attrs:{external:"",target:"_blank",href:"https://cabloy.com"}},[t._v(t._s(t.$text("Documentation")))]),t._v(" "),n("f7-link",{attrs:{external:"",target:"_blank",href:"https://community.cabloy.com"}},[t._v(t._s(t.$text("Community")))]),t._v(" "),n("f7-link",{attrs:{external:"",target:"_blank",href:"https://github.com/zhennann/cabloy"}},[t._v("GitHub")])],1),t._v(" "),n("f7-block-title",[t._v(t._s(t.$text("Welcome to CabloyJS")))]),t._v(" "),n("f7-block",{attrs:{strong:""}},[n("div",{staticClass:"alert-info"},[t._v(t._s(t.$text("CabloyAboutTip1")))]),t._v(" "),n("p",[t._v(t._s(t.$text("CabloyAboutTip2")))]),t._v(" "),n("p",[t._v(t._s(t.$text("CabloyAboutTip3")))]),t._v(" "),n("p",[t._v(t._s(t.$text("CabloyAboutTip4")))])])],1)}),[],!1,null,"5c11ef88",null).exports},17:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r});const a={components:{},data:function(){return{data:JSON.parse(this.$f7route.query.data)}},computed:{pageTitle:function(){return this.$store.state.auth.instance.title}},methods:{}},r=(0,n(792).Z)(a,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",[n("eb-navbar",{attrs:{large:"",largeTransparent:"",title:t.pageTitle,"eb-back-link":"Back"}}),t._v(" "),n("f7-card",[n("f7-card-header",[t._v(t._s(t.data.title||t.$text("Friendly Tips")))]),t._v(" "),n("f7-card-content",[t._v("\n      "+t._s(t.data.message)+"\n    ")]),t._v(" "),t.data.link?n("f7-card-footer",[n("div"),t._v(" "),n("eb-link",{attrs:{"eb-href":t.data.link}},[t._v(t._s(t.data.linkText||t.$text("Link")))])],1):t._e()],1)],1)}),[],!1,null,"44172a93",null).exports},966:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>i});var a=n(5);function r(t,e,n,a,r,o,i){try{var s=t[o](i),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(a,r)}const o={mixins:[n.n(a)().prototype.$meta.module.get("a-components").options.mixins.ebPageContext],data:function(){var t=this.$f7route.query;return{atomClass:{module:t.module,atomClassName:t.atomClassName},language:t.language}},computed:{categoryIdStart:function(){return this.contextParams.categoryIdStart},multiple:function(){return this.contextParams.multiple},catalogOnly:function(){return this.contextParams.catalogOnly},leafOnly:function(){return this.contextParams.leafOnly},categoryIdDisable:function(){return this.contextParams.categoryIdDisable},root:function(){return{attrs:{itemToggle:!1,selectable:!1,multiple:this.multiple,checkbox:!0,checkOnLabel:!0}}}},methods:{onLoadChildren:function(t){var e,n=this;return(e=regeneratorRuntime.mark((function e(){var a,r,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.root||void 0!==n.categoryIdStart){e.next=3;break}return a=!n.leafOnly,e.abrupt("return",[{id:0,attrs:{label:n.$text("Root"),toggle:!0,loadChildren:!0,checkbox:a,checkOnLabel:a,selectable:a,itemToggle:!a},data:{id:0,categoryCatalog:1}}]);case 3:return r=t.root?n.categoryIdStart:t.id,e.next=6,n.$api.post("/a/base/category/children",{atomClass:n.atomClass,language:n.language,categoryId:r});case 6:return o=e.sent,i=(i=o.list.map((function(t){var e=!n.leafOnly||0===t.categoryCatalog;return{id:t.id,attrs:{label:t.categoryName||"[".concat(n.$text("New Category"),"]"),toggle:1===t.categoryCatalog,loadChildren:1===t.categoryCatalog,checkbox:e,checkOnLabel:e,selectable:e,itemToggle:!e},data:t}}))).filter((function(t){return!(n.catalogOnly&&1!==t.data.categoryCatalog||n.categoryIdDisable&&n.categoryIdDisable===t.id)})),e.abrupt("return",i);case 10:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(a,o){var i=e.apply(t,n);function s(t){r(i,a,o,s,l,"next",t)}function l(t){r(i,a,o,s,l,"throw",t)}s(void 0)}))})()},onPerformDone:function(){var t,e=this.$refs.tree.checked();t=e&&0!==e.length?e:null,this.contextCallback(200,t),this.$f7router.back()}}},i=(0,n(792).Z)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",[n("eb-navbar",{attrs:{large:"",largeTransparent:"",title:t.$text("Select Category"),"eb-back-link":"Back"}},[n("f7-nav-right",[n("eb-link",{attrs:{iconMaterial:"done",onPerform:t.onPerformDone}})],1)],1),t._v(" "),n("eb-treeview",{ref:"tree",attrs:{root:t.root,onLoadChildren:t.onLoadChildren}})],1)}),[],!1,null,null,null).exports},547:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>o});var a=n(5);const r={mixins:[n.n(a)().prototype.$meta.module.get("a-base").options.mixins.ebAtomActions],data:function(){var t=this.$f7route.query,e=t&&t.module,n=t&&t.atomClassName,a=e&&n?{module:e,atomClassName:n}:null,r=t&&t.where?JSON.parse(t.where):null;if("mine"===(t&&t.scene)){r||(r={});var o=this.$store.state.auth.user.op;r["h.userId"]=o.id}return{atomClass:a,where:r,order:"desc",items:[],moduleStyle:null,rightDeleteComment:!1}},computed:{user:function(){return this.$store.state.auth.user.op}},created:function(){var t=this;this.$api.post("/a/base/resource/check",{atomStaticKeys:["a-base:deleteComment"]}).then((function(e){t.rightDeleteComment=e[0].passed,t.$meta.module.use(t.$meta.config.markdown.style.module,(function(e){t.moduleStyle=e}))}))},mounted:function(){this.$meta.eventHub.$on("comment:action",this.onCommentChanged)},beforeDestroy:function(){this.$meta.eventHub.$off("comment:action",this.onCommentChanged)},methods:{onRefresh:function(t){t(),this.reload()},onInfinite:function(){this.$refs.loadMore.loadMore()},onLoadClear:function(t){this.items=[],t()},onLoadMore:function(t){var e=this,n=t.index,a={orders:[["h_updatedAt",this.order]],page:{index:n}};return this.where&&(a.where=this.where),this.$api.post("/a/base/comment/all",{atomClass:this.atomClass,options:a}).then((function(t){return e.items=e.items.concat(t.list),t}))},reload:function(){this.$refs.loadMore.reload()},onPerformDelete:function(t,e){var n=this;return this.$view.dialog.confirm().then((function(){return n.$api.post("/a/base/comment/delete",{key:{atomId:e.atomId},data:{commentId:e.h_id}}).then((function(t){return n.$meta.eventHub.$emit("comment:action",t),!0}))}))},onPerformHeart:function(t,e){var n=this;if(!this.user.anonymous)return this.$api.post("/a/base/comment/heart",{key:{atomId:e.atomId},data:{commentId:e.h_id,heart:e.h_heart?0:1}}).then((function(t){n.$meta.eventHub.$emit("comment:action",t)}));this.$view.dialog.confirm(this.$text("Please Sign In")).then((function(){n.$meta.vueLayout.openLogin()}))},onCommentChanged:function(t){var e=this,n=t.action,a=t.atomId,r=t.commentId;if("create"!==n){var o=this.items.findIndex((function(t){return t.h_id===r}));"delete"!==n?-1!==o&&this.$api.post("/a/base/comment/item",{key:{atomId:a},data:{commentId:r}}).then((function(t){for(var n=e.items[o],a=0,r=Object.keys(t);a<r.length;a++){var i=r[a];n["h_".concat(i)]=t[i]}})):-1!==o&&this.items.splice(o,1)}else this.reload()},onPerformSort:function(){this.order="desc"===this.order?"asc":"desc",this.reload()},onPerformViewAtom:function(t,e){var n=this.getAction({module:e.module,atomClassName:e.atomClassName,name:"read"});if(n)return this.$meta.util.performAction({ctx:this,action:n,item:e})},getItemMedia:function(t){var e=t.h_avatar||this.$meta.config.modules["a-base"].user.avatar.default;return this.$meta.util.combineImageUrl(e,32)}}},o=(0,n(792).Z)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",{attrs:{ptr:"",infinite:"",infinitePreloader:!1},on:{"ptr:refresh":t.onRefresh,infinite:t.onInfinite}},[n("eb-navbar",{attrs:{large:"",largeTransparent:"",title:t.$text("Comment List"),"eb-back-link":"Back"}},[n("f7-nav-right",[n("eb-link",{attrs:{iconMaterial:"desc"===t.order?"arrow_downward":"arrow_upward",onPerform:t.onPerformSort}})],1)],1),t._v(" "),t.moduleStyle?t._l(t.items,(function(e){return n("f7-card",{key:e.h_id,staticClass:"comment"},[n("f7-card-header",[n("div",{staticClass:"header-container"},[n("div",{staticClass:"header-atom"},[n("eb-link",{attrs:{context:e,onPerform:t.onPerformViewAtom}},[t._v(t._s(e.atomName))])],1),t._v(" "),n("div",{staticClass:"header-comment"},[n("div",{staticClass:"title"},[n("img",{staticClass:"avatar avatar32",attrs:{src:t.getItemMedia(e)}}),t._v(" "),n("div",{staticClass:"name"},[t._v(t._s(e.h_userName))]),t._v(" "),n("div",{staticClass:"date"},[t._v("#"+t._s(e.h_sorting)+" · "+t._s(t.$meta.util.formatDateTimeRelative(e.h_createdAt)))])]),t._v(" "),n("div",{staticClass:"actions"},[e.h_userId===t.user.id?n("eb-link",{staticClass:"action",attrs:{iconMaterial:"edit","eb-href":"/a/basefront/comment/item?atomId="+e.atomId+"&commentId="+e.h_id+"&replyId=0"}}):t._e(),t._v(" "),e.h_userId===t.user.id||t.rightDeleteComment?n("eb-link",{staticClass:"action",attrs:{iconMaterial:"delete_forever",context:e,onPerform:t.onPerformDelete}}):t._e(),t._v(" "),n("eb-link",{staticClass:"action",attrs:{iconMaterial:e.h_heart?"favorite":"favorite_border",context:e,onPerform:t.onPerformHeart}},[t._v(t._s(e.h_heartCount))]),t._v(" "),t.user.anonymous?t._e():n("eb-link",{staticClass:"action",attrs:{iconMaterial:"reply","eb-href":"/a/basefront/comment/item?atomId="+e.atomId+"&commentId=0&replyId="+e.h_id}})],1)])])]),t._v(" "),n("f7-card-content",{staticClass:"markdown-body",attrs:{padding:""},domProps:{innerHTML:t._s(e.h_html)}})],1)})):t._e(),t._v(" "),n("eb-load-more",{ref:"loadMore",attrs:{onLoadClear:t.onLoadClear,onLoadMore:t.onLoadMore,autoInit:!0}})],2)}),[],!1,null,null,null).exports},201:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r});const a={data:function(){return{atomId:this.$f7route.query.atomId,commentId:this.$f7route.query.commentId}},created:function(){var t=this;this.$api.post("/a/base/comment/heart",{key:{atomId:this.atomId},atom:{star:1},data:{commentId:this.commentId,heart:1}}).then((function(){t.$view.dialog.alert(t.$text("Hearted")).then((function(){t.openAtom()}))}))},methods:{openAtom:function(){location.assign(this.$f7route.query.returnTo)}}},r=(0,n(792).Z)(a,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",[n("eb-navbar",{attrs:{large:"",largeTransparent:"",title:t.$text("HeartForAtom"),"eb-back-link":"Back"}}),t._v(" "),n("f7-block")],1)}),[],!1,null,null,null).exports},200:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r});const a={meta:{size:"medium"},data:function(){return{atomId:parseInt(this.$f7route.query.atomId),commentId:parseInt(this.$f7route.query.commentId||0),replyId:parseInt(this.$f7route.query.replyId||0),module:null,comment:null,reply:null,content:""}},computed:{ready:function(){return this.module&&(0===this.commentId||this.comment)&&(0===this.replyId||this.reply)},readOnly:function(){return!1},editable:function(){return!this.readOnly},language:function(){return"zh-cn"===this.$meta.util.getLocale()?"zh-CN":"en"},subfield:function(){return this.editable&&"small"!==this.$view.size},defaultOpen:function(){return this.editable?"":"preview"},toolbarsFlag:function(){return this.editable},navigation:function(){return!this.editable},toolbars:function(){return{bold:!0,italic:!0,underline:!0,strikethrough:!0,mark:!0,superscript:!0,subscript:!0,ol:!0,ul:!0,link:!0,imagelink:!0,code:!0,table:!0,undo:!0,redo:!0,trash:!0,alignleft:!0,aligncenter:!0,alignright:!0,subfield:!0}}},created:function(){var t=this;this.$meta.module.use("a-mavoneditor",(function(e){t.module=e})),this.loadComment(this.commentId),this.loadReply(this.replyId)},methods:{loadComment:function(t){var e=this;t&&this.$api.post("/a/base/comment/item",{key:{atomId:this.atomId},data:{commentId:t}}).then((function(t){e.comment=t,e.content=e.comment.content}))},loadReply:function(t){var e=this;t&&this.$api.post("/a/base/comment/item",{key:{atomId:this.atomId},data:{commentId:t}}).then((function(t){e.reply=t}))},onChange:function(t){this.content=t},onSave:function(){this.onPerformSave()},onPerformSave:function(){var t=this;if(this.content)return this.$api.post("/a/base/comment/save",{key:{atomId:this.atomId},data:{commentId:this.commentId,replyId:this.replyId,content:this.content}}).then((function(e){t.$meta.eventHub.$emit("comment:action",e);var n=t.$f7route.query.returnTo;n?location.assign(n):t.$f7router.back()}))},onImageUpload:function(){var t=this;return new Promise((function(e,n){t.$view.navigate("/a/file/file/upload",{context:{params:{mode:1,atomId:t.atomId,flag:"comment"},callback:function(t,a){200===t&&e({text:a.realName,addr:a.downloadUrl}),!1===t&&n()}}})}))},onPreRender:function(t){if(this.comment)return this.fullContent({content:t,replyContent:this.comment.replyContent,replyUserName:this.comment.replyUserName});if(this.reply){var e=this.fullContent({content:this.reply.content,replyContent:this.reply.replyContent,replyUserName:this.reply.replyUserName});return this.fullContent({content:t,replyContent:e,replyUserName:this.reply.userName})}return t},fullContent:function(t){var e=t.content,n=t.replyContent,a=t.replyUserName;return n?"".concat(e,"\n\n> `").concat(a,"`:\n\n::: comment-quot\n").concat(n,"\n:::\n\n"):e}}},r=(0,n(792).Z)(a,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",[n("eb-navbar",{attrs:{title:t.$text("Comment"),"eb-back-link":"Back"}},[n("f7-nav-right",[n("eb-link",{attrs:{iconMaterial:"save",onPerform:t.onPerformSave}})],1)],1),t._v(" "),t.ready?[n("eb-box",[n("mavon-editor",{ref:"editor",attrs:{value:t.content,onPreRender:t.onPreRender,onImageUpload:t.onImageUpload,language:t.language,subfield:t.subfield,editable:t.editable,defaultOpen:t.defaultOpen,toolbarsFlag:t.toolbarsFlag,navigation:t.navigation,toolbars:t.toolbars},on:{change:t.onChange,save:t.onSave}})],1)]:t._e()],2)}),[],!1,null,null,null).exports},229:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>i});var a=n(5),r=n.n(a);const o={data:function(){return{atomId:parseInt(this.$f7route.query.atomId),order:"desc",items:[],moduleStyle:null}},computed:{user:function(){return this.$store.state.auth.user.op}},created:function(){var t=this;this.$meta.module.use(this.$meta.config.markdown.style.module,(function(e){t.moduleStyle=e}))},mounted:function(){this.$meta.eventHub.$on("comment:action",this.onCommentChanged)},beforeDestroy:function(){this.$meta.eventHub.$off("comment:action",this.onCommentChanged)},methods:{onRefresh:function(t){t(),this.reload()},onInfinite:function(){this.$refs.loadMore.loadMore()},onLoadClear:function(t){this.items=[],t()},onLoadMore:function(t){var e=this,n=t.index,a={orders:[["updatedAt",this.order]],page:{index:n}};return this.$api.post("/a/base/comment/list",{key:{atomId:this.atomId},options:a}).then((function(t){return e.items=e.items.concat(t.list),t}))},reload:function(){this.$refs.loadMore.reload()},onPerformDelete:function(t,e){var n=this;return this.$view.dialog.confirm().then((function(){return n.$api.post("/a/base/comment/delete",{key:{atomId:n.atomId},data:{commentId:e.id}}).then((function(t){return n.$meta.eventHub.$emit("comment:action",t),!0}))}))},onPerformHeart:function(t,e){var n=this;if(!this.user.anonymous)return this.$api.post("/a/base/comment/heart",{key:{atomId:this.atomId},data:{commentId:e.id,heart:e.heart?0:1}}).then((function(t){n.$meta.eventHub.$emit("comment:action",t)}));this.$view.dialog.confirm(this.$text("Please Sign In")).then((function(){n.$meta.vueLayout.openLogin()}))},onCommentChanged:function(t){var e=this,n=t.action,a=t.atomId,o=t.commentId;if(a===this.atomId)if("create"!==n){var i=this.items.findIndex((function(t){return t.id===o}));"delete"!==n?-1!==i&&this.$api.post("/a/base/comment/item",{key:{atomId:this.atomId},data:{commentId:o}}).then((function(t){r().set(e.items,i,t)})):-1!==i&&this.items.splice(i,1)}else this.reload()},onPerformSort:function(){this.order="desc"===this.order?"asc":"desc",this.reload()},getItemMedia:function(t){var e=t.avatar||this.$meta.config.modules["a-base"].user.avatar.default;return this.$meta.util.combineImageUrl(e,32)}}},i=(0,n(792).Z)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",{attrs:{ptr:"",infinite:"",infinitePreloader:!1},on:{"ptr:refresh":t.onRefresh,infinite:t.onInfinite}},[n("eb-navbar",{attrs:{large:"",largeTransparent:"",title:t.$text("Comment List"),"eb-back-link":"Back"}},[n("f7-nav-right",[t.user.anonymous?t._e():n("eb-link",{attrs:{iconMaterial:"add","eb-href":"/a/basefront/comment/item?atomId="+t.atomId+"&commentId=0&replyId=0"}}),t._v(" "),n("eb-link",{attrs:{iconMaterial:"desc"===t.order?"arrow_downward":"arrow_upward",onPerform:t.onPerformSort}})],1)],1),t._v(" "),t.moduleStyle?t._l(t.items,(function(e){return n("f7-card",{key:e.id,staticClass:"comment"},[n("f7-card-header",[n("div",{staticClass:"title"},[n("img",{staticClass:"avatar avatar32",attrs:{src:t.getItemMedia(e)}}),t._v(" "),n("div",{staticClass:"name"},[t._v(t._s(e.userName))]),t._v(" "),n("div",{staticClass:"date"},[t._v("#"+t._s(e.sorting)+" · "+t._s(t.$meta.util.formatDateTimeRelative(e.createdAt)))])]),t._v(" "),n("div",{staticClass:"actions"},[e.userId===t.user.id?n("eb-link",{staticClass:"action",attrs:{iconMaterial:"edit","eb-href":"/a/basefront/comment/item?atomId="+t.atomId+"&commentId="+e.id+"&replyId=0"}}):t._e(),t._v(" "),e.userId===t.user.id?n("eb-link",{staticClass:"action",attrs:{iconMaterial:"delete_forever",context:e,onPerform:t.onPerformDelete}}):t._e(),t._v(" "),n("eb-link",{staticClass:"action",attrs:{iconMaterial:e.heart?"favorite":"favorite_border",context:e,onPerform:t.onPerformHeart}},[t._v(t._s(e.heartCount))]),t._v(" "),t.user.anonymous?t._e():n("eb-link",{staticClass:"action",attrs:{iconMaterial:"reply","eb-href":"/a/basefront/comment/item?atomId="+t.atomId+"&commentId=0&replyId="+e.id}})],1)]),t._v(" "),n("f7-card-content",{staticClass:"markdown-body",attrs:{padding:""},domProps:{innerHTML:t._s(e.html)}})],1)})):t._e(),t._v(" "),n("eb-load-more",{ref:"loadMore",attrs:{onLoadClear:t.onLoadClear,onLoadMore:t.onLoadMore,autoInit:!0}})],2)}),[],!1,null,null,null).exports},932:(t,e,n)=>{"use strict";function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function r(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){o(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t,e,n,a,r,o,i){try{var s=t[o](i),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(a,r)}function s(t){return function(){var e=this,n=arguments;return new Promise((function(a,r){var o=t.apply(e,n);function s(t){i(o,a,r,s,l,"next",t)}function l(t){i(o,a,r,s,l,"throw",t)}s(void 0)}))}}n.r(e),n.d(e,{default:()=>c});const l={data:function(){var t=this.$f7route.query;return{atomId:parseInt(t.atomId),items:null}},created:function(){this.reload()},methods:{combineAtomClassAndLanguage:function(){var t={module:this.atomClass.module,atomClassName:this.atomClass.atomClassName};return this.language&&(t.language=this.language),t},onRefresh:function(t){t(),this.reload()},reload:function(){var t=this;this.$api.post("/a/base/resource/resourceRoles",{key:{atomId:this.atomId}}).then((function(e){t.items=e.list}))},onPerformAdd:function(){var t=this;return s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.$view.navigate("/a/baseadmin/role/select",{target:"_self",context:{params:{roleIdStart:null,multiple:!0,resourceAtomId:t.atomId},callback:function(e,n){200===e&&t._resourceRoleAdd(n)}}});case 1:case"end":return e.stop()}}),e)})))()},_resourceRoleAdd:function(t){var e=this;return s(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t&&0!==t.length){n.next=2;break}return n.abrupt("return");case 2:return a=t.map((function(t){return t.id})),n.next=5,e.$api.post("/a/base/resource/resourceRoleAdd",{key:{atomId:e.atomId},data:{roles:a}});case 5:e.reload();case 6:case"end":return n.stop()}}),n)})))()},onItemClick:function(t,e){var n=this;return s(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,n.onPerformEdit(t,e);case 2:case"end":return a.stop()}}),a)})))()},onPerformEdit:function(t,e){var n=this;return s(regeneratorRuntime.mark((function t(){var a,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.$view.dialog.prompt(n.$text("Please specify the new tag name"));case 2:if(a=t.sent){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,n.$api.post("/a/base/tag/save",{tagId:e.id,data:{tagName:a}});case 7:-1!==(o=n.items.findIndex((function(t){return t.id===e.id})))&&n.items.splice(o,1,r(r({},e),{},{tagName:a}));case 9:case"end":return t.stop()}}),t)})))()},onPerformRemove:function(t,e){var n=this;return s(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,n.$view.dialog.confirm();case 2:return a.next=4,n.$api.post("/a/base/resource/resourceRoleRemove",{key:{atomId:n.atomId},data:{resourceRoleId:e.id}});case 4:n.$meta.util.swipeoutClose(t.target),-1!==(r=n.items.findIndex((function(t){return t.id===e.id})))&&n.items.splice(r,1);case 7:case"end":return a.stop()}}),a)})))()}}},c=(0,n(792).Z)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",{attrs:{ptr:""},on:{"ptr:refresh":t.onRefresh}},[n("eb-navbar",{attrs:{large:"",largeTransparent:"",title:t.$text("Authorize"),"eb-back-link":"Back"}},[n("f7-nav-right",[n("eb-link",{attrs:{iconMaterial:"add",onPerform:t.onPerformAdd}})],1)],1),t._v(" "),n("f7-list",t._l(t.items,(function(e){return n("eb-list-item",{key:e.id,staticClass:"item",attrs:{title:e.roleName,swipeout:""}},[n("eb-context-menu",[n("div",{attrs:{slot:"right"},slot:"right"},[n("div",{attrs:{color:"red",context:e,onPerform:t.onPerformRemove}},[t._v(t._s(t.$text("Remove")))])])])],1)})),1),t._v(" "),t.items&&0===t.items.length?n("div",{staticClass:"text-align-center"},[t._v(t._s(t.$text("No Data")))]):t._e()],1)}),[],!1,null,"57f4c747",null).exports},454:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>d});var a=n(5);function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var a=0,r=function(){};return{s:r,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return i=t.done,t},e:function(t){s=!0,o=t},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function c(t,e,n,a,r,o,i){try{var s=t[o](i),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(a,r)}function u(t){return function(){var e=this,n=arguments;return new Promise((function(a,r){var o=t.apply(e,n);function i(t){c(o,a,r,i,s,"next",t)}function s(t){c(o,a,r,i,s,"throw",t)}i(void 0)}))}}const m={mixins:[n.n(a)().prototype.$meta.module.get("a-components").options.mixins.ebPageContext],data:function(){var t=this.$f7route.query;return{maxLevelAutoOpened:parseInt(t.maxLevelAutoOpened||1),resourceType:t.resourceType,treeData:null,resourcesArrayAll:null}},computed:{ready:function(){return this.treeData&&this.resourcesArrayAll},pageTitle:function(){var t=this.$store.getState("a/base/resourceTypes");return t?"".concat(this.$text("Select")," ").concat(t[this.resourceType].titleLocale):null},multiple:function(){return this.contextParams.multiple},checkedAtomStaticKeys:function(){return this.contextParams.checkedAtomStaticKeys},root:function(){return{attrs:{itemToggle:!1,selectable:!1,multiple:this.multiple}}}},created:function(){this.__init()},methods:{__init:function(){var t=this;return u(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.$store.dispatch("a/base/getResourceTypes"),e.next=3,t.$store.dispatch("a/base/getResourcesArray",{resourceType:t.resourceType});case 3:return t.resourcesArrayAll=e.sent,e.next=6,t.$store.dispatch("a/base/getResourceTrees",{resourceType:t.resourceType});case 6:t.treeData=e.sent;case 7:case"end":return e.stop()}}),e)})))()},combineAtomClassAndLanguage:function(){var t={module:this.atomClass.module,atomClassName:this.atomClass.atomClassName};return this.language&&(t.language=this.language),t},_loadNodeCategories:function(t){var e=this;return u(regeneratorRuntime.mark((function n(){var a,r,i,l,c,u,m,d,h,f;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:a=t.data&&t.data.__level||0,r=a+1,i=t.root?e.treeData:t.data.children,l=[],c=s(i),n.prev=5,c.s();case 7:if((u=c.n()).done){n.next=21;break}if(m=u.value,d=!1,h={id:m.id,attrs:{label:m.categoryNameLocale,toggle:!0,itemToggle:!0,loadChildren:!0,checkbox:d,checkOnLabel:d,selectable:d},data:o(o({},m),{},{__level:r})},!(r<=e.maxLevelAutoOpened||-1===e.maxLevelAutoOpened)){n.next=18;break}return n.next=14,e.onLoadChildren(h);case 14:f=n.sent,e.$refs.tree.childrenLoaded(h,f),h.attrs.loadChildren=!1,h.attrs.opened=!0;case 18:l.push(h);case 19:n.next=7;break;case 21:n.next=26;break;case 23:n.prev=23,n.t0=n.catch(5),c.e(n.t0);case 26:return n.prev=26,c.f(),n.finish(26);case 29:return n.abrupt("return",l);case 30:case"end":return n.stop()}}),n,null,[[5,23,26,29]])})))()},_checkCheckedInit:function(t){return!!this.checkedAtomStaticKeys&&this.checkedAtomStaticKeys.findIndex((function(e){return e===t.atomStaticKey}))>-1},_loadNodeResources:function(t){var e=this;return u(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=e.resourcesArrayAll.filter((function(e){return e.atomCategoryId===t.id})),n.abrupt("return",a.map((function(t){var n=!0,a=e._checkCheckedInit(t);return{id:t.atomId,attrs:{label:t.atomNameLocale,toggle:!1,loadChildren:!1,checkbox:n,checked:a,checkOnLabel:n,selectable:n,itemToggle:!1},data:t}})));case 2:case"end":return n.stop()}}),n)})))()},onLoadChildren:function(t){var e=this;return u(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.root&&1!==t.data.categoryCatalog){n.next=4;break}return n.next=3,e._loadNodeCategories(t);case 3:return n.abrupt("return",n.sent);case 4:return n.next=6,e._loadNodeResources(t);case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}}),n)})))()},onPerformDone:function(){var t,e=this.$refs.tree.checked();t=e&&0!==e.length?e:null,this.contextCallback(200,t),this.$f7router.back()}}},d=(0,n(792).Z)(m,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",[n("eb-navbar",{attrs:{large:"",largeTransparent:"",title:t.pageTitle,"eb-back-link":"Back"}},[n("f7-nav-right",[n("eb-link",{attrs:{iconMaterial:"done",onPerform:t.onPerformDone}})],1)],1),t._v(" "),t.ready?n("eb-treeview",{ref:"tree",attrs:{root:t.root,onLoadChildren:t.onLoadChildren}}):t._e(),t._v(" "),n("f7-block")],1)}),[],!1,null,"cbbe8886",null).exports},885:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>d});var a=n(5);function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var a=0,r=function(){};return{s:r,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return i=t.done,t},e:function(t){s=!0,o=t},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function c(t,e,n,a,r,o,i){try{var s=t[o](i),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(a,r)}function u(t){return function(){var e=this,n=arguments;return new Promise((function(a,r){var o=t.apply(e,n);function i(t){c(o,a,r,i,s,"next",t)}function s(t){c(o,a,r,i,s,"throw",t)}i(void 0)}))}}const m={mixins:[n.n(a)().prototype.$meta.module.get("a-base").options.mixins.ebAtomActions],data:function(){var t=this.$f7route.query,e=parseInt(t.maxLevelAutoOpened||1),n=t.resourceType,a=!1;return n||(n="a-base:menu",a=!0),{maxLevelAutoOpened:e,resourceType:n,home:a,treeData:null,resourcesArrayAll:null,root:{attrs:{itemToggle:!1,selectable:!0}}}},computed:{ready:function(){return this.treeData&&this.resourcesArrayAll&&this.actionsAll},pageTitle:function(){if(this.home)return this.$view.inPanel()?this.$text("Menu"):this.$text("Home");var t=this.$store.getState("a/base/resourceTypes");return t?t[this.resourceType].titleLocale:null}},created:function(){this.__init()},methods:{__init:function(){var t=this;return u(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.$store.dispatch("a/base/getResourceTypes"),e.next=3,t.$store.dispatch("a/base/getResourcesArray",{resourceType:t.resourceType});case 3:return t.resourcesArrayAll=e.sent,e.next=6,t.$store.dispatch("a/base/getResourceTrees",{resourceType:t.resourceType});case 6:t.treeData=e.sent;case 7:case"end":return e.stop()}}),e)})))()},combineAtomClassAndLanguage:function(){var t={module:this.atomClass.module,atomClassName:this.atomClass.atomClassName};return this.language&&(t.language=this.language),t},_loadNodeCategories:function(t){var e=this;return u(regeneratorRuntime.mark((function n(){var a,r,i,l,c,u,m,d,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:a=t.data&&t.data.__level||0,r=a+1,i=t.root?e.treeData:t.data.children,l=[],c=s(i),n.prev=5,c.s();case 7:if((u=c.n()).done){n.next=20;break}if(m=u.value,d={id:m.id,attrs:{label:m.categoryNameLocale,toggle:!0,itemToggle:!0,loadChildren:!0},data:o(o({},m),{},{__level:r})},!(r<=e.maxLevelAutoOpened||-1===e.maxLevelAutoOpened)){n.next=17;break}return n.next=13,e.onLoadChildren(d);case 13:h=n.sent,e.$refs.tree.childrenLoaded(d,h),d.attrs.loadChildren=!1,d.attrs.opened=!0;case 17:l.push(d);case 18:n.next=7;break;case 20:n.next=25;break;case 22:n.prev=22,n.t0=n.catch(5),c.e(n.t0);case 25:return n.prev=25,c.f(),n.finish(25);case 28:return n.abrupt("return",l);case 29:case"end":return n.stop()}}),n,null,[[5,22,25,28]])})))()},_loadNodeResources:function(t){var e=this;return u(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=e.resourcesArrayAll.filter((function(e){return e.atomCategoryId===t.id})),n.abrupt("return",a.map((function(t){return{id:t.atomId,attrs:{link:"#",label:t.atomNameLocale,toggle:!1,loadChildren:!1},data:t}})));case 2:case"end":return n.stop()}}),n)})))()},onLoadChildren:function(t){var e=this;return u(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.root&&1!==t.data.categoryCatalog){n.next=4;break}return n.next=3,e._loadNodeCategories(t);case 3:return n.abrupt("return",n.sent);case 4:return n.next=6,e._loadNodeResources(t);case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}}),n)})))()},onNodeClick:function(t,e){var n,a,r=JSON.parse(e.data.resourceConfig);return"create"===r.atomAction?(n=this.getAction({module:r.module,atomClassName:r.atomClassName,name:r.atomAction}),a={module:r.module,atomClassName:r.atomClassName}):"read"===r.atomAction?(r.actionComponent||r.actionPath||(r.actionPath="/a/basefront/atom/list?module={{module}}&atomClassName={{atomClassName}}"),n=r,a={module:r.module,atomClassName:r.atomClassName}):n=r,n=this.$utils.extend({},n,{targetEl:t.target}),this.$meta.util.performAction({ctx:this,action:n,item:a})}}},d=(0,n(792).Z)(m,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",[n("eb-navbar",{attrs:{title:t.pageTitle,"eb-back-link":"Back"}}),t._v(" "),t.ready?n("eb-treeview",{ref:"tree",attrs:{root:t.root,onLoadChildren:t.onLoadChildren},on:{"node:click":t.onNodeClick}}):t._e(),t._v(" "),n("f7-block")],1)}),[],!1,null,"0df43e18",null).exports},416:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>i});var a=n(5),r=n.n(a);const o={mixins:[r().prototype.$meta.module.get("a-components").options.mixins.ebPageContext],data:function(){var t=this.$f7route.query;return{atomClass:{module:t.module,atomClassName:t.atomClassName},language:t.language,tagsCurrent:[],tagsAll:null,searchQuery:null}},computed:{tags:function(){return this.contextParams.tags},multiple:function(){return!1!==this.contextParams.multiple},tagsAll2:function(){var t=this;return this.tagsAll&&this.searchQuery?this.tagsAll.filter((function(e){return e.tagName.toLowerCase().indexOf(t.searchQuery.toLowerCase())>-1})):this.tagsAll}},created:function(){var t=this;this.initTagsCurrent();var e={where:{language:this.language},orders:[["tagName","asc"]]};this.$api.post("/a/base/tag/list",{atomClass:this.atomClass,options:e}).then((function(e){t.tagsAll=e.list}))},methods:{initTagsCurrent:function(){this.tags?Array.isArray(this.tags)?this.tagsCurrent=this.tags.concat():this.tagsCurrent=JSON.parse(this.tags):this.tagsCurrent=[]},getTagName:function(t){var e=this.getTagBase(t);return e?e.tagName:null},getTagBase:function(t){return this.tagsAll?this.tagsAll.find((function(e){return e.id===t})):null},tagIndex:function(t){return this.tagsCurrent.findIndex((function(e){return e===t}))},onTagRemove:function(t){var e=this.tagIndex(t);e>-1&&this.tagsCurrent.splice(e,1)},onTagSwitch:function(t){if(this.multiple){var e=this.tagIndex(t.id);e>-1?this.tagsCurrent.splice(e,1):this.tagsCurrent.push(t.id)}else this.tagsCurrent=[t.id]},onPerformDone:function(){var t;t=this.multiple?this.tagsCurrent.length>0?this.tagsCurrent:null:this.tagsCurrent.length>0?this.tagsCurrent[0]:0,this.contextCallback(200,t),this.$f7router.back()},onPerformSearch:function(){this.$refs.searchbar.f7Searchbar.enable()},onSearch:r().prototype.$meta.util.debounce((function(t,e){this.searchQuery=e}),200),onDisable:function(){this.searchQuery=null}}};n(493);const i=(0,n(792).Z)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eb-page",[n("eb-navbar",{attrs:{large:"",largeTransparent:"",title:t.$text("Select Tags"),"eb-back-link":"Back"}},[n("f7-nav-right",[n("eb-link",{attrs:{iconMaterial:"search",onPerform:t.onPerformSearch}}),t._v(" "),n("eb-link",{ref:"buttonSubmit",attrs:{iconMaterial:"done",onPerform:t.onPerformDone}})],1),t._v(" "),n("f7-searchbar",{ref:"searchbar",attrs:{expandable:"",backdrop:!1,"disable-button":!0,"clear-button":!0,"custom-search":!0},on:{"searchbar:search":t.onSearch,"searchbar:disable":t.onDisable}})],1),t._v(" "),n("f7-block-title",[t._v(t._s(t.$text("Selected Tags")))]),t._v(" "),t.tagsAll?n("f7-block",{staticClass:"selected-tags"},t._l(t.tagsCurrent,(function(e){return n("f7-chip",{key:e,attrs:{text:t.getTagName(e),deleteable:""},on:{click:function(n){return t.onTagRemove(e)}}})})),1):t._e(),t._v(" "),n("f7-block",[n("div",{staticClass:"row tags"},[t._l(t.tagsAll2,(function(e){return n("div",{key:e.id,class:{chip:!0,"col-33":!0,"chip-outline":-1===t.tagIndex(e.id)},on:{click:function(n){return t.onTagSwitch(e)}}},[n("div",{staticClass:"chip-media"},[t._v(t._s(e.tagAtomCount))]),t._v(" "),n("div",{staticClass:"chip-label"},[t._v(t._s(e.tagName))])])})),t._v(" "),n("div",{staticClass:"col-33"}),t._v(" "),n("div",{staticClass:"col-33"})],2)])],1)}),[],!1,null,"7d6e9423",null).exports},792:(t,e,n)=>{"use strict";function a(t,e,n,a,r,o,i,s){var l,c="function"==typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=n,c._compiled=!0),a&&(c.functional=!0),o&&(c._scopeId="data-v-"+o),i?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),r&&r.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(i)},c._ssrRegister=l):r&&(l=s?function(){r.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:r),l)if(c.functional){c._injectStyles=l;var u=c.render;c.render=function(t,e){return l.call(e),u(t,e)}}else{var m=c.beforeCreate;c.beforeCreate=m?[].concat(m,l):[l]}return{exports:t,options:c}}n.d(e,{Z:()=>a})},824:(t,e,n)=>{var a=n(891);"string"==typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals),(0,n(159).Z)("6cc44cc8",a,!0,{})},493:(t,e,n)=>{var a=n(706);"string"==typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals),(0,n(159).Z)("0fd99e36",a,!0,{})},594:(t,e,n)=>{var a=n(705);"string"==typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals),(0,n(159).Z)("f69ab966",a,!0,{})},159:(t,e,n)=>{"use strict";function a(t,e){for(var n=[],a={},r=0;r<e.length;r++){var o=e[r],i=o[0],s={id:t+":"+r,css:o[1],media:o[2],sourceMap:o[3]};a[i]?a[i].parts.push(s):n.push(a[i]={id:i,parts:[s]})}return n}n.d(e,{Z:()=>f});var r="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!r)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var o={},i=r&&(document.head||document.getElementsByTagName("head")[0]),s=null,l=0,c=!1,u=function(){},m=null,d="data-vue-ssr-id",h="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function f(t,e,n,r){c=n,m=r||{};var i=a(t,e);return p(i),function(e){for(var n=[],r=0;r<i.length;r++){var s=i[r];(l=o[s.id]).refs--,n.push(l)}for(e?p(i=a(t,e)):i=[],r=0;r<n.length;r++){var l;if(0===(l=n[r]).refs){for(var c=0;c<l.parts.length;c++)l.parts[c]();delete o[l.id]}}}}function p(t){for(var e=0;e<t.length;e++){var n=t[e],a=o[n.id];if(a){a.refs++;for(var r=0;r<a.parts.length;r++)a.parts[r](n.parts[r]);for(;r<n.parts.length;r++)a.parts.push(g(n.parts[r]));a.parts.length>n.parts.length&&(a.parts.length=n.parts.length)}else{var i=[];for(r=0;r<n.parts.length;r++)i.push(g(n.parts[r]));o[n.id]={id:n.id,refs:1,parts:i}}}}function b(){var t=document.createElement("style");return t.type="text/css",i.appendChild(t),t}function g(t){var e,n,a=document.querySelector("style["+d+'~="'+t.id+'"]');if(a){if(c)return u;a.parentNode.removeChild(a)}if(h){var r=l++;a=s||(s=b()),e=C.bind(null,a,r,!1),n=C.bind(null,a,r,!0)}else a=b(),e=_.bind(null,a),n=function(){a.parentNode.removeChild(a)};return e(t),function(a){if(a){if(a.css===t.css&&a.media===t.media&&a.sourceMap===t.sourceMap)return;e(t=a)}else n()}}var v,y=(v=[],function(t,e){return v[t]=e,v.filter(Boolean).join("\n")});function C(t,e,n,a){var r=n?"":a.css;if(t.styleSheet)t.styleSheet.cssText=y(e,r);else{var o=document.createTextNode(r),i=t.childNodes;i[e]&&t.removeChild(i[e]),i.length?t.insertBefore(o,i[e]):t.appendChild(o)}}function _(t,e){var n=e.css,a=e.media,r=e.sourceMap;if(a&&t.setAttribute("media",a),m.ssrId&&t.setAttribute(d,e.id),r&&(n+="\n/*# sourceURL="+r.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */"),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}},990:(t,e,n)=>{var a={"./atom/item.jsx":696,"./atom/list.jsx":235,"./atom/searchQuick.jsx":368,"./atom/select.jsx":783,"./atom/selecting.jsx":239,"./json/jsonEditor.jsx":458};function r(t){var e=o(t);return n(e)}function o(t){if(!n.o(a,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return a[t]}r.keys=function(){return Object.keys(a)},r.resolve=o,t.exports=r,r.id=990},142:(t,e,n)=>{var a={"./atom/autoStar.vue":888,"./atom/labels.vue":608,"./atom/selectAtomClass.vue":905,"./attachment/all.vue":150,"./attachment/list.vue":740,"./base/about.vue":15,"./base/alert.vue":17,"./category/categorySelect.vue":966,"./comment/all.vue":547,"./comment/autoHeart.vue":201,"./comment/item.vue":200,"./comment/list.vue":229,"./resource/authorize.vue":932,"./resource/resourceSelect.vue":454,"./resource/tree.vue":885,"./tag/tagSelect.vue":416};function r(t){var e=o(t);return n(e)}function o(t){if(!n.o(a,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return a[t]}r.keys=function(){return Object.keys(a)},r.resolve=o,t.exports=r,r.id=142},5:t=>{"use strict";t.exports=window.Vue}},e={};function n(a){if(e[a])return e[a].exports;var r=e[a]={id:a,exports:{}};return t[a](r,r.exports,n),r.exports}return n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var a in e)n.o(e,a)&&!n.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n(292)})();
//# sourceMappingURL=front.js.map