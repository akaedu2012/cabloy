window["a-baselayout"]=(()=>{var t={222:(t,e,a)=>{"use strict";function n(t,e,a,n,o,r,i){try{var s=t[r](i),l=s.value}catch(t){return void a(t)}s.done?e(l):Promise.resolve(l).then(n,o)}a.d(e,{Z:()=>M});const o={meta:{global:!1},props:{layoutManager:{type:Object},layoutConfig:{type:Object}},data:function(){return{items:[]}},created:function(){this.layoutManager.layout.instance=this,this.layoutManager.container.atomClass&&"select"!==this.layoutManager.container.scene&&"selecting"!==this.layoutManager.container.scene&&(this.layoutManager.subnavbar.enable=!0,this.layoutManager.bulk_loadActions())},methods:{onPageRefresh:function(t){this.$refs.loadMore.reload(t)},onPageInfinite:function(){this.$refs.loadMore.loadMore()},onPageClear:function(){this.$refs.loadMore.clear()},onLoadClear:function(t){this.items=[],this.layoutManager.bulk.selectedAtoms=[],t()},onLoadMore:function(t){var e,a=this;return(e=regeneratorRuntime.mark((function e(){var n,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.index,(o=a.layoutManager.base_prepareSelectParams()).options.page={index:n},e.next=5,a.$api.post("/a/base/atom/select",o);case 5:return r=e.sent,a.items=a.items.concat(r.list),e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})),function(){var t=this,a=arguments;return new Promise((function(o,r){var i=e.apply(t,a);function s(t){n(i,o,r,s,l,"next",t)}function l(t){n(i,o,r,s,l,"throw",t)}s(void 0)}))})()},getBlockComponentOptions:function(t){var e=t.blockConfig;return{props:{layoutManager:this.layoutManager,layout:this,blockConfig:e}}},getItems:function(){return this.items},_renderBlock:function(t){var e=t.blockName,a=this.$createElement,n=this.layoutConfig.blocks[e];return n?a("eb-component",{attrs:{module:n.component.module,name:n.component.name,options:this.getBlockComponentOptions({blockConfig:n})}}):null},_renderLoadMore:function(){return(0,this.$createElement)("eb-load-more",{ref:"loadMore",props:{onLoadClear:this.onLoadClear,onLoadMore:this.onLoadMore},attrs:{autoInit:"search"!==this.layoutManager.container.scene}})}},render:function(){var t=arguments[0];return t("div",[this._renderBlock({blockName:"items"}),this._renderLoadMore()])}};var r=a(5),i=a.n(r);function s(t,e,a,n,o,r,i){try{var s=t[r](i),l=s.value}catch(t){return void a(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function l(t){return function(){var e=this,a=arguments;return new Promise((function(n,o){var r=t.apply(e,a);function i(t){s(r,n,o,i,l,"next",t)}function l(t){s(r,n,o,i,l,"throw",t)}i(void 0)}))}}function u(t,e){var a;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(a=function(t,e){if(t){if("string"==typeof t)return c(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?c(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,s=!1;return{s:function(){a=t[Symbol.iterator]()},n:function(){var t=a.next();return i=t.done,t},e:function(t){s=!0,r=t},f:function(){try{i||null==a.return||a.return()}finally{if(s)throw r}}}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}function m(t,e){var a;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(a=function(t,e){if(t){if("string"==typeof t)return f(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?f(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,s=!1;return{s:function(){a=t[Symbol.iterator]()},n:function(){var t=a.next();return i=t.done,t},e:function(t){s=!0,r=t},f:function(){try{i||null==a.return||a.return()}finally{if(s)throw r}}}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}function d(t,e){var a;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(a=function(t,e){if(t){if("string"==typeof t)return h(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?h(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,s=!1;return{s:function(){a=t[Symbol.iterator]()},n:function(){var t=a.next();return i=t.done,t},e:function(t){s=!0,r=t},f:function(){try{i||null==a.return||a.return()}finally{if(s)throw r}}}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}const g={data:function(){return{antdv:{locales:null}}},created:function(){var t=this;this.$meta.util.performAction({ctx:this,action:{actionModule:"a-antdv",actionComponent:"antdv",name:"locales"}}).then((function(e){t.antdv.locales=e}))},methods:{antdv_getLocale:function(){if(!this.antdv.locales)return null;var t=this.$meta.util.getLocale();return t&&"en-us"!==t?this.antdv.locales[t]:null}}};function p(t,e,a,n,o,r,i){try{var s=t[r](i),l=s.value}catch(t){return void a(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function y(t){return function(){var e=this,a=arguments;return new Promise((function(n,o){var r=t.apply(e,a);function i(t){p(r,n,o,i,s,"next",t)}function s(t){p(r,n,o,i,s,"throw",t)}i(void 0)}))}}function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}function C(t,e){var a;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(a=function(t,e){if(t){if("string"==typeof t)return _(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,s=!1;return{s:function(){a=t[Symbol.iterator]()},n:function(){var t=a.next();return i=t.done,t},e:function(t){s=!0,r=t},f:function(){try{i||null==a.return||a.return()}finally{if(s)throw r}}}}function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}const M={listLayoutList:o,listLayoutBlockFilter:{meta:{global:!1},mixins:[i().prototype.$meta.module.get("a-base").options.mixins.ebAtomClasses],props:{layoutManager:{type:Object},filterConfig:{type:Object},filterContainer:{type:Object}},data:function(){return{form:this.$meta.util.getProperty(this.layoutManager,"filter.data.form")||{atomName:null,mine:this.layoutManager.container.options&&this.layoutManager.container.options.mine||0,stage:this.layoutManager.container.options&&this.layoutManager.container.options.stage||"archive",language:this.layoutManager.container.options&&this.layoutManager.container.options.language||"",category:this.layoutManager.container.options&&this.layoutManager.container.options.category||0,tag:this.layoutManager.container.options&&this.layoutManager.container.options.tag||0,star:this.layoutManager.container.options&&this.layoutManager.container.options.star||0,label:this.layoutManager.container.options&&this.layoutManager.container.options.label||0,atomClass:this.layoutManager.container.atomClass},formAtomClass:this.$meta.util.getProperty(this.layoutManager,"filter.data.formAtomClass")||{},validateParams:null,categoriesAll:null,tagsAll:null,ready:!1}},computed:{userLabels:function(){var t=this.$store.getters["a/base/userLabels"];if(!t)return null;var e=[{title:"",value:0}];for(var a in t)e.push({title:t[a].text,value:a});return e},locales:function(){var t=this.$store.getState("a/base/locales");return t?[{title:"",value:""}].concat(t):[]},atomClass:function(){return this.form.atomClass},atomClassBase:function(){return this.atomClass?this.getAtomClass(this.atomClass):null},atomClassTitle:function(){if(!this.atomClass)return"";if(this.atomClass.title)return this.atomClass.title;var t=this.atomClassBase;return t?t.titleLocale:""},stages:function(){for(var t=[],e=0,a=["draft","archive","history"];e<a.length;e++){var n=a[e];t.push({title:n.replace(n[0],n[0].toUpperCase()),value:n})}return t}},watch:{form:{handler:function(){this.onFilterChanged()},deep:!0},formAtomClass:{handler:function(){this.onFilterChanged()},deep:!0}},created:function(){},methods:{onAtomClassesReady:function(){this.init()},init:function(){var t=this;return l(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("a/base/getLabels");case 2:return e.next=4,t.$store.dispatch("a/base/getLocales");case 4:return e.next=6,t.atomClassChanged();case 6:t.ready=!0;case 7:case"end":return e.stop()}}),e)})))()},loadCategoriesAll:function(t){var e=this;return l(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if((n=e.atomClassBase)&&n.category){a.next=3;break}return a.abrupt("return");case 3:return a.next=5,e.$store.dispatch("a/base/getCategories",{atomClass:e.atomClass,language:t});case 5:e.categoriesAll=a.sent;case 6:case"end":return a.stop()}}),a)})))()},loadTagsAll:function(t){var e=this;return l(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if((n=e.atomClassBase)&&n.tag){a.next=3;break}return a.abrupt("return");case 3:return a.next=5,e.$store.dispatch("a/base/getTags",{atomClass:e.atomClass,language:t});case 5:e.tagsAll=a.sent;case 6:case"end":return a.stop()}}),a)})))()},atomClassChanged:function(){var t=this;return l(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.validateParams=null,a=t.atomClass){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,t.loadCategoriesAll(t.form.language);case 6:return e.next=8,t.loadTagsAll(t.form.language);case 8:return e.next=10,t.$meta.module.use(a.module);case 10:return e.next=12,t.$api.post("/a/base/atomClass/validatorSearch",{atomClass:{module:a.module,atomClassName:a.atomClassName}});case 12:n=e.sent,t.validateParams={module:n.module,validator:n.validator};case 14:case"end":return e.stop()}}),e)})))()},onSelectAtomClass:function(){var t=this;this.$view.navigate("/a/basefront/atom/selectAtomClass",{target:"_self",context:{params:{atomClass:this.atomClass,optional:!0},callback:function(e,a){200===e&&t.form.atomClass!==a&&(t.form.atomClass=a,t.formAtomClass={},t.atomClassChanged())}}})},onFilterChanged:function(t){(t||this.filterContainer.immediate)&&this.onFilterDebounce()},onFilterDebounce:i().prototype.$meta.util.debounce((function(){this.layoutManager.filter_onChanged({form:this.form,formAtomClass:this.formAtomClass})}),300),onPerformSearch:function(){this.onFilterChanged(!0),this.$f7router.back()},onFormSubmit:function(){this.filterContainer.immediate||this.onPerformSearch()},getCategoryName:function(t){if(!this.categoriesAll||!t)return"";var e=this.categoriesAll.find((function(e){return e.id===t}));return e?e.categoryName:""},getTagName:function(t){if(!this.tagsAll||!t)return"";var e=this.tagsAll.find((function(e){return e.id===t}));return e?e.tagName:""},combineAtomClassAndLanguage:function(t){var e={module:this.atomClass.module,atomClassName:this.atomClass.atomClassName};return t&&(e.language=t),e},_selectLanguage:function(t){var e=this;return l(regeneratorRuntime.mark((function a(){var n,o,r;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n={actionModule:"a-base",actionComponent:"action",name:"selectLocale",targetEl:t.target},!e.form.language){a.next=5;break}o=e.form.language,a.next=9;break;case 5:return a.next=7,e.$meta.util.performAction({ctx:e,action:n,item:e.atomClass});case 7:(r=a.sent)&&(o=r.value,e.form.language=r.value);case 9:return a.abrupt("return",o);case 10:case"end":return a.stop()}}),a)})))()},onChooseCategory:function(t){var e=this;return l(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e._selectLanguage(t);case 2:if(!(n=a.sent)){a.next=6;break}return a.next=6,e.loadCategoriesAll(n);case 6:return a.abrupt("return",new Promise((function(t){var a=e.$meta.util.combineQueries("/a/basefront/category/select",e.combineAtomClassAndLanguage(n));e.$view.navigate(a,{target:"_self",context:{params:{categoryIdStart:0,leafOnly:!0},callback:function(a,n){200===a?(e.form.category=n?n.id:0,t(!0)):!1===a&&t(!1)}}})})));case 7:case"end":return a.stop()}}),a)})))()},onChooseTag:function(t){var e=this;return l(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e._selectLanguage(t);case 2:if(!(n=a.sent)){a.next=6;break}return a.next=6,e.loadTagsAll(n);case 6:return a.abrupt("return",new Promise((function(t){var a=e.$meta.util.combineQueries("/a/basefront/tag/select",e.combineAtomClassAndLanguage(n));e.$view.navigate(a,{target:"_self",context:{params:{tags:e.form.tag?[e.form.tag]:null,multiple:!1},callback:function(a,n){200===a?(e.form.tag=n,t(!0)):!1===a&&t(!1)}}})})));case 7:case"end":return a.stop()}}),a)})))()},_renderForm:function(){var t=this,e=this.$createElement;return e("eb-list",{attrs:{form:!0,"inline-labels":!0,"no-hairlines-md":!0},on:{submit:this.onFormSubmit}},[e("eb-list-input",{attrs:{label:this.$text("Atom Name"),type:"text","clear-button":!0,placeholder:this.$text("Atom Name")},model:{value:t.form.atomName,callback:function(e){t.$set(t.form,"atomName",e)}}}),e("f7-list-item",{attrs:{title:this.$text("Mine")}},[e("eb-toggle",{slot:"after",model:{value:t.form.mine,callback:function(e){t.$set(t.form,"mine",e)}}})]),e("f7-list-item",{attrs:{smartSelect:!0,title:this.$text("Stage"),smartSelectParams:{openIn:"sheet",closeOnSelect:!0}}},[e("eb-select",{attrs:{name:"stage",options:this.stages},model:{value:t.form.stage,callback:function(e){t.$set(t.form,"stage",e)}}})]),e("f7-list-item",{attrs:{divider:!0}}),this._renderLanguageAndOthers(),e("f7-list-item",{attrs:{title:this.$text("UserStar")}},[e("eb-toggle",{slot:"after",model:{value:t.form.star,callback:function(e){t.$set(t.form,"star",e)}}})]),e("f7-list-item",{attrs:{smartSelect:!0,title:this.$text("UserLabel"),smartSelectParams:{openIn:"sheet",closeOnSelect:!0}}},[e("eb-select",{attrs:{name:"label",options:this.userLabels},model:{value:t.form.label,callback:function(e){t.$set(t.form,"label",e)}}})]),e("f7-list-item",{attrs:{divider:!0}}),this._renderAtomClass()])},_renderLanguage:function(){var t=this,e=this.$createElement;return e("f7-list-item",{key:"form.language",attrs:{smartSelect:!0,title:this.$text("Language"),smartSelectParams:{openIn:"sheet",closeOnSelect:!0}}},[e("eb-select",{attrs:{name:"language",options:this.locales},model:{value:t.form.language,callback:function(e){t.$set(t.form,"language",e)}}})])},_renderCategory:function(){var t=this.$createElement;return t("eb-list-item-choose",{key:"form.category",attrs:{link:"#",title:this.$text("Category")},props:{onChoose:this.onChooseCategory}},[t("div",{slot:"after"},[this.getCategoryName(this.form.category)])])},_renderTag:function(){var t=this.$createElement;return t("eb-list-item-choose",{key:"form.tag",attrs:{link:"#",title:this.$text("Tag")},props:{onChoose:this.onChooseTag}},[t("div",{slot:"after"},[this.getTagName(this.form.tag)])])},_renderLanguageAndOthers:function(){var t=this.$createElement,e=this.atomClassBase;if(!e)return null;var a=[];return e.language&&a.push(this._renderLanguage()),e.category&&a.push(this._renderCategory()),e.tag&&a.push(this._renderTag()),a.length>0&&a.push(t("f7-list-item",{attrs:{divider:!0}})),a},_renderAtomClass:function(){var t=this.$createElement;return this.layoutManager.container.atomClass?null:t("f7-list-item",{attrs:{title:this.$text("Atom Class"),link:"#"},on:{click:this.onSelectAtomClass}},[t("div",{slot:"after"},[this.atomClassTitle])])},_renderFormAtomClass:function(){var t=this.$createElement;return this.validateParams?t("eb-validate",{ref:"validate",attrs:{auto:!0,data:this.formAtomClass,params:this.validateParams},on:{submit:this.onFormSubmit}}):null}},render:function(){var t=arguments[0];return t("div",[this.ready&&this._renderForm(),this.ready&&this._renderFormAtomClass()])}},listLayoutBlockListTitle:{meta:{global:!1},props:{layoutManager:{type:Object},blockConfig:{type:Object}},data:function(){return{}},created:function(){},methods:{},render:function(){var t=arguments[0];return t("f7-nav-right",[this.layoutManager.order_renderAction(),this.layoutManager.filter_renderAction()])}},listLayoutBlockListSubnavbar:{meta:{global:!1},props:{layoutManager:{type:Object},blockConfig:{type:Object}},data:function(){return{}},methods:{_renderActionsLeft:function(){return(0,this.$createElement)("div",{class:"actions-block actions-block-left"},[this.layoutManager.bulk_renderActionsLeft()])},_renderActionsRight:function(){return(0,this.$createElement)("div",{class:"actions-block actions-block-right"},[this.layoutManager.bulk_renderActionsRight()])}},render:function(){var t=arguments[0];return t("f7-subnavbar",[t("div",{class:"atom-list-subnavbar-container"},[this._renderActionsLeft(),this._renderActionsRight()])])}},listLayoutBlockListItems:{meta:{global:!1},mixins:[i().prototype.$meta.module.get("a-base").options.mixins.ebAtomActions],props:{layoutManager:{type:Object},layout:{type:Object},blockConfig:{type:Object}},data:function(){return{radioName:i().prototype.$meta.util.nextId("radio")}},mounted:function(){this.$meta.eventHub.$on("atom:star",this.onStarChanged),this.$meta.eventHub.$on("atom:labels",this.onLabelsChanged),this.$meta.eventHub.$on("atom:action",this.onActionChanged),this.$meta.eventHub.$on("atom:actions",this.onActionsChanged)},beforeDestroy:function(){this.$meta.eventHub.$off("atom:star",this.onStarChanged),this.$meta.eventHub.$off("atom:labels",this.onLabelsChanged),this.$meta.eventHub.$off("atom:action",this.onActionChanged),this.$meta.eventHub.$off("atom:actions",this.onActionsChanged)},methods:{onItemClick:function(t,e){if(!this.layoutManager.bulk.selecting)return this.onAction(t,e,{module:e.module,atomClassName:e.atomClassName,name:"read"})},onSwipeoutOpened:function(t,e){e._actions||this.$api.post("/a/base/atom/actions",{key:{atomId:e.atomId},basic:!this.$device.desktop}).then((function(t){i().set(e,"_actions",t)}))},onLabel:function(t,e){var a=this;this.layoutManager.base_user.anonymous?this.$view.dialog.confirm(this.$text("Please Sign In")).then((function(){a.$meta.vueLayout.openLogin()})):(this.$view.navigate("/a/basefront/atom/labels?atomId=".concat(e.atomId),{target:"_self"}),this.$meta.util.swipeoutClose(t.target))},onStarSwitch:function(t,e){var a=e.star?0:1;return this._onStarSwitch(t,e,a,"swipeoutClose")},onAction:function(t,e,a){var n=this,o=this.getAction(a);if(o)return this.$meta.util.performAction({ctx:this,action:o,item:e}).then((function(){n.$meta.util.swipeoutClose(t.target)}))},onStarChanged:function(t){var e=this.layout.items.findIndex((function(e){return e.atomId===t.key.atomId}));-1!==e&&(this.layout.items[e].star=t.star)},onLabelsChanged:function(t){var e=this.layout.items.findIndex((function(e){return e.atomId===t.key.atomId}));-1!==e&&(this.layout.items[e].labels=JSON.stringify(t.labels))},onActionChanged:function(t){var e=this,a=t.key,n=t.action;if(1!==n.menu||"create"!==n.action){var o=this.layout.items.findIndex((function(t){return t.atomId===a.atomId}));if("delete"!==n.name){if(-1!==o){var r=this.layoutManager.base_prepareReadOptions();this.$api.post("/a/base/atom/read",{key:a,options:r}).then((function(t){i().set(e.layout.items,o,t)}))}}else-1!==o&&this.layout.items.splice(o,1)}},onActionsChanged:function(t){var e=t.key,a=this.layout.items.findIndex((function(t){return t.atomId===e.atomId}));-1!==a&&i().set(this.layout.items[a],"_actions",null)},onItemChange:function(t,e){this.layoutManager.bulk_onItemChange(t,e)},_onStarSwitch:function(t,e,a,n){var o=this;if(!this.layoutManager.base_user.anonymous){var r={atomId:e.atomId,itemId:e.itemId};return this.$api.post("/a/base/atom/star",{key:r,atom:{star:a}}).then((function(e){o.$meta.eventHub.$emit("atom:star",{key:r,star:e.star,starCount:e.starCount}),o.$meta.util[n](t.target)}))}this.$view.dialog.confirm(this.$text("Please Sign In")).then((function(){o.$meta.vueLayout.openLogin()}))},_getItemMetaMedia:function(t){var e=t._meta&&t._meta.media||t.avatar||this.$meta.config.modules["a-base"].user.avatar.default;return this.$meta.util.combineImageUrl(e,24)},_getItemMetaMediaLabel:function(t){return t._meta&&t._meta.mediaLabel||t.userName},_getItemMetaSummary:function(t){var e=t._meta&&t._meta.summary||"";if(this.layoutManager.container.atomClass)return e;var a=this.layoutManager.getAtomClass({module:t.module,atomClassName:t.atomClassName});return a?"".concat(a.titleLocale," ").concat(e):e},_getItemMetaFlags:function(t){var e=t._meta&&t._meta.flags||[];return Array.isArray(e)||(e=e.split(",")),t.atomDisabled&&(e=[this.$text("Disabled")].concat(e)),e},_getLabel:function(t){return this.layoutManager.base_userLabels?this.layoutManager.base_userLabels[t]:null},_getActionColor:function(t,e){return 0===e?"orange":1===e?"red":"blue"},_getActionTitle:function(t,e){return this.getActionTitle(t,e.atomStage)},_getItemChecked:function(t){return this.layoutManager.bulk.selectedAtoms.findIndex((function(e){return e.atomId===t.atomId}))>-1},_renderListItem:function(t){var e,a=this,n=this.$createElement,o=this.layoutManager.bulk.selecting?null:n("div",{slot:"media"},[n("img",{class:"avatar avatar24",attrs:{src:this._getItemMetaMedia(t)}})]),r=n("div",{slot:"root-start",class:"header"},[n("div",{class:"mediaLabel"},[n("span",[this._getItemMetaMediaLabel(t)])]),n("div",{class:"date"},[t.star>0&&n("span",["⭐"]),t.attachmentCount>0&&n("span",["🧷"]),t.attachmentCount>1&&n("span",["".concat(t.attachmentCount)]),t.commentCount>0&&n("span",["💬"]),t.commentCount>1&&n("span",["".concat(t.commentCount)]),n("span",[this.$meta.util.formatDateTimeRelative(t.atomUpdatedAt)])])]),i=n("div",{slot:"title",class:"title"},[n("div",[t.atomNameLocale||t.atomName])]),s=n("div",{slot:"root-end",class:"summary"},[this._getItemMetaSummary(t)]),l=[],c=u(this._getItemMetaFlags(t));try{for(c.s();!(e=c.n()).done;){var m=e.value;l.push(n("f7-badge",{key:m},[m]))}}catch(t){c.e(t)}finally{c.f()}var f=[];if(t.labels&&this.layoutManager.base_userLabels){var d,h=u(JSON.parse(t.labels));try{for(h.s();!(d=h.n()).done;){var g=d.value,p=this._getLabel(g);f.push(n("f7-badge",{key:g,style:{backgroundColor:p.color}},[p.text]))}}catch(t){h.e(t)}finally{h.f()}}var y=n("div",{slot:"after",class:"after"},[l,f]);return n("eb-list-item",{class:"item",key:t.atomId,attrs:{link:!this.layoutManager.bulk.selecting&&"#",name:this.radioName,checkbox:this.layoutManager.bulk.selecting,checked:this._getItemChecked(t),swipeout:!0},props:{onPerform:function(e){return a.onItemClick(e,t)}},on:{swipeoutOpened:function(e){a.onSwipeoutOpened(e,t)},contextmenuOpened:function(e){a.onSwipeoutOpened(e,t)},change:function(e){return a.onItemChange(e,t)}}},[o,r,i,s,y,this._renderListItemContextMenu(t)])},_renderListItemContextMenu:function(t){var e,a=this,n=this.$createElement;if(1===t.atomStage){var o=n("div",{attrs:{color:"teal"},props:{onPerform:function(e){return a.onStarSwitch(e,t)}}},[n("f7-icon",{slot:"media",attrs:{material:t.star?"star_border":"star"}}),this.$device.desktop&&n("div",{slot:"title"},[this.$text(t.star?"Unstar":"Star")])]),r=n("div",{attrs:{color:"blue"},props:{onPerform:function(e){return a.onLabel(e,t)}}},[n("f7-icon",{slot:"media",attrs:{material:"label"}}),this.$device.desktop&&n("div",{slot:"title"},[this.$text("Labels")])]);e=n("div",{slot:"left"},[o,r])}var i=[];if(t._actions){var s=function(e){e=parseInt(e);var o=t._actions[e],r=a.getAction(o);i.push(n("div",{key:o.id,attrs:{color:a._getActionColor(o,e)},props:{onPerform:function(e){return a.onAction(e,t,o)}}},[n("f7-icon",{slot:"media",attrs:{material:r.icon.material}}),a.$device.desktop&&n("div",{slot:"title"},[a._getActionTitle(o,t)])])),l=e};for(var l in t._actions)s(l)}var u=n("div",{slot:"right",attrs:{ready:!!t._actions}},[i]);return n("eb-context-menu",[e,u])},_renderList:function(){var t,e=this.$createElement,a=[],n=u(this.layout.items);try{for(n.s();!(t=n.n()).done;){var o=t.value;a.push(this._renderListItem(o))}}catch(t){n.e(t)}finally{n.f()}return e("f7-list",[a])}},render:function(){var t=arguments[0];return t("div",[this._renderList()])}},listLayoutBlockSelectTitle:{meta:{global:!1},props:{layoutManager:{type:Object},blockConfig:{type:Object}},data:function(){return{}},created:function(){},methods:{onPerformAdd:function(){var t=this,e=this.layoutManager.select_getSelectedAtoms(),a={selectMode:this.layoutManager.container.params.selectMode,selectedAtoms:e};this.$view.navigate("/a/basefront/atom/selecting",{target:"_self",context:{params:{atomClass:this.layoutManager.container.atomClass,options:this.layoutManager.container.options,params:a},callback:function(e,a){200===e&&(t.layoutManager.container.params.selectedAtomIds=a.map((function(t){return t.atomId})),t.layoutManager.page_onRefresh())}}})},onPerformDone:function(){var t=this.getSelectedAtoms();this.layoutManager.contextCallback(200,t),this.$f7router.back()},getSelectedAtoms:function(){var t=this.layoutManager.select_getSelectedAtoms();return"single"===this.layoutManager.container.params.selectMode?t&&t.length>0?t[0]:null:t&&t.length>0?t:null}},render:function(){var t=arguments[0];return t("f7-nav-right",[t("eb-link",{attrs:{iconMaterial:"add"},props:{onPerform:this.onPerformAdd}}),t("eb-link",{attrs:{iconMaterial:"done"},props:{onPerform:this.onPerformDone}})])}},listLayoutBlockSelectItems:{meta:{global:!1},mixins:[i().prototype.$meta.module.get("a-base").options.mixins.ebAtomActions],props:{layoutManager:{type:Object},layout:{type:Object},blockConfig:{type:Object}},data:function(){return{}},methods:{onItemClick:function(t,e){return this.onAction(t,e,{module:e.module,atomClassName:e.atomClassName,name:"read"})},onActionSelectRemove:function(t,e){this.$meta.util.swipeoutClose(t.target);var a=this.layoutManager.container.params.selectedAtomIds;if(a){var n=a.findIndex((function(t){return t===e.atomId}));-1!==n&&a.splice(n,1)}var o=this.layoutManager.base_getItems(),r=o.findIndex((function(t){return t.atomId===e.atomId}));-1!==r&&o.splice(r,1)},onAction:function(t,e,a){var n=this,o=this.getAction(a);if(o)return this.$meta.util.performAction({ctx:this,action:o,item:e}).then((function(){n.$meta.util.swipeoutClose(t.target)}))},_getItemMetaMedia:function(t){var e=t._meta&&t._meta.media||t.avatar||this.$meta.config.modules["a-base"].user.avatar.default;return this.$meta.util.combineImageUrl(e,32)},_getItemMetaMediaLabel:function(t){return t._meta&&t._meta.mediaLabel||t.userName},_getItemMetaSummary:function(t){var e=t._meta&&t._meta.summary||"";if(this.layoutManager.container.atomClass)return e;var a=this.layoutManager.getAtomClass({module:t.module,atomClassName:t.atomClassName});return a?"".concat(a.titleLocale," ").concat(e):e},_getItemMetaFlags:function(t){var e=t._meta&&t._meta.flags||[];return Array.isArray(e)||(e=e.split(",")),t.atomDisabled&&(e=[this.$text("Disabled")].concat(e)),e},_getLabel:function(t){return this.layoutManager.base_userLabels?this.layoutManager.base_userLabels[t]:null},_renderListItem:function(t){var e,a=this,n=this.$createElement,o=n("div",{slot:"media"},[n("img",{class:"avatar avatar24",attrs:{src:this._getItemMetaMedia(t)}})]),r=n("div",{slot:"root-start",class:"header"},[n("div",{class:"mediaLabel"},[n("span",[this._getItemMetaMediaLabel(t)])]),n("div",{class:"date"},[t.star>0&&n("span",["⭐"]),t.attachmentCount>0&&n("span",["🧷"]),t.attachmentCount>1&&n("span",["".concat(t.attachmentCount)]),t.commentCount>0&&n("span",["💬"]),t.commentCount>1&&n("span",["".concat(t.commentCount)]),n("span",[this.$meta.util.formatDateTimeRelative(t.atomUpdatedAt)])])]),i=n("div",{slot:"title",class:"title"},[n("div",[t.atomNameLocale||t.atomName])]),s=n("div",{slot:"root-end",class:"summary"},[this._getItemMetaSummary(t)]),l=[],u=m(this._getItemMetaFlags(t));try{for(u.s();!(e=u.n()).done;){var c=e.value;l.push(n("f7-badge",{key:c},[c]))}}catch(t){u.e(t)}finally{u.f()}var f=[];if(t.labels&&this.layoutManager.base_userLabels){var d,h=m(JSON.parse(t.labels));try{for(h.s();!(d=h.n()).done;){var g=d.value,p=this._getLabel(g);f.push(n("f7-badge",{key:g,style:{backgroundColor:p.color}},[p.text]))}}catch(t){h.e(t)}finally{h.f()}}var y=n("div",{slot:"after",class:"after"},[l,f]);return n("eb-list-item",{class:"item",key:t.atomId,attrs:{link:"#",swipeout:!0},props:{onPerform:function(e){return a.onItemClick(e,t)}}},[o,r,i,s,y,this._renderListItemContextMenu(t)])},_renderListItemContextMenu:function(t){var e=this,a=this.$createElement;return a("eb-context-menu",[a("div",{slot:"right"},[a("div",{attrs:{color:"teal"},props:{onPerform:function(a){return e.onActionSelectRemove(a,t)}}},[this.$text("Remove")])])])},_renderList:function(){var t,e=this.$createElement,a=[],n=m(this.layout.items);try{for(n.s();!(t=n.n()).done;){var o=t.value;a.push(this._renderListItem(o))}}catch(t){n.e(t)}finally{n.f()}return e("f7-list",[a])}},render:function(){var t=arguments[0];return t("div",[this._renderList()])}},listLayoutBlockSelectingTitle:{meta:{global:!1},props:{layoutManager:{type:Object},blockConfig:{type:Object}},data:function(){return{}},computed:{selectedAtoms:function(){return this.layoutManager.select_getSelectedAtoms()}},created:function(){},methods:{onPerformAtomOrders:function(t){this.layoutManager.order_onPerformPopover(t.currentTarget)},onPerformFilter:function(){this.layoutManager.filter_onPerform()},onPerformDone:function(){this.layoutManager.contextCallback(200,this.selectedAtoms),this.$f7router.back()}},render:function(){var t=this,e=arguments[0];return e("f7-nav-right",[e("eb-link",{attrs:{iconMaterial:"sort"},props:{onPerform:function(e){return t.onPerformAtomOrders(e)}}}),e("eb-link",{attrs:{iconMaterial:"search"},props:{onPerform:this.onPerformFilter}}),this.selectedAtoms.length>0&&e("eb-link",{attrs:{iconMaterial:"done"},props:{onPerform:this.onPerformDone}})])}},listLayoutBlockSelectingItems:{meta:{global:!1},mixins:[i().prototype.$meta.module.get("a-base").options.mixins.ebAtomActions],props:{layoutManager:{type:Object},layout:{type:Object},blockConfig:{type:Object}},data:function(){return{radioName:i().prototype.$meta.util.nextId("radio")}},computed:{selectedAtoms:function(){return this.layoutManager.select_getSelectedAtoms()}},methods:{onItemChange:function(t,e){if("single"===this.layoutManager.container.params.selectMode)t.target.checked&&(this.layoutManager.container.params.selectedAtoms=[e]);else{var a=this.layoutManager.container.params.selectedAtoms,n=a.findIndex((function(t){return t.atomId===e.atomId}));t.target.checked&&-1===n?a.push(e):!t.target.checked&&n>-1&&a.splice(n,1)}},onActionView:function(t,e){return this.onAction(t,e,{module:e.module,atomClassName:e.atomClassName,name:"read"})},onAction:function(t,e,a){var n=this,o=this.getAction(a);if(o)return this.$meta.util.performAction({ctx:this,action:o,item:e}).then((function(){n.$meta.util.swipeoutClose(t.target)}))},_getItemMetaMediaLabel:function(t){return t._meta&&t._meta.mediaLabel||t.userName},_getItemMetaSummary:function(t){var e=t._meta&&t._meta.summary||"";if(this.layoutManager.container.atomClass)return e;var a=this.layoutManager.getAtomClass({module:t.module,atomClassName:t.atomClassName});return a?"".concat(a.titleLocale," ").concat(e):e},_getItemMetaFlags:function(t){var e=t._meta&&t._meta.flags||[];return Array.isArray(e)||(e=e.split(",")),t.atomDisabled&&(e=[this.$text("Disabled")].concat(e)),e},_getLabel:function(t){return this.layoutManager.base_userLabels?this.layoutManager.base_userLabels[t]:null},_getItemChecked:function(t){return this.selectedAtoms.findIndex((function(e){return e.atomId===t.atomId}))>-1},_renderListItem:function(t){var e,a=this,n=this.$createElement,o=n("div",{slot:"root-start",class:"header"},[n("div",{class:"mediaLabel"},[n("span",[this._getItemMetaMediaLabel(t)])]),n("div",{class:"date"},[t.star>0&&n("span",["⭐"]),t.attachmentCount>0&&n("span",["🧷"]),t.attachmentCount>1&&n("span",["".concat(t.attachmentCount)]),t.commentCount>0&&n("span",["💬"]),t.commentCount>1&&n("span",["".concat(t.commentCount)]),n("span",[this.$meta.util.formatDateTimeRelative(t.atomUpdatedAt)])])]),r=n("div",{slot:"title",class:"title"},[n("div",[t.atomNameLocale||t.atomName])]),i=n("div",{slot:"root-end",class:"summary"},[this._getItemMetaSummary(t)]),s=[],l=d(this._getItemMetaFlags(t));try{for(l.s();!(e=l.n()).done;){var u=e.value;s.push(n("f7-badge",{key:u},[u]))}}catch(t){l.e(t)}finally{l.f()}var c=[];if(t.labels&&this.layoutManager.base_userLabels){var m,f=d(JSON.parse(t.labels));try{for(f.s();!(m=f.n()).done;){var h=m.value,g=this._getLabel(h);c.push(n("f7-badge",{key:h,style:{backgroundColor:g.color}},[g.text]))}}catch(t){f.e(t)}finally{f.f()}}var p=n("div",{slot:"after",class:"after"},[s,c]);return n("eb-list-item",{class:"item",key:t.atomId,attrs:{name:this.radioName,radio:"single"===this.layoutManager.container.params.selectMode,checkbox:"multiple"===this.layoutManager.container.params.selectMode,checked:this._getItemChecked(t),swipeout:!0},on:{change:function(e){return a.onItemChange(e,t)}}},[o,r,i,p,this._renderListItemContextMenu(t)])},_renderListItemContextMenu:function(t){var e=this,a=this.$createElement;return a("eb-context-menu",[a("div",{slot:"right"},[a("div",{attrs:{color:"teal"},props:{onPerform:function(a){return e.onActionView(a,t)}}},[this.$text("View")])])])},_renderList:function(){var t,e=this.$createElement,a=[],n=d(this.layout.items);try{for(n.s();!(t=n.n()).done;){var o=t.value;a.push(this._renderListItem(o))}}catch(t){n.e(t)}finally{n.f()}return e("f7-list",[a])}},render:function(){var t=arguments[0];return t("div",[this._renderList()])}},listLayoutTable:{meta:{global:!1},mixins:[g],props:{layoutManager:{type:Object},layoutConfig:{type:Object}},data:function(){return{info:{pageCurrent:0,pageSize:20,total:0},itemsPages:{},loading:!1}},computed:{dataSource:function(){return this.itemsPages[this.info.pageCurrent]}},created:function(){this.layoutManager.layout.instance=this,this.layoutManager.bottombar.enable=!0,this.layoutManager.container.atomClass&&"select"!==this.layoutManager.container.scene&&"selecting"!==this.layoutManager.container.scene&&this.layoutManager.bulk_loadActions(),this.onPageRefresh()},methods:{onPageRefresh:function(){this.onPageClear(),this._loadTotal()},onPageInfinite:function(){},onPageClear:function(){this.layoutManager.bulk.selectedAtoms=[],this.itemsPages={},this.info={pageCurrent:0,pageSize:20,total:0},this.loading=!1},getItems:function(){return this.dataSource||[]},_findItem:function(t){for(var e in this.itemsPages){var a=this.itemsPages[e],n=a.findIndex((function(e){return e.atomId===t}));if(-1!==n)return{pageNum:parseInt(e),items:a,index:n}}return{pageNum:null,items:null,index:-1}},_loadTotal:function(){var t=this;return y(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.layoutManager.base_prepareSelectParams(),e.next=3,t.$api.post("/a/base/atom/count",a);case 3:if(n=e.sent,t.info.total=n,0!==t.info.total){e.next=7;break}return e.abrupt("return");case 7:t.gotoPage(1);case 8:case"end":return e.stop()}}),e)})))()},_loadMore:function(t){var e=this;return y(regeneratorRuntime.mark((function a(){var n,o,r,i;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=t.index,o=t.size,(r=e.layoutManager.base_prepareSelectParams()).options.page={index:n,size:o},a.next=5,e.$api.post("/a/base/atom/select",r);case 5:return i=a.sent,a.abrupt("return",i.list);case 7:case"end":return a.stop()}}),a)})))()},gotoPage:function(t){var e=this;if(this.info.pageCurrent!==t)if(this.layoutManager.bulk.selectedAtoms=[],this.itemsPages[t])this.info.pageCurrent=t;else{var a=(t-1)*this.info.pageSize;this.loading=!0,this._loadMore({index:a,size:this.info.pageSize}).then((function(a){e.$set(e.itemsPages,t,a),e.info.pageCurrent=t,e.loading=!1})).catch((function(t){e.$view.toast.show({text:t.message}),e.loading=!1}))}},getBlockComponentOptions:function(t){var e=t.blockConfig;return{props:{layoutManager:this.layoutManager,layout:this,blockConfig:e}}},_renderBlock:function(t){var e=t.blockName,a=this.$createElement,n=this.layoutConfig.blocks[e];return n?a("eb-component",{attrs:{module:n.component.module,name:n.component.name,options:this.getBlockComponentOptions({blockConfig:n})}}):null},_renderEmpty:function(){var t=this.$createElement;return this.loading?t("f7-preloader"):t("div",[this.$text("No Data")])},_renderConfigProvider:function(){var t=this.$createElement;return this.antdv.locales?t("a-config-provider",{attrs:{locale:this.antdv_getLocale(),renderEmpty:this._renderEmpty}},[this._renderBlock({blockName:"items"})]):null}},render:function(){var t=arguments[0];return t("div",{class:"eb-antdv"},[this._renderConfigProvider()])}},listLayoutBlockTableTitle:{meta:{global:!1},props:{layoutManager:{type:Object},blockConfig:{type:Object}},data:function(){return{}},created:function(){},methods:{},render:function(){var t=arguments[0];return t("f7-nav-right",[this.layoutManager.bulk_renderActionsRight(),this.layoutManager.bulk_renderActionsLeftB(),this.layoutManager.order_renderAction(),this.layoutManager.filter_renderAction()])}},listLayoutBlockTableItems:{meta:{global:!1},mixins:[i().prototype.$meta.module.get("a-base").options.mixins.ebAtomActions,i().prototype.$meta.module.get("a-components").options.mixins.ebViewSizeChange],props:{layoutManager:{type:Object},layout:{type:Object},blockConfig:{type:Object}},data:function(){return{tableHeight:0,contextmenuRecord:null,header:!0,toolbar:!0}},computed:{columns:function(){var t,e=[],a=function(t,e){var a;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(a=function(t,e){if(t){if("string"==typeof t)return v(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?v(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,s=!1;return{s:function(){a=t[Symbol.iterator]()},n:function(){var t=a.next();return i=t.done,t},e:function(t){s=!0,r=t},f:function(){try{i||null==a.return||a.return()}finally{if(s)throw r}}}}(this.blockConfig.columns);try{for(a.s();!(t=a.n()).done;){var n=t.value;if(!1!==n.visible){var o=this.$meta.util.extend({},n);o.key=o.key||o.dataIndex,o.title=this.$text(o.title),o.ellipsis=!0,o.customRender=this._customRender,o.sorter=!!this._columnSorterFind(o.dataIndex),o.sortOrder=this._columnSorterCurrent(o.dataIndex),e.push(o)}}}catch(t){a.e(t)}finally{a.f()}return e},rowSelection:function(){return this.layoutManager.bulk.selecting?{selectedRowKeys:this.layoutManager.bulk.selectedAtoms.map((function(t){return t.atomId})),onChange:this.onSelectChange}:null}},mounted:function(){this.$meta.eventHub.$on("atom:star",this.onStarChanged),this.$meta.eventHub.$on("atom:labels",this.onLabelsChanged),this.$meta.eventHub.$on("atom:action",this.onActionChanged),this.$meta.eventHub.$on("atom:actions",this.onActionsChanged)},beforeDestroy:function(){this.$meta.eventHub.$off("atom:star",this.onStarChanged),this.$meta.eventHub.$off("atom:labels",this.onLabelsChanged),this.$meta.eventHub.$off("atom:action",this.onActionChanged),this.$meta.eventHub.$off("atom:actions",this.onActionsChanged)},methods:{onViewSizeChange:function(t){this.tableHeight=t.height-44},onTableChange:function(t,e,a){var n=a.field,o=a.order,r=void 0===o?"ascend":o;if(this._columnSorterCurrent(n)!==r){var i=this._columnSorterFind(n);this.layoutManager.order_onPerformChange(null,i)}},onSelectChange:function(t){var e=this.layoutManager.base_getItems();this.layoutManager.bulk.selectedAtoms=e.filter((function(e){return t.findIndex((function(t){return t===e.atomId}))>-1}))},onItemClick:function(t,e){return this.onAction(t,e,{module:e.module,atomClassName:e.atomClassName,name:"read"})},onSwipeoutOpened:function(t,e){e._actions||this.$api.post("/a/base/atom/actions",{key:{atomId:e.atomId},basic:!this.$device.desktop}).then((function(t){i().set(e,"_actions",t)}))},onLabel:function(t,e){var a=this;this.layoutManager.base_user.anonymous?this.$view.dialog.confirm(this.$text("Please Sign In")).then((function(){a.$meta.vueLayout.openLogin()})):(this.$view.navigate("/a/basefront/atom/labels?atomId=".concat(e.atomId),{}),this.$meta.util.swipeoutClose(t.target))},onStarSwitch:function(t,e){var a=e.star?0:1;return this._onStarSwitch(t,e,a,"swipeoutClose")},onAction:function(t,e,a){var n=this,o=this.getAction(a);if(o)return this.$meta.util.performAction({ctx:this,action:o,item:e}).then((function(){n.$meta.util.swipeoutClose(t.target)}))},onStarChanged:function(t){var e=this.layout._findItem(t.key.atomId),a=e.items,n=e.index;-1!==n&&(a[n].star=t.star)},onLabelsChanged:function(t){var e=this.layout._findItem(t.key.atomId),a=e.items,n=e.index;-1!==n&&(a[n].labels=JSON.stringify(t.labels))},onActionChanged:function(t){var e=t.key,a=t.action;if(1!==a.menu||"create"!==a.action){var n=this.layout._findItem(e.atomId),o=n.items,r=n.index;if("delete"!==a.name){if(-1!==r){var s=this.layoutManager.base_prepareReadOptions();this.$api.post("/a/base/atom/read",{key:e,options:s}).then((function(t){i().set(o,r,t)}))}}else-1!==r&&(o.splice(r,1),this.layout.info.total-=1)}},onActionsChanged:function(t){var e=t.key,a=this.layout._findItem(e.atomId),n=a.items,o=a.index;-1!==o&&i().set(n[o],"_actions",null)},_onStarSwitch:function(t,e,a,n){var o=this;if(!this.layoutManager.base_user.anonymous){var r={atomId:e.atomId,itemId:e.itemId};return this.$api.post("/a/base/atom/star",{key:r,atom:{star:a}}).then((function(e){o.$meta.eventHub.$emit("atom:star",{key:r,star:e.star,starCount:e.starCount}),o.$meta.util[n](t.target)}))}this.$view.dialog.confirm(this.$text("Please Sign In")).then((function(){o.$meta.vueLayout.openLogin()}))},_getItemMetaMedia:function(t){var e=t._meta&&t._meta.media||t.avatar||this.$meta.config.modules["a-base"].user.avatar.default;return this.$meta.util.combineImageUrl(e,24)},_getItemMetaMediaLabel:function(t){return t._meta&&t._meta.mediaLabel||t.userName},_getItemMetaSummary:function(t){var e=t._meta&&t._meta.summary||"";if(this.layoutManager.container.atomClass)return e;var a=this.layoutManager.getAtomClass({module:t.module,atomClassName:t.atomClassName});return a?"".concat(a.titleLocale," ").concat(e):e},_getItemMetaFlags:function(t){var e=t._meta&&t._meta.flags||[];return Array.isArray(e)||(e=e.split(",")),t.atomDisabled&&(e=[this.$text("Disabled")].concat(e)),e},_getLabel:function(t){return this.layoutManager.base_userLabels?this.layoutManager.base_userLabels[t]:null},_getActionColor:function(t,e){return 0===e?"orange":1===e?"red":"blue"},_getActionTitle:function(t,e){return this.getActionTitle(t,e.atomStage)},_checkColumnNameEqualOrder:function(t,e){var a=this.layoutManager.order_getKey(t);return a==="a.".concat(e)||a==="f.".concat(e)||a===e},_columnSorterFind:function(t){var e=this;return this.layoutManager.order_list.find((function(a){return e._checkColumnNameEqualOrder(a,t)}))},_columnSorterCurrent:function(t){var e=this.layoutManager.order_current;return this.layoutManager.order_getKey(e),!!this._checkColumnNameEqualOrder(e,t)&&("desc"===e.by?"descend":"ascend")},_customRender:function(t,e,a,n){var o=this.$createElement;if(!n.component)return null==t?t="":"object"===b(t)&&t instanceof Date&&(t=this.$meta.util.formatDateTime(t,n.dateFormat)),n.textLocale&&(t=this.$text(t)),o("div",{class:"eb-antdv-table-cell",attrs:{title:t}},[t]);var r={props:{layoutManager:this.layoutManager,layout:this.layout,layoutItems:this,info:{text:t,record:e,index:a,column:n}}};return o("eb-component",{attrs:{module:n.component.module,name:n.component.name,options:r}})},_customRow:function(t){var e=this;return{props:{},on:{contextmenu:function(a){var n=e.$$(e.$el).find(".popover");if(0!==n.length){a.stopPropagation(),a.preventDefault();var o=a.target;e.$nextTick((function(){e.$f7.popover.open(n,o),e.contextmenuRecord=t,e.onSwipeoutOpened(null,t)}))}}}}},_renderListItemContextMenu:function(){var t,e=this,a=this.$createElement,n=this.contextmenuRecord;if(n&&1===n.atomStage){var o=a("div",{attrs:{color:"teal"},props:{onPerform:function(t){return e.onStarSwitch(t,n)}}},[a("f7-icon",{slot:"media",attrs:{material:n.star?"star_border":"star"}}),a("div",{slot:"title"},[this.$text(n.star?"Unstar":"Star")])]),r=a("div",{attrs:{color:"blue"},props:{onPerform:function(t){return e.onLabel(t,n)}}},[a("f7-icon",{slot:"media",attrs:{material:"label"}}),a("div",{slot:"title"},[this.$text("Labels")])]);t=a("div",{slot:"left"},[o,r])}var i=[];if(n&&n._actions){var s=function(t){t=parseInt(t);var o=n._actions[t],r=e.getAction(o);i.push(a("div",{key:o.id,attrs:{color:e._getActionColor(o,t)},props:{onPerform:function(t){return e.onAction(t,n,o)}}},[a("f7-icon",{slot:"media",attrs:{material:r.icon.material}}),a("div",{slot:"title"},[e._getActionTitle(o,n)])])),l=t};for(var l in n._actions)s(l)}var u=a("div",{slot:"right",attrs:{ready:n&&!!n._actions}},[i]);return a("eb-context-menu",{attrs:{mode:"menu"}},[t,u])},_renderTable:function(){return(0,this.$createElement)("a-table",{attrs:{bordered:!0,rowSelection:this.rowSelection,columns:this.columns,rowKey:function(t){return t.atomId},dataSource:this.layout.dataSource,pagination:!1,scroll:{y:this.tableHeight},customRow:this._customRow},on:{change:this.onTableChange}})}},render:function(){var t=arguments[0];return t("div",{class:"atom-list-layout-table-container"},[this._renderTable(),this._renderListItemContextMenu()])}},listLayoutBlockTableBottombar:{meta:{global:!1},mixins:[g],props:{layoutManager:{type:Object},blockConfig:{type:Object}},data:function(){return{}},computed:{layout:function(){return this.layoutManager.layout.instance}},created:function(){},methods:{onPageChange:function(t){this.layout.gotoPage(t)},_renderPagination:function(){return(0,this.$createElement)("a-pagination",{attrs:{value:this.layout.info.pageCurrent,"page-size":this.layout.info.pageSize,total:this.layout.info.total,disabled:!1},on:{change:this.onPageChange}})},_renderTotal:function(){var t,e=this.$createElement;return this.layout.info.total>0&&(t=e("f7-badge",[this.layout.info.total])),e("div",[t])},_renderConfigProvider:function(){var t=this.$createElement;return this.antdv.locales?t("a-config-provider",{attrs:{locale:this.antdv_getLocale()}},[this._renderPagination()]):null}},render:function(){var t=arguments[0];return t("div",{class:"eb-antdv atom-list-layout-table-pagination-container"},[this._renderTotal(),this._renderConfigProvider()])}},listLayoutTableCellUserName:{meta:{global:!1},props:{layoutManager:{type:Object},layout:{type:Object},layoutItems:{type:Object},info:{type:Object}},data:function(){return{}},created:function(){},methods:{},render:function(){var t=arguments[0];return t("div",[t("img",{class:"avatar avatar24 eb-vertical-align",attrs:{src:this.layoutItems._getItemMetaMedia(this.info.record)}}),t("span",[" ",this.info.text])])}},listLayoutTableCellAtomName:{meta:{global:!1},props:{layoutManager:{type:Object},layout:{type:Object},layoutItems:{type:Object},info:{type:Object}},data:function(){return{}},created:function(){},methods:{onItemClick:function(t){return this.layoutItems.onItemClick(t,this.info.record)}},render:function(){var t,e=this,a=arguments[0],n=this.info.record,o=[],r=C(this.layoutItems._getItemMetaFlags(n));try{for(r.s();!(t=r.n()).done;){var i=t.value;o.push(a("f7-badge",{key:i},[i]))}}catch(t){r.e(t)}finally{r.f()}var s=[];if(n.labels&&this.layoutManager.base_userLabels){var l,u=C(JSON.parse(n.labels));try{for(u.s();!(l=u.n()).done;){var c=l.value,m=this.layoutItems._getLabel(c);s.push(a("f7-badge",{key:c,style:{backgroundColor:m.color}},[m.text]))}}catch(t){u.e(t)}finally{u.f()}}var f=a("div",{class:"atomName-summary"},[this.layoutItems._getItemMetaSummary(n)]);return a("div",{class:"atom-list-layout-table-cell-atomName"},[a("div",{class:"atomName-inner"},[a("div",{class:"atomName-left"},[a("eb-link",{props:{onPerform:function(t){return e.onItemClick(t)}}},[this.info.record.atomNameLocale||this.info.record.atomName])]),a("div",{class:"atomName-right"},[a("span",{class:"stats"},[n.star>0&&a("span",["⭐"]),n.attachmentCount>0&&a("span",["🧷"]),n.attachmentCount>1&&a("span",["".concat(n.attachmentCount)]),n.commentCount>0&&a("span",["💬"]),n.commentCount>1&&a("span",["".concat(n.commentCount)])]),o,s])]),f])}},itemLayoutMobile:{meta:{global:!1},props:{layoutManager:{type:Object},layoutConfig:{type:Object}},data:function(){return{}},created:function(){this.layoutManager.layout.instance=this,this.layoutManager.subnavbar.enable=!0},methods:{getBlockComponentOptions:function(t){var e=t.blockConfig;return{props:{layoutManager:this.layoutManager,layout:this,blockConfig:e}}},_renderBlock:function(t){var e=t.blockName,a=this.$createElement,n=this.layoutConfig.blocks[e];return n?a("eb-component",{attrs:{module:n.component.module,name:n.component.name,options:this.getBlockComponentOptions({blockConfig:n})}}):null}},render:function(){var t=arguments[0];return t("div",[this._renderBlock({blockName:"main"})])}},itemLayoutBlockMobileTitle:{meta:{global:!1},props:{layoutManager:{type:Object},blockConfig:{type:Object}},data:function(){return{}},created:function(){},methods:{},render:function(){var t=arguments[0];return t("f7-nav-right",[this.layoutManager.actions_render()])}},itemLayoutBlockMobileSubnavbar:{meta:{global:!1},props:{layoutManager:{type:Object},blockConfig:{type:Object}},data:function(){return{}},methods:{_renderActionsLeft:function(){return(0,this.$createElement)("div",{class:"actions-block actions-block-left"},[this.layoutManager.info_renderActionsLeft()])},_renderActionsRight:function(){return(0,this.$createElement)("div",{class:"actions-block actions-block-right"},[this.layoutManager.info_renderActionsRight()])}},render:function(){var t=arguments[0];return t("f7-subnavbar",[t("div",{class:"atom-item-subnavbar-container"},[this._renderActionsLeft(),this._renderActionsRight()])])}},itemLayoutBlockMobileMain:{meta:{global:!1},props:{layoutManager:{type:Object},layout:{type:Object},blockConfig:{type:Object}},data:function(){return{}},render:function(){return this.layoutManager.validate_render()}},itemLayoutPC:{meta:{global:!1},props:{layoutManager:{type:Object},layoutConfig:{type:Object}},data:function(){return{}},created:function(){this.layoutManager.layout.instance=this,this.layoutManager.subnavbar.enable=!1},methods:{getBlockComponentOptions:function(t){var e=t.blockConfig;return{props:{layoutManager:this.layoutManager,layout:this,blockConfig:e}}},_renderBlock:function(t){var e=t.blockName,a=this.$createElement,n=this.layoutConfig.blocks[e];return n?a("eb-component",{attrs:{module:n.component.module,name:n.component.name,options:this.getBlockComponentOptions({blockConfig:n})}}):null}},render:function(){var t=arguments[0];return t("div",[this._renderBlock({blockName:"main"})])}},itemLayoutBlockPCTitle:{meta:{global:!1},props:{layoutManager:{type:Object},blockConfig:{type:Object}},data:function(){return{}},created:function(){},methods:{},render:function(){var t=arguments[0];return t("f7-nav-right",{class:"atom-item-title-info-container"},[this.layoutManager.info_renderActionsLeft(),this.layoutManager.info_renderActionsRight(),this.layoutManager.actions_render()])}}}},788:(t,e,a)=>{"use strict";a.d(e,{Z:()=>n});const n={}},978:(t,e,a)=>{"use strict";a.d(e,{Z:()=>n});const n={Filter:"筛选",Stage:"阶段"}},137:(t,e,a)=>{"use strict";a.d(e,{Z:()=>n});const n={"zh-cn":a(978).Z}},292:(t,e,a)=>{"use strict";var n;a.r(e),a.d(e,{default:()=>o}),a(824);const o={install:function(t,e){return n?console.error("already installed."):(n=t,e({routes:a(644).Z,store:a(81).Z(n),config:a(788).Z,locales:a(137).Z,components:a(222).Z,mixins:a(751).Z}))}}},751:(t,e,a)=>{"use strict";a.d(e,{Z:()=>n});const n={}},644:(t,e,a)=>{"use strict";a.d(e,{Z:()=>n});const n=[{path:"listLayoutFilter",component:("listLayoutFilter",a(990)("./".concat("listLayoutFilter",".jsx")).default)}]},81:(t,e,a)=>{"use strict";function n(t){return{state:{},getters:{},mutations:{},actions:{}}}a.d(e,{Z:()=>n})},82:(t,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>o});var n=a(5);const o={mixins:[a.n(n)().prototype.$meta.module.get("a-components").options.mixins.ebPageContext],data:function(){return{immediate:!0}},computed:{pageTitle:function(){return this.$text("Filter")},filterComponentInstance:function(){return this.$refs.filter&&this.$refs.filter.getComponentInstance()}},created:function(){this.immediate=this.contextParams.immediate},mounted:function(){this.contextParams.layoutManager.$on("layoutManager:destroy",this.onLayoutManagerDestroy)},beforeDestroy:function(){this.contextParams.layoutManager.$off("layoutManager:destroy",this.onLayoutManagerDestroy)},methods:{onPerformSearch:function(){this.filterComponentInstance&&this.filterComponentInstance.onPerformSearch()},onLayoutManagerDestroy:function(){this.$view.close()},_getFilterComponentOptions:function(){return{props:{layoutManager:this.contextParams.layoutManager,filterConfig:this.contextParams.filterConfig,filterContainer:this}}},_renderNavbar:function(){var t=this.$createElement;return t("eb-navbar",{attrs:{title:this.pageTitle,"eb-back-link":"Back"}},[t("f7-nav-right",[!this.immediate&&t("eb-link",{ref:"buttonSubmit",attrs:{iconMaterial:"search"},props:{onPerform:this.onPerformSearch}})])])}},render:function(){var t,e=arguments[0];if(this.contextParams){var a=this.contextParams.filterConfig;t=e("eb-component",{ref:"filter",attrs:{module:a.component.module,name:a.component.name,options:this._getFilterComponentOptions()}})}return e("eb-page",[this._renderNavbar(),t])}}},891:(t,e,a)=>{var n=a(233),o=a(361)(n);o.push([t.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]),t.exports=o},361:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var a=t(e);return e[2]?"@media ".concat(e[2]," {").concat(a,"}"):a})).join("")},e.i=function(t,a,n){"string"==typeof t&&(t=[[null,t,""]]);var o={};if(n)for(var r=0;r<this.length;r++){var i=this[r][0];null!=i&&(o[i]=!0)}for(var s=0;s<t.length;s++){var l=[].concat(t[s]);n&&o[l[0]]||(a&&(l[2]?l[2]="".concat(a," and ").concat(l[2]):l[2]=a),e.push(l))}},e}},233:t=>{"use strict";function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}t.exports=function(t){var a,n,o=(n=4,function(t){if(Array.isArray(t))return t}(a=t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var a=[],n=!0,o=!1,r=void 0;try{for(var i,s=t[Symbol.iterator]();!(n=(i=s.next()).done)&&(a.push(i.value),!e||a.length!==e);n=!0);}catch(t){o=!0,r=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw r}}return a}}(a,n)||function(t,a){if(t){if("string"==typeof t)return e(t,a);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e(t,a):void 0}}(a,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),r=o[1],i=o[3];if("function"==typeof btoa){var s=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),u="/*# ".concat(l," */"),c=i.sources.map((function(t){return"/*# sourceURL=".concat(i.sourceRoot||"").concat(t," */")}));return[r].concat(c).concat([u]).join("\n")}return[r].join("\n")}},824:(t,e,a)=>{var n=a(891);"string"==typeof n&&(n=[[t.id,n,""]]),n.locals&&(t.exports=n.locals),(0,a(159).Z)("19fa62f7",n,!0,{})},159:(t,e,a)=>{"use strict";function n(t,e){for(var a=[],n={},o=0;o<e.length;o++){var r=e[o],i=r[0],s={id:t+":"+o,css:r[1],media:r[2],sourceMap:r[3]};n[i]?n[i].parts.push(s):a.push(n[i]={id:i,parts:[s]})}return a}a.d(e,{Z:()=>h});var o="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!o)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var r={},i=o&&(document.head||document.getElementsByTagName("head")[0]),s=null,l=0,u=!1,c=function(){},m=null,f="data-vue-ssr-id",d="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function h(t,e,a,o){u=a,m=o||{};var i=n(t,e);return g(i),function(e){for(var a=[],o=0;o<i.length;o++){var s=i[o];(l=r[s.id]).refs--,a.push(l)}for(e?g(i=n(t,e)):i=[],o=0;o<a.length;o++){var l;if(0===(l=a[o]).refs){for(var u=0;u<l.parts.length;u++)l.parts[u]();delete r[l.id]}}}}function g(t){for(var e=0;e<t.length;e++){var a=t[e],n=r[a.id];if(n){n.refs++;for(var o=0;o<n.parts.length;o++)n.parts[o](a.parts[o]);for(;o<a.parts.length;o++)n.parts.push(y(a.parts[o]));n.parts.length>a.parts.length&&(n.parts.length=a.parts.length)}else{var i=[];for(o=0;o<a.parts.length;o++)i.push(y(a.parts[o]));r[a.id]={id:a.id,refs:1,parts:i}}}}function p(){var t=document.createElement("style");return t.type="text/css",i.appendChild(t),t}function y(t){var e,a,n=document.querySelector("style["+f+'~="'+t.id+'"]');if(n){if(u)return c;n.parentNode.removeChild(n)}if(d){var o=l++;n=s||(s=p()),e=C.bind(null,n,o,!1),a=C.bind(null,n,o,!0)}else n=p(),e=_.bind(null,n),a=function(){n.parentNode.removeChild(n)};return e(t),function(n){if(n){if(n.css===t.css&&n.media===t.media&&n.sourceMap===t.sourceMap)return;e(t=n)}else a()}}var b,v=(b=[],function(t,e){return b[t]=e,b.filter(Boolean).join("\n")});function C(t,e,a,n){var o=a?"":n.css;if(t.styleSheet)t.styleSheet.cssText=v(e,o);else{var r=document.createTextNode(o),i=t.childNodes;i[e]&&t.removeChild(i[e]),i.length?t.insertBefore(r,i[e]):t.appendChild(r)}}function _(t,e){var a=e.css,n=e.media,o=e.sourceMap;if(n&&t.setAttribute("media",n),m.ssrId&&t.setAttribute(f,e.id),o&&(a+="\n/*# sourceURL="+o.sources[0]+" */",a+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */"),t.styleSheet)t.styleSheet.cssText=a;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(a))}}},990:(t,e,a)=>{var n={"./listLayoutFilter.jsx":82};function o(t){var e=r(t);return a(e)}function r(t){if(!a.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}o.keys=function(){return Object.keys(n)},o.resolve=r,t.exports=o,o.id=990},142:t=>{function e(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}e.keys=()=>[],e.resolve=e,e.id=142,t.exports=e},5:t=>{"use strict";t.exports=window.Vue}},e={};function a(n){if(e[n])return e[n].exports;var o=e[n]={id:n,exports:{}};return t[n](o,o.exports,a),o.exports}return a.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return a.d(e,{a:e}),e},a.d=(t,e)=>{for(var n in e)a.o(e,n)&&!a.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},a.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),a.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a(292)})();
//# sourceMappingURL=front.js.map