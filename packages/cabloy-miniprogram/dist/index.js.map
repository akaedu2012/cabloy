{"version":3,"sources":["webpack://cabloy/webpack/universalModuleDefinition","webpack://cabloy/./src/api.js","webpack://cabloy/./src/config.js","webpack://cabloy/./src/data.js","webpack://cabloy/./src/index.js","webpack://cabloy/./src/util.js","webpack://cabloy/webpack/bootstrap","webpack://cabloy/webpack/startup"],"names":["module","exports","cabloy","request","options","url","indexOf","config","api","baseURL","data","dingtalk","headers","Authorization","jwt","header","Promise","resolve","reject","success","res","_statusCode","statusCode","status","error","Error","code","message","fail","err","dd","httpRequest","wx","get","method","post","configDefault","base","scene","locale","locales","util","extend","_instance","_user","_jwt","_locale","_wxSystemInfo","getSystemInfoSync","_ddSysmtemInfo","_container","environment","systemInfo","container","wechat","wxwork","value","user","loggedIn","agent","anonymous","instance","preferredLocale","language","Util","require","Api","Data","Config","app","_util","_api","_data","_config","toLowerCase","replace","localeShort","split","Object","keys","find","item","login","__login_dingtalk","__login_wechat","__login_wxwork","detail","__login","then","getSetting","authSetting","getUserInfo","qy","getAuthCode","authCode","isObject","o","constructor","deep","to","from","args","splice","i","length","nextSource","undefined","keysArray","nextIndex","len","nextKey","desc","getOwnPropertyDescriptor","enumerable"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"cabloy\"] = factory();\n\telse\n\t\troot[\"cabloy\"] = factory();\n})(self, function() {\nreturn ","module.exports = function (cabloy) {\n  return {\n    request(options) {\n      // url\n      if (options.url.indexOf('/') === 0) {\n        options.url = `${cabloy.config.api.baseURL}/api${options.url}`;\n      }\n      // jwt\n      if (cabloy.data.dingtalk) {\n        if (!options.headers) options.headers = {};\n        options.headers.Authorization = `Bearer ${cabloy.data.jwt || ''}`;\n      } else {\n        if (!options.header) options.header = {};\n        options.header.Authorization = `Bearer ${cabloy.data.jwt || ''}`;\n      }\n      // promise\n      return new Promise((resolve, reject) => {\n        // callback\n        options.success = res => {\n          // statusCode\n          const _statusCode = res.statusCode || res.status;\n          if (_statusCode !== 200) {\n            const error = new Error();\n            error.code = _statusCode;\n            return reject(error);\n          }\n          if (res.data.code !== 0) {\n            const error = new Error();\n            error.code = res.data.code;\n            error.message = res.data.message;\n            return reject(error);\n          }\n          // check jwt\n          if (res.data['eb-jwt']) {\n            cabloy.data.jwt = res.data['eb-jwt'];\n          }\n          resolve(res.data.data);\n        };\n        options.fail = err => {\n          reject(err);\n        };\n        // request\n        if (cabloy.data.dingtalk) {\n          dd.httpRequest(options);\n        } else {\n          wx.request(options);\n        }\n      });\n    },\n    get(url, options) {\n      options = options || {};\n      options.url = url;\n      options.method = 'GET';\n      return this.request(options);\n    },\n    post(url, data, options) {\n      options = options || {};\n      options.url = url;\n      options.method = 'POST';\n      options.data = data;\n      return this.request(options);\n    },\n  };\n};\n","const configDefault = {\n  base: {\n    scene: 'default',\n    locale: 'en-us',\n  },\n  api: {\n    baseURL: '',\n  },\n  locales: {\n    'en-us': 'English',\n    'zh-cn': 'Chinese',\n  },\n};\n\nmodule.exports = function (cabloy, options) {\n  return cabloy.util.extend({}, configDefault, options);\n};\n","module.exports = function (cabloy, options) {\n  let _instance = null;\n  let _user = null;\n  let _jwt = null;\n  let _locale = null;\n\n  // systemInfo\n  const _wxSystemInfo = typeof wx !== 'undefined' && wx.getSystemInfoSync();\n  const _ddSysmtemInfo = typeof dd !== 'undefined' && dd.getSystemInfoSync();\n\n  // container\n  let _container;\n  if (typeof dd !== 'undefined') {\n    _container = 'dingtalk';\n  } else if (typeof wx !== 'undefined' && _wxSystemInfo.environment !== 'wxwork') {\n    _container = 'wechat';\n  } else if (typeof wx !== 'undefined' && _wxSystemInfo.environment === 'wxwork') {\n    _container = 'wxwork';\n  }\n\n  return {\n    get systemInfo() {\n      return _wxSystemInfo || _ddSysmtemInfo;\n    },\n    get container() {\n      return _container;\n    },\n    get dingtalk() {\n      return _container === 'dingtalk';\n    },\n    get wechat() {\n      return _container === 'wechat';\n    },\n    get wxwork() {\n      return _container === 'wxwork';\n    },\n    get jwt() {\n      return _jwt;\n    },\n    set jwt(value) {\n      _jwt = value;\n    },\n    get user() {\n      return _user;\n    },\n    set user(value) {\n      _user = value;\n    },\n    get loggedIn() {\n      const user = this.user;\n      return user && user.agent.anonymous === 0;\n    },\n    get instance() {\n      return _instance;\n    },\n    set instance(value) {\n      _instance = value;\n    },\n    get locale() {\n      // systemInfo\n      if (!_locale) {\n        _locale = cabloy.util.preferredLocale(this.systemInfo.language);\n      }\n      // config\n      if (!_locale) {\n        _locale = cabloy.config.base.locale;\n      }\n      // default\n      if (!_locale) {\n        _locale = 'en-us';\n      }\n      return _locale;\n    },\n  };\n};\n","const Util = require('./util.js');\nconst Api = require('./api.js');\nconst Data = require('./data.js');\nconst Config = require('./config.js');\n\nmodule.exports = function (app, options) {\n  let _util;\n  let _api;\n  let _data;\n  let _config;\n\n  const cabloy = {\n    get app() {\n      return app;\n    },\n    get util() {\n      if (!_util) {\n        _util = Util(this);\n      }\n      return _util;\n    },\n    get api() {\n      if (!_api) {\n        _api = Api(this);\n      }\n      return _api;\n    },\n    get data() {\n      if (!_data) {\n        _data = Data(this);\n      }\n      return _data;\n    },\n    get config() {\n      if (!_config) {\n        _config = Config(this, options);\n      }\n      return _config;\n    },\n    set config(value) {\n      if (!_config) {\n        _config = Config(this, options);\n      }\n      _config = this.util.extend({}, _config, value);\n    },\n  };\n\n  return cabloy;\n};\n","module.exports = function (cabloy) {\n  return {\n    preferredLocale(locale) {\n      locale = locale.toLowerCase().replace(/_/g, '-');\n      const locales = cabloy.config.locales;\n      // match exactly\n      if (locales[locale]) return locale;\n      // match fuzzy\n      const localeShort = locale.split('-')[0];\n      return Object.keys(locales).find(item => item.indexOf(localeShort) === 0);\n    },\n\n    login(options) {\n      if (cabloy.data.dingtalk) {\n        return this.__login_dingtalk(options);\n      } else if (cabloy.data.wechat) {\n        return this.__login_wechat(options);\n      } else if (cabloy.data.wxwork) {\n        return this.__login_wxwork(options);\n      }\n    },\n\n    __login_wechat(options) {\n      return new Promise((resolve, reject) => {\n        const scene = cabloy.config.base.scene;\n        if (options && options.detail) {\n          // 直接进行后台登录\n          this.__login({ scene, code: null, detail: options.detail }).then(resolve).catch(reject);\n        } else {\n          // 小程序登录\n          wx.login({\n            success: res => {\n              const code = res.code;\n              // 获取用户信息\n              wx.getSetting({\n                success: res => {\n                  if (res.authSetting['scope.userInfo']) {\n                    // 已经授权，可以直接调用 getUserInfo 获取头像昵称，不会弹框\n                    wx.getUserInfo({\n                      success: detail => {\n                        // 后台登录\n                        this.__login({ scene, code, detail }).then(resolve).catch(reject);\n                      },\n                    });\n                  } else {\n                    // 虽然没有userInfo，但有openid，仍然可以进行后台登录\n                    this.__login({ scene, code, detail: null }).then(resolve).catch(reject);\n                  }\n                },\n              });\n            },\n          });\n        }\n      });\n    },\n\n    __login_wxwork(options) {\n      return new Promise((resolve, reject) => {\n        // 小程序登录\n        wx.qy.login({\n          success: res => {\n            const scene = cabloy.config.base.scene;\n            const code = res.code;\n            this.__login({ scene, code }).then(resolve).catch(reject);\n          },\n        });\n      });\n    },\n\n    __login_dingtalk(options) {\n      return new Promise((resolve, reject) => {\n        // 小程序登录\n        dd.getAuthCode({\n          success: res => {\n            const scene = cabloy.config.base.scene;\n            const code = res.authCode;\n            this.__login({ scene, code }).then(resolve).catch(reject);\n          },\n        });\n      });\n    },\n\n    __login({ scene, code, detail }) {\n      // 后台登录\n      const url = `/a/${cabloy.data.container}/authMini/login?locale=${cabloy.data.locale}`;\n      return cabloy.api.post(url, { scene, code, detail }).then(data => {\n        // user\n        cabloy.data.user = data.user;\n        // instance\n        cabloy.data.instance = data.instance;\n        // config\n        cabloy.config = data.config;\n        // ok\n        return data.user;\n      });\n    },\n\n    isObject(o) {\n      return typeof o === 'object' && o !== null && o.constructor && o.constructor === Object;\n    },\n\n    extend(...args) {\n      let deep = true;\n      let to;\n      let from;\n      if (typeof args[0] === 'boolean') {\n        deep = args[0];\n        to = args[1];\n        args.splice(0, 2);\n        from = args;\n      } else {\n        to = args[0];\n        args.splice(0, 1);\n        from = args;\n      }\n      for (let i = 0; i < from.length; i += 1) {\n        const nextSource = args[i];\n        if (nextSource !== undefined && nextSource !== null) {\n          const keysArray = Object.keys(Object(nextSource));\n          for (let nextIndex = 0, len = keysArray.length; nextIndex < len; nextIndex += 1) {\n            const nextKey = keysArray[nextIndex];\n            const desc = Object.getOwnPropertyDescriptor(nextSource, nextKey);\n            if (desc !== undefined && desc.enumerable) {\n              if (!deep) {\n                to[nextKey] = nextSource[nextKey];\n              } else if (this.isObject(to[nextKey]) && this.isObject(nextSource[nextKey])) {\n                this.extend(to[nextKey], nextSource[nextKey]);\n              } else if (!this.isObject(to[nextKey]) && this.isObject(nextSource[nextKey])) {\n                to[nextKey] = {};\n                this.extend(to[nextKey], nextSource[nextKey]);\n              } else {\n                to[nextKey] = nextSource[nextKey];\n              }\n            }\n          }\n        }\n      }\n      return to;\n    },\n  };\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(586);\n"],"sourceRoot":""}